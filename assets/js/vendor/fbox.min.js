var Vl=Object.defineProperty;var er=(e,t)=>{for(var r in t)Vl(e,r,{get:t[r],enumerable:!0})};var at,Xl=new Uint8Array(16);function kt(){if(!at&&(at=typeof crypto!="undefined"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||typeof msCrypto!="undefined"&&typeof msCrypto.getRandomValues=="function"&&msCrypto.getRandomValues.bind(msCrypto),!at))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return at(Xl)}var tr=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function Ql(e){return typeof e=="string"&&tr.test(e)}var rr=Ql;var g=[];for(var $t=0;$t<256;++$t)g.push(($t+256).toString(16).substr(1));function Zl(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=(g[e[t+0]]+g[e[t+1]]+g[e[t+2]]+g[e[t+3]]+"-"+g[e[t+4]]+g[e[t+5]]+"-"+g[e[t+6]]+g[e[t+7]]+"-"+g[e[t+8]]+g[e[t+9]]+"-"+g[e[t+10]]+g[e[t+11]]+g[e[t+12]]+g[e[t+13]]+g[e[t+14]]+g[e[t+15]]).toLowerCase();if(!rr(r))throw TypeError("Stringified UUID is invalid");return r}var lr=Zl;function en(e,t,r){e=e||{};var l=e.random||(e.rng||kt)();if(l[6]=l[6]&15|64,l[8]=l[8]&63|128,t){r=r||0;for(var a=0;a<16;++a)t[r+a]=l[a];return t}return lr(l)}var Dt=en;var $="record",L="erecord",pe="dict",M="list",S="tuple",D="union",O="tunion",z="string",J="int8",V="uint8",X="int16",Q="uint16",Z="int32",ee="uint32",nr=[J,X,Z,V,Q,ee],te="float32",re="float64",ar=[te,re],Ot="timestamp",le="boolean",we="null",$e="any",P="ref",ne="value",I="fmodel",fe=()=>({type:$e}),ot=()=>({type:z}),or=()=>({type:le}),ir=()=>({type:J,min:-128,max:127}),sr=()=>({type:X,min:-32768,max:32767}),cr=()=>({type:Z,min:-2147483648,max:2147483647}),dr=()=>({type:V,min:0,max:255}),ur=()=>({type:Q,min:0,max:65535}),pr=()=>({type:ee,min:0,max:4294967295}),fr=()=>({type:te}),mr=()=>({type:re}),yr=()=>({type:Ot}),Tr=()=>({type:we}),ae=()=>({type:$,fields:[]}),hr=()=>({type:L,schs:[v(()=>Ge(null)),v(ae)]}),xr=()=>({type:M,sch:v(fe)}),br=()=>({type:S,schs:[v(fe)]}),Nr=()=>({type:D,schs:[v(fe)]}),Er=()=>({type:O,fields:[{...v(ae),key:"tag_a"}],tagname:"tag",allowedSchs:[ae()],keyPrefix:"tag"}),_r=()=>({type:pe,schs:[v(ot),v(fe)]}),Ge=e=>({type:P,$ref:e}),it=e=>{try{return e=JSON.parse(e),e==null||[z,...ar,...nr,le].includes(typeof e)?{type:ne,const:e}:!1}catch(t){return!1}},v=(e,t={})=>{let r=e();return r.$anchor||(r.$anchor=Dt()),t.force&&(r.$anchor=Dt()),r};var Ke=e=>{e.target.value=e.target.value.replace(/\n/g,""),e.target.style.overflow="hidden",e.target.style.height="auto",e.target.style.height=`${e.target.scrollHeight}px`},Ar=e=>{Ke(e),e.target.setSelectionRange(e.target.value.length,e.target.value.length)},{defineProperty:tn}=Object,wr=tn,oe=(e,t,r)=>wr(e,t,{value:r,configurable:!0}),me=(e,t,r)=>wr(e,t,{value:r,configurable:!0,writable:!0});var st=(e,t)=>{let r=JSON.parse(JSON.stringify(e));return U(r,(l,a)=>{let n;t&&(n=t.schMetas[l.$anchor]);let o=v(()=>l,{force:!0});return n&&Object.assign(t.schMetas,{[o.$anchor]:o.metadata}),l}),r},U=(e,t,r={path:"",level:1,parent:{}})=>{if(delete e._halt,delete e._pruned,e=t(e,r),e._halt||e._pruned)return e;let l=({type:a,$anchor:n,key:o},{path:d,level:c})=>({level:c,type:a,$anchor:n,key:o,path:d});switch(!0){case e.hasOwnProperty("fields"):for(let o=e.fields.length-1;o>=0;o--){let d=e.fields[o],c=d.key,s={path:`${r.path}[${c}]`,level:r.level+1,index:o,parent:l(e,r)};if(d=U(d,t,s),d.index=o,e.fields[o]=d,d._halt)return Object.assign(e,{_halt:!0})}break;case e.hasOwnProperty("schs"):for(let o=0;o<e.schs.length;o++){let d=e.schs[o],c={path:`${r.path}[][${o}]`,level:r.level+1,index:o,parent:l(e,r)};if(d=U(d,t,c),d.index=o,e.schs[o]=d,d._halt)return Object.assign(e,{_halt:!0})}break;case e.hasOwnProperty("sch"):let a={path:`${r.path}[][0]`,level:r.level+1,index:0,parent:l(e,r)},n=U(e.sch,t,a);if(n.index=0,e.sch=n,n._halt)return Object.assign(e,{_halt:!0});break;default:}return e},rn=(e,t,r)=>{let l={original:{},popped:[]},a=r.sort((n,o)=>o-n);return U(e,(n,o)=>{if(o.path!=t)return n;switch(!0){case n.hasOwnProperty("fields"):for(let d of a)l.popped.unshift({k:n.fields[d].key,sch:n.fields.splice(d,1)[0],index:d});break;case n.hasOwnProperty("sch"):break;case n.hasOwnProperty("schs"):for(let d of a)l.popped.unshift({k:d,sch:n.schs.splice(d,1)[0],index:d});n.schs.length==0&&n.schs.splice(0,0,v(fe));break;default:}return n}),l},ln=e=>e.filter(t=>{for(let r of e){if(t==r)return!0;if(t.startsWith(r)&&r!="")return!1}}),ct=(e,t,r)=>{let l={original:{},inserted:[]},a=(n,o)=>(n=Math.max(n,0),n=Math.min(n,o.length),n);return U(e,(n,o)=>{var d;if(o.path!=t)return n;{typeof r=="function"&&(r=r.call(n));let c=r.sort((s,u)=>s.index-u.index);switch(!0){case n.hasOwnProperty("fields"):let s=(d=e.taggedLevel)==null?void 0:d[o.level+1];for(let{k:u,sch:p,index:m}of c){u=u==0?"0":u,u=u||`${s||n.keyPrefix||"key"}_${Math.floor(Date.now()/100)}`,u=`${u}`;for(let x=0;x<n.fields.length;x++)if(n.fields[x].key==u)u=`${u} \u2013`;else continue;m=a(m,n.fields),n.fields.splice(m,0,v(p)),n.fields[m].key=u,l.inserted.push({k:n.fields[m].key,sch:n.fields[m],index:m})}break;case n.hasOwnProperty("sch"):break;case n.hasOwnProperty("schs"):for(let{k:u,sch:p,index:m}of c)m=a(m,n.schs),n.schs.splice(m,0,v(p)),l.inserted.push({k:u,sch:n.schs[m],index:m});break;default:}return n}}),l},ut=(e,{dstPath:t,startIndex:r=0},l)=>{let a=(c,s,u)=>ie(c,s,(p,m)=>(oe(p,"_pinId",u),p)),n=Symbol(t);a(e,t,n);let o=dt(e,l,{dstPath:t});return St(e,{dstPin:n,startIndex:r},o)},dt=(e,t,r={})=>{let l={},a=ln(Object.keys(t));for(let n of a){let o=t[n],d=u=>{var p;return(p=o.find(m=>m.index==u))==null?void 0:p.newK};if(r.dstPath&&o.filter(p=>r.dstPath.startsWith(p.id)).length!=0)continue;let s=rn(e,n,o.map(u=>u.index)).popped.map(({k:u,sch:p,index:m})=>({k:d(m)||u,sch:()=>p}));l[n]=s}return l},St=(e,{dstPin:t,dstPath:r,startIndex:l=0},a)=>{let n=(s,u)=>De(s,(p,m)=>p._pinId==u,(p,m)=>(oe(p,"_pinned",m),p));l=Math.max(l,0);let o={},d=Object.values(a).flatMap(s=>s).map((s,u)=>({...s,index:l+u}));if(t){let s=n(e,t);s&&(r=s._pinned.path)}let c=ct(e,r,d);return c.inserted.length!=0&&(o[r]=c.inserted),o},Ct=(e,{dstPath:t,startIndex:r=0},l)=>{let a=Mt(e,l,{dstPath:t,startIndex:r});return It(e,{dstPath:t},a)},Mt=(e,t,r={})=>Object.values(t).reduce((l,a)=>{let n=a.map(d=>d.id),o=[];De(e,(d,c)=>(n.includes(c.path)&&(oe(d,"_meta",c),o.unshift(d)),o.length==n.length),(d,c)=>d);for(let d of a){if(r.dstPath&&r.dstPath.startsWith(d.id))continue;let c=o.find(s=>s._meta.path==d.id);c&&l.unshift({k:d.key,sch:()=>st(c,e),index:r.startIndex+l.length,id:d.id})}return l},[]),It=(e,{dstPath:t},r)=>{let l={},a=ct(e,t,r);return a.inserted.length!=0&&(l[t]=a.inserted),l},pt=(e,t,r)=>ie(e,t,(l,a)=>{let n=v(r),{title:o,description:d,rw:c,required:s,$anchor:u,key:p}=l,m=n.type==P&&n.$ref!=l.$ref,x=n.type==ne&&n.const!=l.const,_=n.type!=l.type;return n.$ref==u?l:_||x||m?Object.assign(n,{metadata:{title:o,description:d,rw:c,required:s},$anchor:u,key:p}):l}),C=(e,t)=>De(e,(r,l)=>l.path==t,(r,l)=>(oe(r,"_meta",l),r)),ie=(e,t,r)=>De(e,(l,a)=>a.path==t,r),De=(e,t,r)=>{let l;return U(e,(a,n)=>t(a,n)?(l=r(a,n),l._halt=!0,l):a),l&&delete l._halt,l};var Rt={};er(Rt,{clearClipboard:()=>se,collapseSelected:()=>jt,createWalker:()=>vr,expandSelected:()=>Ut,findUnselectedNode:()=>qe,reselectNodes:()=>Se,selectMultiNode:()=>ve,selectMultiNodeTo:()=>Fe,selectNode:()=>E,selectedGroupedByParent:()=>ye,toggleSelectNode:()=>$r});var R="aria-selected",ft="aria-expanded",vr=e=>(e._walker=e.ownerDocument.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:t=>{var r;if(t.hasAttribute(R)){let l=(r=t.parentElement.closest(`[${ft}]`))==null?void 0:r.getAttribute(ft);return l&&l=="false"?NodeFilter.FILTER_REJECT:NodeFilter.FILTER_ACCEPT}else return NodeFilter.FILTER_SKIP}},!1),e),E=(e,t,r={focus:!0})=>{t&&!t.isConnected&&(t=e.querySelector(`[id='${CSS.escape(t.id)}']`)),!!t&&(e._walker.currentNode=t,gr(e),Oe(t),r.focus&&t.focus())},$r=(e,t)=>{e&&(e.tabIndex=-1),kr(t)},ve=(e,t,r={focus:!0})=>{!t||(e&&(e.tabIndex=-1),t.getAttribute(R)=="true"?kr(e):Oe(t),r.focus&&t.focus())},gr=e=>{for(let t of e.querySelectorAll(`[${R}='true']`))Lt(t);for(let t of e.querySelectorAll(".item-pasted"))t.classList.remove("item-pasted","up","down")},Pt=(e,t,r,l={})=>{var o,d,c;let a=e._walker.currentNode,n=t();if(!!n){if(a==r)return(o=l.target)==null?void 0:o.call(null,r);(d=l.pre)==null||d.call(null,a,n),Pt(e,t,r,l),(c=l.post)==null||c.call(null,a,n)}},Fe=(e,t,r)=>{if(!(!t||!r))switch(t.compareDocumentPosition(r)){case Node.DOCUMENT_POSITION_FOLLOWING:e._walker.currentNode=t,Pt(e,()=>e._walker.nextSibling(),r,{pre:(l,a)=>{ve(l,a,{focus:!1})}}),e._walker.currentNode=r,Oe(r),r.focus();break;case Node.DOCUMENT_POSITION_PRECEDING:e._walker.currentNode=t,Oe(r.parentNode.closest(`[${R}]`)),Pt(e,()=>e._walker.previousSibling(),r,{pre:(l,a)=>{ve(l,a,{focus:!1})}}),Lt(r.parentNode.closest(`[${R}]`)),e._walker.currentNode=r,Oe(r),r.focus();break}},Oe=e=>{!e||(e.setAttribute(R,!0),e.tabIndex=0)},Lt=e=>{!e||(e.setAttribute(R,!1),e.tabIndex=-1)},kr=e=>(e==null?void 0:e.getAttribute(R))=="true"?Lt(e):Oe(e),qe=(e,t)=>{do t=e();while((t==null?void 0:t.getAttribute(R))=="true");return t},nn=e=>e.filter(t=>{for(let r of e){if(t==r)return!0;if(t.startsWith(r))return!1}}),Se=(e,t,r={})=>{gr(e);for(let l of nn(Object.keys(t))){let a=t[l];if(l==""?l=e.querySelector("[id][aria-level]"):l=e.querySelector(`[id='${CSS.escape(l)}'][aria-level]`),!l)continue;let n=parseInt(l.getAttribute("aria-level")),o=l.querySelectorAll(`[aria-level='${n+1}'][role='treeitem']`);for(let d=0;d<a.length;d++){let c=a[d].index,s=o[c];if(!s)return;s.classList.add("item-pasted"),r.direction&&s.classList.add(r.direction),ve(null,s,{focus:d==a.length-1}),e._walker.currentNode=s}}},ye=(e,t={})=>{let r=e.querySelectorAll(`${t.ops||`[${R}='true']`}`),l={};for(let a=0;a<r.length;a++){let n=r[a],o=n.parentNode.closest("[role='treeitem']");if(!o)break;n.index=n.index||parseInt(n.getAttribute("aria-posinset"))-1,l[o.id]=l[o.id]||[],l[o.id].push(n)}return l},Ut=e=>{let t=e.querySelectorAll(`[${R}='true']`);for(let r=0;r<t.length;r++)t[r].setAttribute(ft,"true")},jt=e=>{let t=e.querySelectorAll(`[${R}='true']`);for(let r=0;r<t.length;r++)t[r].setAttribute(ft,"false")},se=e=>{e.querySelectorAll(".item-cutting, .item-copying").forEach(t=>t.classList.remove("item-cutting","item-copying")),window._treeClipboard=null};var an=({tree:e})=>{let t=e._walker.currentNode,r=e._walker.parentNode()&&e._walker.firstChild();Fe(e,t,r)},on=({tree:e})=>{let t=e._walker.currentNode,r=e._walker.parentNode()&&e._walker.lastChild();Fe(e,t,r)},sn=({tree:e})=>{let t=e._walker.currentNode,r=e._walker.previousSibling();ve(t,r)},cn=({tree:e})=>{let t=e._walker.currentNode,r=e._walker.nextSibling();ve(t,r)},dn=({tree:e})=>{let t=e._walker.parentNode()&&e._walker.firstChild();E(e,t)},un=({tree:e})=>{let t=e._walker.parentNode()&&e._walker.lastChild();E(e,t)},pn=({tree:e})=>E(e,e._walker.previousNode()),fn=({tree:e})=>E(e,e._walker.nextNode()),mn=({tree:e})=>{for(;e._walker.parentNode(););E(e,e._walker.nextNode()),E(e,e._walker.parentNode())},yn=({tree:e})=>{for(;e._walker.nextNode(););E(e,e._walker.currentNode)},Me=({tree:e},t={})=>E(e,e._walker.currentNode,{focus:t.notFocusIfTextArea}),Gt=({tree:e},t={})=>E(e,e._walker.currentNode),mt={selectMultiNodeUpTo:an,selectMultiNodeDownTo:on,selectMultiNodeUp:sn,selectMultiNodeDown:cn,selectUpEnd:dn,selectDownEnd:un,selectUp:pn,selectDown:fn,selectRoot:mn,selectLast:yn},ce=({tree:e,store:t})=>{var o,d;let r=e._walker.currentNode,l=C(t,r.id),a,n=((o=Dr(e,t))==null?void 0:o[0])||l._addSchDefault||l.allowedSchs&&l.allowedSchs[0]||t.allowedSchs&&t.allowedSchs[0];!n||(((d=t.put)==null?void 0:d.pos)=="prepend"?a=0:a=Number.MAX_SAFE_INTEGER,ct(t,r.id,[{k:null,sch:()=>st(n),index:a}]),e._render(t),E(e,r))},We=({tree:e,store:t})=>{var a,n;let r=e._walker.currentNode;if(((n=(a=r.closest("[role='group']"))==null?void 0:a.dataset)==null?void 0:n.group)=="keyed"){let o=r.querySelector(".k").getBoundingClientRect();Or({tree:e,store:t,editMode:"editKey",textRect:o})}},Ie=({tree:e,store:t})=>{let r=e._walker.currentNode.querySelector(".t").getBoundingClientRect();Or({tree:e,store:t,editMode:"editType",textRect:r})},Or=({tree:e,store:t,editMode:r,textRect:l})=>{let a=e._walker.currentNode,n=ie(t,a.id,(c,s)=>me(c,"uiMode",r));e._render(t);let o=e.querySelector("textarea");if(!o)return;let d=window.getComputedStyle(o);o.style.minWidth=l.width+"px",o.style.minHeight=l.height+"px",o._treeItem=a,o.onblur=c=>c.relatedTarget&&c.relatedTarget.id!=o._treeItem.id&&Tn(e,t,o),o.focus()},Tn=(e,t,r)=>{let l=ie(t,r._treeItem.id,(a,n)=>Object.assign(a,{uiMode:"cancelled-edit"}));e._render(t),l&&(e._walker.currentNode=e.querySelector(`[id='${CSS.escape(r._treeItem.id)}']`),E(e,e._walker.currentNode))},Te=({tree:e,store:t},r)=>{r.id=="key-edit"?Sr(e,t,r,xn):r.id=="type-edit"&&Sr(e,t,r,hn)},Sr=(e,t,r,l)=>{let a=e._walker.currentNode;r._treeItem=r.closest("[role='treeitem']"),E(e,r._treeItem,{focus:!1});let n=l(e,t,r)||a.id;ie(t,n,(o,d)=>Object.assign(o,{uiMode:"editted"})),e._render(t),e._walker.currentNode=e.querySelector(`[id='${CSS.escape(n)}']`),E(e,e._walker.currentNode)},hn=(e,t,r)=>{let a=(Dr(e,t)||t.allowedSchs).find(d=>d.type==r.value),n=t._models[r.value]&&r.value||Object.keys(t._models).find(d=>t._models[d].display==r.value),o=it(r.value);return a?pt(t,r._treeItem.id,()=>st(a)):n?pt(t,r._treeItem.id,()=>Ge(n)):o&&pt(t,r._treeItem.id,()=>o),e._walker.currentNode.id},xn=(e,t,r)=>{let l=ye(e),a=r.dataset.parentPath;l[r.dataset.parentPath]=l[r.dataset.parentPath].filter(s=>s.id==r._treeItem.id).map(s=>({id:s.id,newK:r.value,index:s.index}));let n=l[r.dataset.parentPath][0].index,d=ut(t,{dstPath:a,startIndex:n},l)[a][0].k;return`${r._treeItem.parentNode.closest("[role='treeitem']").id}[${d}]`},j=({tree:e,store:t})=>{let r=qe(()=>e._walker.nextSibling())||qe(()=>e._walker.previousSibling())||qe(()=>e._walker.parentNode());dt(t,ye(e)),e._render(t),E(e,r)},Ce=({tree:e,store:t})=>{var l;let r=e._walker.currentNode;!r||((l=t.entryable)==null?void 0:l.includes(r.dataset.tag))&&(ie(t,r.id,(a,n)=>Object.assign(a,{isEntry:!0})),e._render(t),E(e,r))};var Be=({store:e,tree:t})=>{se(t);for(let l of t.querySelectorAll("[aria-selected='true']"))l.classList.add("item-cutting");let r=ye(t,{ops:".item-cutting"});window._treeClipboard={type:"cut",srcStoreKey:e.key,ops:l=>dt(e,r,{dstPath:l}),selected:r}},He=({store:e,tree:t})=>{if(document.getSelection().toString().length!=0)return;se(t);for(let l of t.querySelectorAll("[aria-selected='true']"))l.classList.add("item-copying");let r=ye(t,{ops:".item-copying"});window._treeClipboard={type:"copy",srcStoreKey:e.key,ops:l=>Mt(e,r,{dstPath:l,startIndex:0}),selected:r}},K=({tree:e,store:t,srcStore:r})=>{var a;let l=C(t,e._walker.currentNode.id);if(!![$,D,S].includes(l.type)&&!(((a=t.put)==null?void 0:a.onlyDst)&&!t.put.onlyDst[t.taggedLevel[l._meta.level]])&&window._treeClipboard){let n=e._walker.currentNode.id,{type:o,srcStoreKey:d,ops:c,selected:s}=window._treeClipboard,u=s,p={};if(t.key==d)switch(o){case"copy":p=Ct(t,{dstPath:n},u);break;case"cut":p=ut(t,{dstPath:n},u);break}else switch(o){case"copy":let x=c("");p=It(t,{dstPath:n},x);break;case"cut":let _=c("");p=St(t,{dstPath:n},_);break}let m=(x,_)=>{let b={};for(let y of Object.keys(_))y==l._meta.path?b[""]=_[y]:b[y]=_[y];x._render(l),se(x),Se(x,b)};Object.keys(p).length!=0&&(l._tree?m(l._tree,p):(e._render(t),se(e),Se(e,p)))}},F=({tree:e,store:t})=>Mr({tree:e,store:t,direction:"up"},r=>r[0].index),q=({tree:e,store:t})=>Mr({tree:e,store:t,direction:"down"},r=>r[r.length-1].index+1),Mr=({tree:e,store:t,direction:r},l)=>{let a=ye(e),n={};for(let o of Object.keys(a))n=Ct(t,{dstPath:o,startIndex:l(a[o])},{[o]:a[o]});Object.keys(n).length!=0&&(e._render(t),Se(e,n,{direction:r}))},he=({tree:e,store:t})=>Ir({tree:e,store:t,startIndex:r=>r-1,direction:"up"}),xe=({tree:e,store:t})=>Ir({tree:e,store:t,startIndex:r=>r+1,direction:"down"}),Ir=({tree:e,store:t,startIndex:r,direction:l})=>{let a=ye(e),n={};for(let o of Object.keys(a)){let d=a[o].sort((c,s)=>c.index-s.index);n=ut(t,{dstPath:o,startIndex:r(d[0].index)},a)}Object.keys(n).length!=0&&(e._render(t),Se(e,n,{direction:l}))},Dr=(e,t)=>{var d,c,s;let r=e._walker.currentNode.parentNode.closest("[role='treeitem']");if(!r)return;let l=C(t,r.id),a=e._walker.currentNode,n=C(t,a.id),o=(u,p)=>{if(!u)return!1;let m=!0;for(let x of p)m=m&&u[x[0]]==x[1];return m};for(let u of t.rulesTable||[])if(o(l,u.selector)){if((c=(d=u.rules)==null?void 0:d.nthChild)==null?void 0:c[n._meta.index])return u.rules.nthChild[n._meta.index].allowedSchs;if((s=u.rules.children)==null?void 0:s.allowedSchs)return u.rules.children.allowedSchs}return null},Cr=({tree:e})=>Ut(e),Rr=({tree:e})=>jt(e);var{defineProperties:bn}=Object,Kt=({store:e,target:t,view:r,treeKeyDownCmds:l,textAreaKeyDownCmd:a,opts:n={}})=>{var d;bn(e,{render:{value:function(c){r(c||this)},configurable:!0},currentNode:{writable:!0,configurable:!0},_tree:{writable:!0,configurable:!0}}),e.render();let o=document.querySelector(`${t} [role='tree']`);if(o){o._aria=Rt,o._render=r,e._tree=o,vr(o),o.onkeydown=Nn(e,l,{textAreaKeyDownCmd:a}),o.onclick=En(e);let c=o.querySelector(`[id='${CSS.escape(n.selectId)}']`);if(c&&n.selectId!="")o._walker.currentNode=c,E(o,o._walker.currentNode,{focus:n.focus});else{let s=o._walker.nextNode(),u=((d=e.currentNode)==null?void 0:d.isConnected)&&e.currentNode||o._walker.nextNode()||s;E(o,u,{focus:n.focus})}return o._walker.currentNode.scrollIntoView({block:"center"}),o}},Nn=(e,t,r)=>function(l){_n(l,this,e,t,r)};async function _n(e,t,r,l=[],a={}){switch(e.stopPropagation(),e.code){case"ArrowUp":e.preventDefault();break;case"ArrowDown":e.preventDefault();break}if(e.target instanceof HTMLTextAreaElement)return wn(e,t,r,a.textAreaKeyDownCmd);let o=new Map(l).get(Lr(e));!o||(a.denyCmds||[]).includes(o.name)||An(t,r,o)||(o({tree:t,store:r}),t._walker.currentNode.isConnected||(t._walker.currentNode=t.querySelector(`[id='${CSS.escape(t._walker.currentNode.id)}']`)),r.currentNode=t._walker.currentNode,Ft(t,t._walker.currentNode,o))}var An=(e,t,r)=>{var c,s,u,p,m,x,_;let l=e._walker.currentNode.parentNode.closest("[role='treeitem']");if(!l)return;let a=C(t,l.id),n=e._walker.currentNode,o=C(t,n.id),d=(b,y)=>{if(!b)return!1;let f=!0;for(let N of y)f=f&&b[N[0]]==N[1];return f};for(let b of t.rulesTable||[])if(d(a,b.selector)&&(((u=(s=(c=b.rules)==null?void 0:c.nthChild)==null?void 0:s[o._meta.index])==null?void 0:u.exceptActions)&&b.rules.nthChild[o._meta.index].exceptActions.map(y=>y.name).includes(r.name)||((p=b.rules.children)==null?void 0:p.onlyActions)&&!b.rules.children.onlyActions.map(y=>y.name).includes(r.name)||((m=b.rules.children)==null?void 0:m.exceptActions)&&b.rules.children.exceptActions.map(y=>y.name).includes(r.name))||d(o,b.selector)&&(((x=b.rules.self)==null?void 0:x.onlyActions)&&!b.rules.self.onlyActions.map(y=>y.name).includes(r.name)||((_=b.rules.self)==null?void 0:_.exceptActions)&&b.rules.self.exceptActions.map(y=>y.name).includes(r.name)))return!0;return!1},wn=(e,t,r,l=[])=>{e.stopPropagation();let a=e.target,o=new Map(l).get(Lr(e));!o||(o({tree:t,store:r},a),r.currentNode=t._walker.currentNode,Ft(t,t._walker.currentNode,o))},En=e=>function(t){return vn(t,this,e)};function vn(e,t,r){e.stopPropagation();let l=t._walker.currentNode,a=e.target.closest("[role='treeitem']"),n=!t.querySelector("textarea");if(!!a){if(e.shiftKey||e.metaKey)switch(l.compareDocumentPosition(a)){case Node.DOCUMENT_POSITION_CONTAINS:return E(t,a);case Node.DOCUMENT_POSITION_CONTAINED_BY:return E(t,l);default:if(a.parentNode.closest("[role='treeitem']")!=l.parentNode.closest("[role='treeitem']"))return E(t,a)}e.shiftKey?(l!=a&&document.getSelection().removeAllRanges(),Fe(t,l,a)):e.metaKey?$r(l,t._walker.currentNode=a):(t._walker.currentNode=a,Me({tree:t},{notFocusIfTextArea:n}),r.currentNode=t._walker.currentNode,Ft(t,a,Me))}}var Lr=({shiftKey:e,metaKey:t,altKey:r,ctrlKey:l,key:a})=>{let n=[];return e&&n.push("shift"),(t||l)&&n.push("meta"),r&&n.push("alt"),a&&n.push(a),n.join("-")},Ft=(e,t,r)=>e.dispatchEvent(new CustomEvent("tree-command",{bubbles:!0,detail:{target:t,command:r}}));var Ye=e=>({get:t=>e.get(t),set:(t,r)=>(e.set(t,r),r)});var Pr=/([^\s\\>"'=]+)\s*=\s*(['"]?)$/,gn=/^(?:area|base|br|col|embed|hr|img|input|keygen|link|menuitem|meta|param|source|track|wbr)$/i,kn=/<[a-z][^>]+$/i,$n=/>[^<>]*$/,Dn=/<([a-z]+[a-z0-9:._-]*)([^>]*?)(\/>)/ig,On=/\s+$/,Ur=(e,t)=>0<t--&&(kn.test(e[t])||!$n.test(e[t])&&Ur(e,t)),Sn=(e,t,r)=>gn.test(t)?e:`<${t}${r.replace(On,"")}></${t}>`,jr=(e,t,r)=>{let l=[],{length:a}=e;for(let o=1;o<a;o++){let d=e[o-1];l.push(Pr.test(d)&&Ur(e,o)?d.replace(Pr,(c,s,u)=>`${t}${o-1}=${u||'"'}${s}${u?"":'"'}`):`${d}<!--${t}${o-1}-->`)}l.push(e[a-1]);let n=l.join("").trim();return r?n:n.replace(Dn,Sn)};var{isArray:Re}=Array,{indexOf:Gr,slice:yt}=[];var Mn=1,Kr=111,In=({firstChild:e,lastChild:t})=>{let r=document.createRange();return r.setStartAfter(e),r.setEndAfter(t),r.deleteContents(),e},Fr=(e,t)=>e.nodeType===Kr?1/t<0?t?In(e):e.lastChild:t?e.valueOf():e.firstChild:e,qr=e=>{let{childNodes:t}=e,{length:r}=t;if(r<2)return r?t[0]:e;let l=yt.call(t,0),a=l[0],n=l[r-1];return{ELEMENT_NODE:Mn,nodeType:Kr,firstChild:a,lastChild:n,valueOf(){if(t.length!==r){let o=0;for(;o<r;)e.appendChild(l[o++])}return e}}};var Wr=(e,t,r,l,a)=>{let n=r.length,o=t.length,d=n,c=0,s=0,u=null;for(;c<o||s<d;)if(o===c){let p=d<n?s?l(r[s-1],-0).nextSibling:l(r[d-s],0):a;for(;s<d;)e.insertBefore(l(r[s++],1),p)}else if(d===s)for(;c<o;)(!u||!u.has(t[c]))&&e.removeChild(l(t[c],-1)),c++;else if(t[c]===r[s])c++,s++;else if(t[o-1]===r[d-1])o--,d--;else if(t[c]===r[d-1]&&r[s]===t[o-1]){let p=l(t[--o],-1).nextSibling;e.insertBefore(l(r[s++],1),l(t[c++],-1).nextSibling),e.insertBefore(l(r[--d],1),p),t[o]=r[d]}else{if(!u){u=new Map;let p=s;for(;p<d;)u.set(r[p],p++)}if(u.has(t[c])){let p=u.get(t[c]);if(s<p&&p<d){let m=c,x=1;for(;++m<o&&m<d&&u.get(t[m])===p+x;)x++;if(x>p-s){let _=l(t[c],0);for(;s<p;)e.insertBefore(l(r[s++],1),_)}else e.replaceChild(l(r[s++],1),l(t[c++],-1))}else c++}else e.removeChild(l(t[c++],-1))}return r};var Br=e=>t=>{for(let r in t){let l=r==="role"?r:`aria-${r}`,a=t[r];a==null?e.removeAttribute(l):e.setAttribute(l,a)}},Hr=(e,t)=>{let r,l=!0,a=document.createAttributeNS(null,t);return n=>{r!==n&&(r=n,r==null?l||(e.removeAttributeNode(a),l=!0):(a.value=n,l&&(e.setAttributeNodeNS(a),l=!1)))}},Yr=(e,t,r)=>l=>{r!==!!l&&((r=!!l)?e.setAttribute(t,""):e.removeAttribute(t))},Cn=({dataset:e})=>t=>{for(let r in t){let l=t[r];l==null?delete e[r]:e[r]=l}},zr=(e,t)=>{let r,l=t.slice(2);return!(t in e)&&t.toLowerCase()in e&&(l=l.toLowerCase()),a=>{let n=Re(a)?a:[a,!1];r!==n[0]&&(r&&e.removeEventListener(l,r,n[1]),(r=n[0])&&e.addEventListener(l,r,n[1]))}},Jr=e=>t=>{typeof t=="function"?t(e):t.current=e},Vr=(e,t)=>t==="dataset"?Cn(e):r=>{e[t]=r},Xr=e=>{let t;return r=>{t!=r&&(t=r,e.textContent=r==null?"":r)}};var Rn=function(e){"use strict";var t="fragment",r="template",l="content"in o(r),a=l?function(c){var s=o(r);return s.innerHTML=c,s.content}:function(c){var s=o(t),u=o(r),p=null;if(/^[^\S]*?<(col(?:group)?|t(?:head|body|foot|r|d|h))/i.test(c)){var m=RegExp.$1;u.innerHTML="<table>"+c+"</table>",p=u.querySelectorAll(m)}else u.innerHTML=c,p=u.childNodes;return n(s,p),s};return function(s,u){return(u==="svg"?d:a)(s)};function n(c,s){for(var u=s.length;u--;)c.appendChild(s[0])}function o(c){return c===t?e.createDocumentFragment():e.createElementNS("http://www.w3.org/1999/xhtml",c)}function d(c){var s=o(t),u=o("div");return u.innerHTML='<svg xmlns="http://www.w3.org/2000/svg">'+c+"</svg>",n(s,u.firstChild.childNodes),s}}(document),qt=Rn;var Qr=({childNodes:e},t)=>e[t],Tt=e=>{let t=[],{parentNode:r}=e;for(;r;)t.push(Gr.call(r.childNodes,e)),e=r,r=e.parentNode;return t},{createTreeWalker:Zr,importNode:ht}=document;var el=ht.length!=1,tl=el?(e,t,r)=>ht.call(document,qt(e,t,r),!0):qt,rl=el?e=>Zr.call(document,e,1|128,null,!1):e=>Zr.call(document,e,1|128);var ze=(e,t,r)=>Wr(e.parentNode,t,r,Fr,e),Ln=e=>{let t,r,l=[],a=n=>{switch(typeof n){case"string":case"number":case"boolean":t!==n&&(t=n,r?r.textContent=n:r=document.createTextNode(n),l=ze(e,l,[r]));break;case"object":case"undefined":if(n==null){t!=n&&(t=n,l=ze(e,l,[]));break}if(Re(n)){t=n,n.length===0?l=ze(e,l,[]):typeof n[0]=="object"?l=ze(e,l,n):a(String(n));break}"ELEMENT_NODE"in n&&t!==n&&(t=n,l=ze(e,l,n.nodeType===11?yt.call(n.childNodes):[n]))}};return a},Pn=(e,t)=>{switch(t[0]){case"?":return Yr(e,t.slice(1),!1);case".":return Vr(e,t.slice(1));case"o":if(t[1]==="n")return zr(e,t)}switch(t){case"ref":return Jr(e);case"aria":return Br(e)}return Hr(e,t)};function ll(e){let{type:t,path:r}=e,l=r.reduceRight(Qr,this);return t==="node"?Ln(l):t==="attr"?Pn(l,e.name):Xr(l)}var Je="is\xB5",nl=Ye(new WeakMap),Un=/^(?:plaintext|script|style|textarea|title|xmp)$/i,Le=()=>({stack:[],entry:null,wire:null}),Gn=(e,t)=>{let{content:r,updates:l}=jn(e,t);return{type:e,template:t,content:r,updates:l,wire:null}},Kn=(e,t)=>{let r=jr(t,Je,e==="svg"),l=tl(r,e),a=rl(l),n=[],o=t.length-1,d=0,c=`${Je}${d}`;for(;d<o;){let s=a.nextNode();if(!s)throw`bad template: ${r}`;if(s.nodeType===8)s.textContent===c&&(n.push({type:"node",path:Tt(s)}),c=`${Je}${++d}`);else{for(;s.hasAttribute(c);)n.push({type:"attr",path:Tt(s),name:s.getAttribute(c)}),s.removeAttribute(c),c=`${Je}${++d}`;Un.test(s.tagName)&&s.textContent.trim()===`<!--${c}-->`&&(s.textContent="",n.push({type:"text",path:Tt(s)}),c=`${Je}${++d}`)}}return{content:l,nodes:n}},jn=(e,t)=>{let{content:r,nodes:l}=nl.get(t)||nl.set(t,Kn(e,t)),a=ht.call(document,r,!0),n=l.map(ll,a);return{content:a,updates:n}},Ve=(e,{type:t,template:r,values:l})=>{let{length:a}=l;al(e,l,a);let{entry:n}=e;(!n||n.template!==r||n.type!==t)&&(e.entry=n=Gn(t,r));let{content:o,updates:d,wire:c}=n;for(let s=0;s<a;s++)d[s](l[s]);return c||(n.wire=qr(o))},al=({stack:e},t,r)=>{for(let l=0;l<r;l++){let a=t[l];a instanceof xt?t[l]=Ve(e[l]||(e[l]=Le()),a):Re(a)?al(e[l]||(e[l]=Le()),a,a.length):e[l]=null}r<e.length&&e.splice(r)};function xt(e,t,r){this.type=e,this.template=t,this.values=r}var{create:Fn,defineProperties:qn}=Object,ol=e=>{let t=Ye(new WeakMap),r=l=>(a,...n)=>Ve(l,{type:e,template:a,values:n});return qn((l,...a)=>new xt(e,l,a),{for:{value(l,a){let n=t.get(l)||t.set(l,Fn(null));return n[a]||(n[a]=r(Le()))}},node:{value:(l,...a)=>Ve(Le(),{type:e,template:l,values:a}).valueOf()}})},il=Ye(new WeakMap),bt=(e,t)=>{let r=typeof t=="function"?t():t,l=il.get(e)||il.set(e,Le()),a=r instanceof xt?Ve(l,r):r;return a!==l.wire&&(l.wire=a,e.textContent="",e.appendChild(a.valueOf())),e},h=ol("html"),Co=ol("svg");var Nt={};er(Nt,{ENTRY_MARKED:()=>Pe,MOVED:()=>W,NEW:()=>be,NEW_KEY:()=>_e,NEW_ORDER:()=>Ee,NEW_TYPE:()=>B,REMOVED:()=>Ne,buildBaseIndices:()=>Wn,diff:()=>Bn});var be="new",Ne="removed",W="moved",Ee="order_changed",_e="key_changed",B="type_changed",Pe="entry_changed",Wn=e=>{let t={};U(e,(r,l)=>(oe(r,"_meta",l),Object.assign(t,{[r.$anchor]:r}),delete r._visit,delete r._pruned,r)),e._indices=t},Bn=(e,t,r={})=>{let l=[],a=t._indices;U(e,(o,d)=>{me(o,"_diff",{});let c=a[o.$anchor];if(c){let s=d.parent,u=c._meta.parent;u.$anchor!=s.$anchor&&Object.assign(o._diff||(o._diff={}),{[W]:{oldParent:u,newParent:s,oldPath:c._meta.path,newPath:d.path}}),c.index!=o.index&&Object.assign(o._diff||(o._diff={}),{[Ee]:{oldOrder:c.index,newOrder:o.index}}),c.type!=o.type&&Object.assign(o._diff||(o._diff={}),{[B]:{oldType:c.type,newType:o.type,parent:s}}),c.$ref!=o.$ref&&Object.assign(o._diff||(o._diff={}),{[B]:{oldType:c.$ref,newType:o.$ref,parent:s}}),c.const!=o.const&&Object.assign(o._diff||(o._diff={}),{[B]:{oldType:c.const,newType:o.const,parent:s}}),c.key!=o.key&&Object.assign(o._diff||(o._diff={}),{[_e]:{oldKey:c.key,newKey:o.key,parent:s}}),c.isEntry!=o.isEntry&&Object.assign(o._diff||(o._diff={}),{[Pe]:{oldIsEntry:c.isEntry,newIsEntry:o.isEntry,parent:s}}),Object.keys(o._diff).length!=0&&(Object.assign(o._diff,{meta:{level:d.level,path:d.path,parentAnchor:d.parent.$anchor}}),l.push(o)),c._visit=!0}else o._diff={[be]:{parent:d.parent},meta:{level:d.level,path:d.path,parentAnchor:d.parent.$anchor}},l.push(o),o._pruned=!0;return o});let n=[];return U(t,(o,d)=>(me(o,"_diff",{}),o._visit||(o._diff={[Ne]:{parent:d.parent},meta:{level:d.level,path:d.path,parentAnchor:d.parent.$anchor}},n.push(o),o._pruned=!0),o)),l=l.concat(n),l};var sl=(e,t)=>{e.errors={},e.changes={},e.metadata||(e.metadata={}),Xe(e,"title",t),Xe(e,"description",t),Yn(e,"rw",["rw","r","w"],t),Wt(e,"required",t),Hn(e,t);for(let r of Object.keys(e.changes))(e.errors[r]||[]).length==0&&(e.metadata[r]=e.changes[r]);return e},Hn=(e,t)=>{switch(e.type){case $:Xn(e,t);break;case M:Qn(e,t);break;case S:Zn(e,t);break;case D:ea(e,t);break;case O:ta(e,t);break;case z:zn(e,t);break;case J:case X:case Z:case V:case Q:case ee:cl(e,t,{min:e.min,max:e.max});break;case te:case re:cl(e,t);break;case le:Jn(e,t);break;case we:Vn(e,t);break}},zn=(e,t)=>{ra(e,"pattern",t),de(e,"min",t,{min:0}),de(e,"max",t,{min:0}),Qe(e,t),Xe(e,"default",t,Object.assign(dl(e,["min","max","pattern"]),{ignoreEmpty:!0}))},Jn=(e,t)=>{Wt(e,"default",t)},cl=(e,t,r)=>{Et(e,"min",t,r),Et(e,"max",t,r),de(e,"multipleOf",t),Qe(e,t),Et(e,"default",t,dl(e,["min","max","multipleOf"]))},Vn=(e,t)=>{la(e,"default",t)},Xn=(e,t)=>{de(e,"min",t,{min:0}),de(e,"max",t,{min:0}),Qe(e,t)},Qn=(e,t)=>{de(e,"min",t,{min:1}),de(e,"max",t,{min:1}),Qe(e,t),Wt(e,"unique",t)},Zn=(e,t)=>{de(e,"min",t,{min:1}),de(e,"max",t,{min:1}),Qe(e,t)},ea=(e,t)=>{},ta=(e,t)=>{Xe(e,"tagname",t,{min:1})},dl=(e,t=[])=>{let r={};for(let l of t)(e.errors[l]||[]).length==0&&(typeof e.changes[l]=="number"?(e.changes[l]||e.changes[l]==0)&&(r[l]=e.changes[l]):r[l]=e.changes[l]);return r},Xe=(e,t,r,l={})=>{if(!r.hasOwnProperty(t)||l.ignoreEmpty&&r[t]=="")return;let a=r[t],n=2**18;(d=>new Blob([d]).size)(a)>n?k(e,t,`string size limit is ${Math.ceil(n/1024)} KB`):l.max&&a.length>l.max?k(e,t,`must be less than or equal ${l.max} length`):l.min&&a.length<l.min?k(e,t,`must be grater than or equal ${l.min} length`):l.pattern?new RegExp(l.pattern).test(a)||k(e,t,`must matche pattern ${l.pattern}`):e.changes[t]=a},Wt=(e,t,r)=>{if(!r.hasOwnProperty(t))return e.changes[t]=!1;let l=na(r[t]);l==null?k(e,t,"must be boolean"):e.changes[t]=l},Et=(e,t,r,l={})=>{if(!r.hasOwnProperty(t))return;let a=Bt(r[t]);!a&&a!=0?k(e,t,"must be number"):l.min&&a<l.min?k(e,t,`must be greater than or equal ${l.min}`):l.max&&a>l.max?k(e,t,`must be less than than or equal ${l.max}`):l.multipleOf&&a%l.multipleOf!=0?k(e,t,`must be multiple of ${l.multipleOf}`):e.changes[t]=a},de=(e,t,r,l)=>{if(!r.hasOwnProperty(t))return;Et(e,t,r,l);let a=e.changes[t];(e.errors[t]||[]).length==0&&!Number.isInteger(e.changes[t])?k(e,t,"must be integer number"):a>Number.MAX_SAFE_INTEGER?k(e,t,`must be less than or equal ${Number.MAX_SAFE_INTEGER}`):a<Number.MIN_SAFE_INTEGER&&k(e,t,`must be greater than or equal ${Number.MIN_SAFE_INTEGER}`)},ra=(e,t,r)=>{if(!!r.hasOwnProperty(t)&&(Xe(e,t,r),(e.errors[t]||[]).length==0))try{let l=r[t];if(l=="")return;e.changes[t]=new RegExp(l)}catch(l){k(e,t,"invalid regex")}},Qe=(e,t)=>{if(t.min&&t.max){let r=Bt(t.min),l=Bt(t.max);(r||r==0)&&(l||l==0)&&r>l&&(k(e,"min","min is greater than max"),k(e,"max","max is less than min"))}},la=(e,t,r)=>{!r.hasOwnProperty(t)||(r[t]!=null?k(e,t,"must be null"):e.changes[t]=r[t])},Yn=(e,t,r,l)=>{!l.hasOwnProperty(t)||(r.includes(l[t])?e.changes[t]=l[t]:k(e,t,"value must be r, w, or rw"))},k=(e,t,r)=>{e.errors[t]=[],e.errors[t].push(r)},Bt=e=>ul(e,"number"),na=e=>ul(e,"boolean");var ul=(e,t)=>{try{return e=JSON.parse(e),t==typeof e?e:void 0}catch(r){return}};customElements.define("sch-meta",class extends HTMLElement{connectedCallback(){this.addEventListener("change",this.handleMetaChange),this.addEventListener("input",this.handleMetaChange),this.addEventListener("paste",this.handleMetaChange),this.addEventListener("focusout",this.handleMetaChange)}disconnectedCallback(){this.removeEventListener("change",this.handleMetaChange),this.removeEventListener("input",this.handleMetaChange),this.removeEventListener("paste",this.handleMetaChange),this.removeEventListener("focusout",this.handleMetaChange)}handleMetaChange(e){if(e.target instanceof HTMLTextAreaElement||e.target instanceof HTMLInputElement||e.target instanceof HTMLSelectElement){let t=n=>["checkbox","radio"].includes(n.type)?n.checked:n.value,r=this.querySelector("form").elements,l={};for(let n=0;n<r.length;n++){let o=t(r[n]);!(r[n]instanceof HTMLTextAreaElement)&&o==""||(l[r[n].name]=o)}let a={path:e.target.closest("[data-path]").dataset.path,file:e.target.closest("[data-file]").dataset.file,attrs:l};this.dispatchEvent(new CustomEvent("sch-update",{detail:a,bubbles:!0}))}}});var Ht=(e,t,r)=>{try{bt(e,h.for(t)`
    <p class="meta-def">${aa(t.rootKey,t.path)||"-"} : <span>${t.type}</span></p>
    <form data-path="${t.path}" data-file="${t.rootKey}" class="fbox">
      ${Ze(t,"title",{keyDisplay:"Title"})}
      ${Ze(t,"description",{keyDisplay:"Description"})}
      ${sa(t)}
      ${oa(t,"rw",{collection:[["r","Readonly"],["w","Writeonly"],["rw","Read and Write"]],selected:A(t,"rw")||"rw",keyDisplay:"Read / Write"})}
      ${ia(t,"default",{keyDisplay:"Default",min:A(t,"min"),max:A(t,"max")})}
    </form>
  `)}catch(l){console.log(l)}},aa=(e,t)=>{t=t.substring(1,t.length-1).split("][").filter(l=>l!=""),t.splice(0,0,e);let r=h`<span style="color: var(--meta-def-color);">${t[0]} :: ${t[1]}</span>`;return t=t.slice(2).flatMap(l=>[h`<span style="margin: 0 .5rem;">/</span>`,document.createTextNode(l)]),t.splice(0,0,r),t},et=(e,t,r,l={})=>{var a;return h`
  <label class="${l.readonly&&`box-label ${t} readonly`||`box-label ${t}`}">
    <p class="l">${l.keyDisplay||t} ${l.readonly&&h`<span>· readonly</span>`}</p>
    ${r}
    ${(a=_t(e,t))==null?void 0:a.map(n=>h`<p class="err">${n}</p>`)}
  </label>
  `},Ze=(e,t,r={})=>et(e,t,h`
    <textarea name="${tt(e,t)}" maxlength="${r.maxlength}" minlength="${r.minlength}" ?readonly="${r.readonly}" rows="1" spellcheck="false" class="${_t(e,t)&&"invalid"}" oninput="${Ke}">${r.value||A(e,t)}</textarea>
  `,r),ge=(e,t,r={})=>et(e,t,h`
    <input type="number" name="${tt(e,t)}" inputmode="decimal" step="${r.step||"any"}" min="${r.min}" max="${r.max}" value="${r.value||A(e,t)}" ?readonly="${r.readonly}" class="${_t(e,t)&&"invalid"}">
  `,r),Ae=(e,t,r={})=>et(e,t,h`
    <input type="number" name="${tt(e,t)}" inputmode="numeric" pattern="[0-9]*" min="${r.min}" max="${r.max}" value="${r.value||A(e,t)}" ?readonly="${r.readonly}" class="${_t(e,t)&&"invalid"}">
  `,r),Yt=(e,t,r={})=>et(e,t,h`
    <input type="checkbox" name="${tt(e,t)}" ?disabled="${r.readonly}" ?checked="${r.value||A(e,t)}">
  `,r),oa=(e,t,r={})=>et(e,t,h`
    <select name="${tt(e,t)}" ?disabled="${r.readonly}">
      ${r.collection.map(([l,a])=>h`<option value="${l}" ?selected="${(r.selected||A(e,t))==l}">${a}</option>`)}
    </select>
  `,r),ia=(e,t,r={})=>{switch(e.type){case le:return Yt(e,t,r);case J:case X:case Z:case V:case Q:case ee:case te:case re:return ge(e,t,r);case z:return Ze(e,t,r);default:return""}},tt=(e,t)=>t,A=(e,t)=>(e.metadata||{})[t],sa=e=>{let t;switch(e.type){case $:let n=0;for(let o of e.fields)A(o,"required")&&n++;t=[Ae(e,"min",{keyDisplay:"Min Properties",value:n,readonly:!0}),Ae(e,"max",{keyDisplay:"Max Properties",value:e.fields.length,min:Math.max(A(e,"min")||0,0)})];break;case M:t=[Ae(e,"min",{keyDisplay:"Min Items",min:1,value:1,max:A(e,"max")}),Ae(e,"max",{keyDisplay:"Max Items",min:A(e,"min")}),Yt(e,"unique",{keyDisplay:"Item uniqueness"})];break;case S:t=[Ae(e,"min",{keyDisplay:"Min Items",value:e.schs.length,readonly:!0}),Ae(e,"max",{keyDisplay:"Max Items",value:A(e,"max")||e.schs.length})];break;case O:t=[Ze(e,"tagname",{keyDisplay:"Tag name",value:e.tagname})];break;case z:t=[Ae(e,"min",{keyDisplay:"Min Length",min:0,max:A(e,"max")}),Ae(e,"max",{keyDisplay:"Max Length",min:Math.max(0,A(e,"min"))}),Ze(e,"pattern",{keyDisplay:"Pattern",maxlength:256})];break;case J:case X:case Z:case V:case Q:case ee:t=[ge(e,"min",{keyDisplay:"Min",min:e.min,max:Math.min(A(e,"max"),e.max)}),ge(e,"max",{keyDisplay:"Max",min:Math.max(A(e,"min"),e.min),max:e.max}),ge(e,"multipleOf",{keyDisplay:"Multiple of",min:1,max:Math.min(A(e,"max"),e.max)})];break;case te:case re:t=[ge(e,"min",{keyDisplay:"Min",max:A(e,"max")}),ge(e,"max",{keyDisplay:"Max",min:A(e,"min")}),ge(e,"multipleOf",{keyDisplay:"Multiple of",min:1,max:A(e,"max")})];break;case le:t=[];case we:t=[];case D:t=[];case $e:t=[];case P:t=[];case ne:t=[];default:t=[]}let r=e._meta.parent.type==$,l=e._meta.level>2,a=!e.isKeyPattern;return r&&l&&a&&t.push(Yt(e,"required",{keyDisplay:"Required"})),t};var _t=(e,t)=>e.errors&&e.errors[t];var zt=(e,t,r={})=>{var l;try{let a={level:1,tab:((l=r.ui)==null?void 0:l.tab)||0,models:t._models||{},schMetas:t.schMetas,rootKey:t.key,taggedLevel:t.taggedLevel};a.rootLevel=a.level,Object.assign(a,r.ui),r.ui.lineClass&&Object.assign(a,{tab:r.ui.tab+2}),ca(e,{sch:t,ui:a,path:t.path||"",key:t.key,parent:t})}catch(a){console.log(a)}},ca=(e,t)=>bt(document.querySelector(e),h`
  <ul role="tree" aria-multiselectable="true" class="${`${t.ui.lineClass||""} text-sm`}" aria-labelledby="${t.ui.taggedLevel[t.ui.level]+"_tree"}">
    ${rt(t)}
  </ul>
`),pl=e=>{if(!e)return"";for(let t of Object.keys(e))switch(t){case be:return"N";case Ne:return"R";case W:return"M";case Ee:return"";case _e:return"C";case B:return"C";case Pe:return"C"}},rt=e=>{switch(!0){case e.ui.level==e.ui.rootLevel:return da(e);case[M].includes(e.sch.type):return e.sch.sch.hasOwnProperty("fields")||e.sch.sch.hasOwnProperty("schs")?Object.assign(e.ui,{expanded:!0}):Object.assign(e.ui,{expanded:!1}),fl(e);case(e.sch.hasOwnProperty("fields")||e.sch.hasOwnProperty("schs")):return Object.assign(e.ui,{expanded:!0}),fl(e);default:return ua(e)}},da=e=>h.for(e.parent,e.sch.$anchor)`
  <li id="${e.path}" .dataset="${{tag:e.ui.taggedLevel[e.ui.level]}}" .key="${e.key}" .index="${0}" aria-posinset="${1}" class="root-item" role="treeitem" aria-level="${e.ui.level}" aria-selected="false" aria-expanded="${e.ui.expanded}" tabindex="-1">
    <dfn class="h" id="${e.ui.taggedLevel[e.ui.level]+"_tree"}">
      ${Jt(e.key)}
    </dfn>
    <ul data-group="${yl(e.sch)}" role="group" tabindex="-1">
      ${ml(e)}
    </ul>
  </li>`,fl=e=>h.for(e.parent,e.sch.$anchor)`
  <li id="${e.path}" .dataset="${{tag:e.ui.taggedLevel[e.ui.level]}}" .key="${e.key}" .index="${e.ui.index}" aria-posinset="${e.ui.index+1}" class="folder" role="treeitem" aria-level="${e.ui.level}" aria-selected="false" aria-expanded="${e.ui.expanded}" tabindex="-1">
    <dfn class="h" .dataset="${{diff:pl(e.sch._diff),groupSize:pa(e.sch)}}">
      ${Tl(Object.assign(e,{key:Jt(e.key)}))}
      ${hl(e)}
    </dfn>
    <ul data-group="${yl(e.sch)}" role="group">
      ${ml(e)}
    </ul>
  </li>`,ua=e=>h.for(e.parent,e.sch.$anchor)`
  <li id="${e.path}" .dataset="${{tag:e.ui.taggedLevel[e.ui.level],diff:pl(e.sch._diff)}}" .key="${e.key}" .index="${e.ui.index}" aria-posinset="${e.ui.index+1}" class="file" role="treeitem" aria-level="${e.ui.level}" aria-selected="false" tabindex="-1">
    ${Tl(Object.assign(e,{key:Jt(e.key)}))}
    ${hl(e)}
  </li>`,ml=e=>{if(e.ui.depthLimit&&e.ui.level>=e.ui.depthLimit)return h``;switch(!0){case[$,O].includes(e.sch.type):return fa(e);case[S,pe,L].includes(e.sch.type):return ma(e);case[M].includes(e.sch.type):return ya(e);case[D].includes(e.sch.type):return Ta(e);default:return h``}},fa=e=>{let t=[];for(let r=0;r<e.sch.fields.length;r++)t.push(rt({key:e.sch.fields[r].key,sch:e.sch.fields[r],parent:e.sch,ui:{...e.ui,level:e.ui.level+1,index:r,parentPath:e.path},path:`${e.path}[${e.sch.fields[r].key}]`}));return t},ma=e=>{let t=[];for(let r=0;r<e.sch.schs.length;r++)t.push(rt({key:r,sch:e.sch.schs[r],parent:e.sch,ui:{...e.ui,level:e.ui.level+1,index:r,parentPath:e.path},path:`${e.path}[][${r}]`}));return t},ya=e=>rt({key:0,sch:e.sch.sch,parent:e.sch,ui:{...e.ui,level:e.ui.level+1,index:0,parentPath:e.path},path:`${e.path}[][${0}]`}),Ta=e=>{let t=[];for(let r=0;r<e.sch.schs.length;r++)t.push(rt({key:"",sch:e.sch.schs[r],parent:e.sch,ui:{...e.ui,level:e.ui.level+1,index:r,parentPath:e.path},path:`${e.path}[][${r}]`}));return t},H=(e,t=0)=>`padding-left: ${(e.ui.level-1)*2+e.ui.tab-1+t}ch`,xl=(e,t,r)=>h`<textarea id="${e}" class="no-resize" spellcheck="false" maxlength="255" rows="1" autofocus
  data-parent-path="${t}"
  oninput="${Ke}"
  onfocus="${Ar}"
  >${r}</textarea>`,Tl=e=>e.ui.level==e.ui.rootLevel+1?ha(e):xa(e),ha=e=>h`
  <span class="def" style="${H(e)}">
    ${ba(e.sch,e.ui)}
  </span>
  <span class="k">${At(e)}</span>
  <span class="s">=</span>
  `,xa=e=>{switch(!0){case e.parent.type==D:return h`
      <span class="s" style="${H(e,1)}">|</span>
      `;case(e.parent.type==pe&&e.sch.$anchor==e.parent.schs[0].$anchor):return h`
      <span class="s" style="${H(e)}">k</span>
      `;case(e.parent.type==pe&&e.sch.$anchor==e.parent.schs[1].$anchor):return h`
      <span class="s" style="${H(e)}">v</span>
      `;case(e.parent.type==L&&e.sch.$anchor==e.parent.schs[0].$anchor):return h`
      <span class="s" style="${H(e)}">extends</span>
      `;case(e.parent.type==L&&e.sch.$anchor==e.parent.schs[1].$anchor):return h`
      <span class="s" style="${H(e)}">record</span>
      `;case e.parent.type==M:return h`
      <span class="s" style="${H(e)}">└</span>
      `;case e.parent.type==$:let t=e.ui.schMetas[e.sch.$anchor];return h`
      <span class="k" style="${H(e,1)}" .dataset="${{required:t==null?void 0:t.required}}">
        ${At(e)}
      </span>
      <span class="s">:</span>
    `;case e.parent.type==O:return h`
      <span class="s" style="${H(e,.5)}">|</span>
      <span class="k tag">
        ${At(e)}
      </span>
      <span class="s">·</span>
    `;default:return h`
      <span class="k" style="${H(e,1)}">
        ${At(e)}
      </span >
      <span class="s">:</span>
    `}},At=e=>e.sch.uiMode=="editKey"?xl("key-edit",e.ui.parentPath,e.key):h`${e.key}`,hl=e=>e.ui.level==e.ui.rootLevel+1?Na(e):Ea(e),Na=e=>e.ui.viewTypeTop?e.ui.viewTypeTop(e):h`<span class="t">${bl(e)}</span>`,Ea=e=>h`<span class="t">${bl(e)}</span>`,bl=e=>e.sch.uiMode=="editType"?h`<combo-box id="type_search" list="typesearch">
      ${xl("type-edit",e.ui.parentPath,Vt(e.sch,e.ui))}
    </combo-box>`:h`${Nl(e.sch,e.ui)}`,Vt=(e,t)=>{var r;switch(!0){case e.type==ne:return JSON.stringify(e.const);case e.type==P:return(r=t.models[e.$ref])==null?void 0:r.display;default:return e.type}},Nl=(e,t)=>{let r,l=t.schMetas[e.$anchor];switch(!0){case(e.type==$&&e.fields.length==0):r="{ any }";break;case e.type==$:r="{ \xA0 }";break;case e.type==L:r="e { }";break;case e.type==M:r=h`[\xa0 ${Nl(e.sch,t)} \xa0]`;break;case e.type==S:r="( \xA0 )";break;case e.type==pe:r="dict";break;case e.type==D:r="||";break;case e.type==O:r=`|| ${(l==null?void 0:l.tagname)||e.tagname}`;break;case e.type==z:r="string";break;case e.type==J:r="int_8";break;case e.type==X:r="int_16";break;case e.type==Z:r="int_32";break;case e.type==V:r="uint_8";break;case e.type==Q:r="uint_16";break;case e.type==ee:r="uint_32";break;case e.type==te:r="float_32";break;case e.type==re:r="float_64";break;case e.type==Ot:r="timestamp";break;case e.type==le:r="bool";break;case e.type==we:r="null";break;case e.type==$e:r="any";break;case(e.type==P&&!!t.models[e.$ref]):r=h`<span class="ref">${e._text=Vt(e,t)}</span>`;break;case(e.type==P&&e.$ref==null):r=h`<span class="ref notfound" title="Ref type">nothing</span>`;break;case e.type==P:r=h`<span class="ref notfound" title="Ref type">${`${e._text||e.$ref} (#404)`}</span>`;break;case e.type==ne:r=h`<span class="value" title="Value type">${Vt(e,t)}</span>`;break;default:r="# UNDEFINED_TYPE #"}return t.typeText&&(r=t.typeText(e,t)||r),r},Jt=e=>e,yl=e=>{switch(!0){case[$,O].includes(e.type):return"keyed";case[S,D,L].includes(e.type):return"indexed";default:return"none"}},pa=e=>{switch(!0){case[$,O].includes(e.type):return e.fields.length;case[S,D,L].includes(e.type):return e.schs.length;case[M].includes(e.type):return 1;default:return 0}},ba=(e,t)=>{let r;switch(!0){case e.type==$:r="record";break;case e.type==M:r="list";break;case e.type==S:r="tuple";break;case e.type==D:r="union";break;case e.type==O:r="tagged union";break;case e.type==L:r="extensible union";break;default:r="field"}return t.modelTypeText&&(r=t.modelTypeText(e,t)||r),r};var{selectMultiNodeUpTo:El,selectMultiNodeDownTo:_l,selectMultiNodeUp:Al,selectMultiNodeDown:wl,selectUpEnd:vl,selectDownEnd:gl,selectUp:kl,selectDown:$l,selectRoot:Dl,selectLast:Ol}=mt,Sl=({store:e,target:t,select:r,focus:l=!0})=>{Kt({store:e,target:t,treeKeyDownCmds:[["shift-meta-ArrowUp",El],["shift-meta-ArrowDown",_l],["shift-ArrowUp",Al],["shift-ArrowDown",wl],["meta-ArrowUp",vl],["meta-ArrowDown",gl],["ArrowUp",kl],["ArrowDown",$l],["Home",Dl],["End",Ol],["shift-+",ce],["Enter",We],["Delete",j],["m",Ce],["meta-v",K],["shift-alt-ArrowUp",F],["shift-alt-ArrowDown",q],["alt-ArrowUp",he],["alt-ArrowDown",xe],["Escape",({tree:a})=>se(a)]],textAreaKeyDownCmd:[["Enter",Te],["Escape",Gt]],view:a=>zt(t,a||e,{ui:{depthLimit:2,tab:0,modelTypeText:(n,o)=>"file",typeText:(n,o)=>{if(n.type==T.RECORD)return"record";if(n.type==T.VALUE)return"value";if(n.type==T.TUPLE)return"tuple";if(n.type==T.UNION)return"union"},viewTypeTop:n=>""}}),opts:{focus:l,selectId:r}})},wt=({store:e,target:t,select:r,focus:l})=>{Kt({store:e,target:t,treeKeyDownCmds:[["shift-meta-ArrowUp",El],["shift-meta-ArrowDown",_l],["shift-ArrowUp",Al],["shift-ArrowDown",wl],["meta-ArrowUp",vl],["meta-ArrowDown",gl],["ArrowUp",kl],["ArrowDown",$l],["Home",Dl],["End",Ol],["shift-+",ce],["Enter",We],["shift-Enter",Ie],["Delete",j],["m",Ce],["meta-x",Be],["meta-c",He],["meta-v",K],["shift-alt-ArrowUp",F],["shift-alt-ArrowDown",q],["alt-ArrowUp",he],["alt-ArrowDown",xe],["ArrowRight",Cr],["ArrowLeft",Rr],["Escape",({tree:a})=>se(a)]],textAreaKeyDownCmd:[["Enter",Te],["Escape",Gt]],view:a=>zt(t,a||e,{ui:{lineClass:"setnu",tab:3,modelTypeText:(n,o)=>n.isEntry?"entrypoint":"type"}}),opts:{focus:l,selectId:r}})},vt=({store:e,target:t,treeTarget:r})=>{let l=document.querySelector(t),a=document.querySelector(`${r} [role='tree']`);!l||!a||(Object.defineProperty(e,"renderSchMeta",{value:function(n){_a({tree:a,store:n||this,metaForm:l})},configurable:!0}),e.renderSchMeta())},_a=({tree:e,store:t,metaForm:r})=>{let l=e.querySelectorAll("[role='treeitem'][aria-selected='true']");if(l.length==1){let a=C(t,l[0].id);a&&(a.path=l[0].id,a.rootKey=e.querySelector(".root-item").key,a.metadata=t.schMetas[a.$anchor],Ht(r,a,t))}};var ue="file",Ue="project",Il=(e,t)=>{Object.assign(t,e);for(let r=0;r<e.fields.length;r++)t.fields[r]=Aa(e.fields[r],Ml(),t);return me(t,"schMetas",e.schMetas),v(()=>t)},Aa=(e,t,r)=>(Object.assign(t,e),v(()=>t)),Rl=()=>Cl({taggedLevel:{1:Ue,2:ue,3:I},allowedSchs:[Ml],put:{pos:"prepend",onlyDst:{[ue]:!0}}}),Ml=()=>Cl({taggedLevel:{1:ue,2:I},addDefault:ae,entryable:[I],put:{pos:"prepend"},rulesTable:Xt}),Cl=(e={})=>{let t=v(ae);return t.allowedSchs=(e.allowedSchs||Qt).map(r=>r()),t.taggedLevel=e.taggedLevel,e.put&&(t.put=e.put),e.entryable&&(t.entryable=e.entryable),e.addDefault&&(t._addSchDefault=t.allowedSchs.find(r=>r.type==e.addDefault().type)&&e.addDefault()),e.rulesTable&&(t.rulesTable=e.rulesTable),t},ke=(e,t)=>{let r=C(e,`[${t}]`);return r&&me(r,"schMetas",e.schMetas),r},lt=e=>{let t={};return Zt(e,(r,l)=>{t[r.$anchor]={display:[l.file.key,r.key].join(" :: "),file:l.file.key,fmodel:r.key,type:r.type}}),t},Zt=(e,t)=>{for(let r of e.fields)for(let l=0;l<r.fields.length;l++)r.fields[l]=t(r.fields[l],{path:`[${r.key}][${r.fields[l].key}]`,file:r})||r.fields[l]},Qt=[ot,ae,xr,br,Nr,fe,or,Tr,()=>it('"json string"'),ir,sr,cr,dr,ur,pr,fr,mr,yr,Er,_r,hr],wa={selector:[["type",pe]],rules:{self:{exceptActions:[ce,K]},children:{exceptActions:[Be,He,F,q,j,he,xe]},nthChild:[{allowedSchs:[ot()]}]}},va={selector:[["type",L]],rules:{self:{exceptActions:[ce,K]},children:{exceptActions:[Be,He,F,q,j,he,xe]},nthChild:[{allowedSchs:[Ge(null)]},{allowedSchs:[ae()],exceptActions:[Ie,Te]}]}},ga={selector:[["type",O]],rules:{children:{allowedSchs:[ae()]}}},Xt=[wa,ga,va];var{selectMultiNodeUpTo:_i,selectMultiNodeDownTo:Ai,selectMultiNodeUp:wi,selectMultiNodeDown:vi,selectUpEnd:Ll,selectDownEnd:Pl,selectUp:Ul,selectDown:jl,selectRoot:Gl,selectLast:Kl}=mt,Fl=(e,t,r,l)=>{let a=t.closest("[data-tag='file']"),n=a==null?void 0:a.key;t.closest("[id='project']")?ka(e,n,r,l):t.closest("[id='fmodel']")&&$a(e,n,t,r,l)},ka=(e,t,r,l)=>{switch(!0){case Da(r.name):nt(e,t),e.render();break;case ql(r.name):nt(e,t),e.render();break;case Oa(r.name):nt(e,t),e.render();break;default:e.render()}},$a=(e,t,r,l,a)=>{let n;switch(!0){case Ma(l.name):if(r.dataset.tag!=I)return;Zt(e,(o,d)=>(d.path!=`[${t}]${r.id}`&&o.isEntry&&delete o.isEntry,o)),n=ke(e,t),n.render();break;case ql(l.name):n=ke(e,t),n._models=lt(e),n.render(),n.renderSchMeta();break;case Sa(l.name):n=ke(e,t),n.render(),n.renderSchMeta()}},nt=(e,t,r=null,l=!1)=>{let a=ke(e,t);if(a&&(a._models=lt(e),wt({store:a,target:"[id='fmodel']",select:r,focus:l}),vt({store:a,target:"[id='fsch']",treeTarget:"[id='fmodel']"}),!window._treeClipboard)){let n=document.querySelector("[id='fmodel'] [role='tree']");n._aria.clearClipboard(n)}},Wl={update:({store:e,detail:t})=>{let{path:r,attrs:l}=t,a=ie(e,r,(n,o)=>sl(n,l));return a&&(e.render&&e.render(e),Object.assign(e.schMetas,{[a.$anchor]:a.metadata}),e.renderSchMeta&&e.renderSchMeta(e)),a}},Sa=e=>[Ul,jl,Ll,Pl,Gl,Kl,Me].map(t=>t.name).includes(e),Da=e=>[Ul,jl,Ll,Pl,Gl,Kl,Me,F,q,j].map(t=>t.name).includes(e),ql=e=>[ce,j,Te,K].map(t=>t.name).includes(e),Bl=e=>[ce,j,Te,K,F,q,he,xe,j,Ce].map(t=>t.name).includes(e),Ma=e=>[Ce,K,F,q].map(t=>t.name).includes(e),Oa=e=>[We,Ie].map(t=>t.name).includes(e);var Hl=(e,t)=>{let r=y=>{for(let f of e.fields)for(let N of f.fields)if(y==N.key)return{file:f,fmodelDst:fmodel}},l=y=>De(e,(f,N)=>{if(e.taggedLevel[N.level]==I&&N.path!="")return y.startsWith(N.path)},(f,N)=>(oe(f,"_meta",N),f)),a=({$anchor:y,key:f,index:N,type:w})=>({$anchor:y,key:f,index:N,type:w}),n=y=>a(y),o=y=>y,d=e._diffToRemote,c={};c.files=[],c.fmodels=[],c.subfmodels=[];for(let y of d){let f=e.taggedLevel[y._diff.meta.level];f==Ue?c.project=y:f==ue?c.files.push(y):f==I?c.fmodels.push(y):c.subfmodels.push(y)}let s={},u={},p={};c.project&&(s.project=n(c.project));for(let y=0;y<c.files.length;y++){let f=c.files[y],N=a(f),w=f._diff.meta.path;if(u.files||(u.files={}),p.files||(p.files={}),s.files||(s.files={}),u.fmodels||(u.fmodels={}),p.fmodels||(p.fmodels={}),f._diff[be]){u.files[w]=N;for(let Y of f.fields)u.fmodels[`[${f.key}][${Y.key}]`]={...o(Y),parentAnchor:N.$anchor}}f._diff[Ne]&&(p.files[w]={$anchor:N.$anchor}),(f._diff[Ee]||f._diff[_e])&&(s.files[w]=N),f._diff[W]&&console.log("project does not permit as parent for moving items"),f._diff[B]&&console.log("file type is always record, cannot be changed")}for(let y=0;y<c.fmodels.length;y++){let f=c.fmodels[y],N=o(f),w=f._diff.meta.path,Y=f._diff.meta.parentAnchor;if(s.files||(s.files={}),u.fmodels||(u.fmodels={}),p.fmodels||(p.fmodels={}),s.fmodels||(s.fmodels={}),f._diff[be]&&(u.fmodels[w]={...N,parentAnchor:Y}),f._diff[Ne]&&(p.fmodels[w]={$anchor:N.$anchor,parentAnchor:Y}),(f._diff[Ee]||f._diff[_e]||f._diff[B]||f._diff[Pe])&&(s.fmodels[w]={...N,parentAnchor:Y}),f._diff[W]){let{oldParent:G,newParent:je,oldPath:Yl,newPath:zl}=f._diff[W];switch(e.taggedLevel[G.level]){case Ue:console.log("fmodel was not possible to be a file");break;case ue:var m=e.fields.find(Jl=>Jl.key==G.key),x=a(m);s.files[G.path]=x,p.fmodels[Yl]={$anchor:f.$anchor,parentAnchor:x.$anchor};break;case I:var _=r(G.key),x=_.file;s.fmodels[G.path]={...o(_.fmodelDst),parentAnchor:x.$anchor};break;default:var b=l(G.path),_=r(b.key),x=_.file;s.fmodels[b._meta.path]={...o(b),parentAnchor:x.$anchor}}switch(e.taggedLevel[je.level]){case ue:var m=e.fields.find(gt=>gt.key==je.key),x=a(m);s.files[je.path]=x,u.fmodels[zl]={...N,parentAnchor:x.$anchor};break;default:console.log("fmodel parent can only be file tag")}}}for(let y=0;y<c.subfmodels.length;y++){let f=c.subfmodels[y],N=f._diff.meta.path;if(s.files||(s.files={}),u.fmodels||(u.fmodels={}),p.fmodels||(p.fmodels={}),s.fmodels||(s.fmodels={}),f._diff[be]||f._diff[Ne]||f._diff[Ee]||f._diff[_e]||f._diff[B]){let w=l(N),G=r(w.key).file;s.fmodels[w._meta.path]={...o(w),parentAnchor:G.$anchor}}if(f._diff[W]){let{oldParent:w,newParent:Y,oldPath:G,newPath:je}=f._diff[W];switch(e.taggedLevel[w.level]){case Ue:console.log("subfmodel was not possible to be a file");break;case ue:var m=e.fields.find(gt=>gt.key==w.key),x=a(m);s.files[w.path]=x,p.fmodels[G]={$anchor:f.$anchor,parentAnchor:x.$anchor};break;case I:default:var b=l(w.path),_=r(b.key),x=a(_.file);s.fmodels[b._meta.path]={...o(b),parentAnchor:x.$anchor}}switch(e.taggedLevel[Y.level]){case Ue:console.log("subfmodel parent can only be fmodel or subfmodel");break;case ue:console.log("subfmodel parent can only be fmodel or subfmodel");break;case I:default:var b=l(je),_=r(b.key),x=_.file;s.fmodels[b._meta.path]={...o(b),parentAnchor:x.$anchor}}}}return console.log({changed:s,added:u,removed:p}),t({changed:s,added:u,removed:p})};var Ia={createProjectStore:Rl,getFileStore:ke,anchorsModels:lt,projectToStore:Il,controller:Fl,changeFile:nt,taggedDiff:Hl,isDiffableCmd:Bl,SchMeta:Wl,allSchs:Qt,rulesTable:Xt};export{Nt as Diff,wt as FmodelTree,Ia as Project,Sl as ProjectTree,vt as SchMetaForm};
/*! (c) Andrea Giammarchi - ISC */
