var Al=Object.create,Gt=Object.defineProperty,Sl=Object.getPrototypeOf,Ol=Object.prototype.hasOwnProperty,Dl=Object.getOwnPropertyNames,Il=Object.getOwnPropertyDescriptor;var Rl=e=>Gt(e,"__esModule",{value:!0});var te=(e,t)=>()=>(t||(t={exports:{}},e(t.exports,t)),t.exports),vn=(e,t)=>{for(var r in t)Gt(e,r,{get:t[r],enumerable:!0})},Cl=(e,t,r)=>{if(t&&typeof t=="object"||typeof t=="function")for(let n of Dl(t))!Ol.call(e,n)&&n!=="default"&&Gt(e,n,{get:()=>t[n],enumerable:!(r=Il(t,n))||r.enumerable});return e},Ml=e=>Cl(Rl(Gt(e!=null?Al(Sl(e)):{},"default",e&&e.__esModule&&"default"in e?{get:()=>e.default,enumerable:!0}:{value:e,enumerable:!0})),e);var mr=te((_c,ki)=>{"use strict";var va={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},_a={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},Na=/(&amp;|&lt;|&gt;|&quot;|&#39;)/g,ka=/[&<>"']/g;function $a(e){return va[e]}function Ea(e){return _a[e]}function nn(e){return e==null?"":String(e).replace(ka,$a)}function ln(e){return e==null?"":String(e).replace(Na,Ea)}nn.options=ln.options={};ki.exports={encode:nn,escape:nn,decode:ln,unescape:ln,version:"1.0.0-browser"}});var Ai=te((Nc,$i)=>{"use strict";function Ei(e){for(var t=Array.prototype.slice.call(arguments,1),r,n;t.length;){r=t.shift();for(n in r)r.hasOwnProperty(n)&&(Object.prototype.toString.call(e[n])==="[object Object]"?e[n]=Ei(e[n],r[n]):e[n]=r[n])}return e}$i.exports=Ei});var an=te((kc,Si)=>{"use strict";Si.exports=function(t){return typeof t=="string"?t.toLowerCase():t}});var sn=te(($c,Oi)=>{"use strict";function Sa(e){return e.reduce(Aa,{})}function Aa(e,t){return e[t]=!0,e}Oi.exports=Sa});var on=te((Ec,Di)=>{"use strict";var Oa=sn(),Da=["background","base","cite","href","longdesc","src","usemap"];Di.exports={uris:Oa(Da)}});var cn=te((Ac,Ii)=>{"use strict";var Ia=sn(),Ra=["area","br","col","hr","img","wbr","input","base","basefont","link","meta"];Ii.exports={voids:Ia(Ra)}});var Mi=te((Oc,Ri)=>{"use strict";var Ca=mr(),Ci=an(),Sc=on(),Ma=cn(),Pa=/^<\s*([\w:-]+)((?:\s+[\w:-]+(?:\s*=\s*(?:(?:"[^"]*")|(?:'[^']*')|[^>\s]+))?)*)\s*(\/?)\s*>/,ja=/^<\s*\/\s*([\w:-]+)[^>]*>/,La=/([\w:-]+)(?:\s*=\s*(?:(?:"((?:[^"])*)")|(?:'((?:[^'])*)')|([^>\s]+)))?/g,Ua=/^</,Va=/^<\s*\//;function qa(){var e=[];return e.lastItem=function(){return e[e.length-1]},e}function Ga(e,t){for(var r=qa(),n=e,i;e;)l();p();function l(){i=!0,a();var x=e===n;n=e,x&&(e="")}function a(){e.substr(0,4)==="<!--"?o():Va.test(e)?s(ja,p):Ua.test(e)&&s(Pa,m),c()}function s(x,d){var f=e.match(x);f&&(e=e.substring(f[0].length),f[0].replace(x,d),i=!1)}function o(){var x=e.indexOf("-->");x>=0&&(t.comment&&t.comment(e.substring(4,x)),e=e.substring(x+3),i=!1)}function c(){if(!!i){var x,d=e.indexOf("<");d>=0?(x=e.substring(0,d),e=e.substring(d)):(x=e,e=""),t.chars&&t.chars(x)}}function m(x,d,f,u){var h={},b=Ci(d),E=Ma.voids[b]||!!u;f.replace(La,A),E||r.push(b),t.start&&t.start(b,h,E);function A(v,g,w,_,N){w===void 0&&_===void 0&&N===void 0?h[g]=void 0:h[g]=Ca.decode(w||_||N||"")}}function p(x,d){var f,u=0,h=Ci(d);if(h)for(u=r.length-1;u>=0&&r[u]!==h;u--);if(u>=0){for(f=r.length-1;f>=u;f--)t.end&&t.end(r[f]);r.length=u}}}Ri.exports=Ga});var ji=te((Dc,Pi)=>{"use strict";var Fa=mr(),dn=an(),Ka=on(),Ba=cn();function Wa(e,t){var r,n,i=t||{};return x(),{start:a,end:s,chars:c};function l(d){e.push(d)}function a(d,f,u){var h=dn(d);if(n.ignoring){m(h);return}if((i.allowedTags||[]).indexOf(h)===-1){m(h);return}if(i.filter&&!i.filter({tag:h,attrs:f})){m(h);return}l("<"),l(h),Object.keys(f).forEach(b),l(u?"/>":">");function b(E){var A=f[E],v=(i.allowedClasses||{})[h]||[],g=(i.allowedAttributes||{})[h]||[],w,_=dn(E);_==="class"&&g.indexOf(_)===-1?(A=A.split(" ").filter(N).join(" ").trim(),w=A.length):w=g.indexOf(_)!==-1&&(Ka.uris[_]!==!0||o(A)),w&&(l(" "),l(E),typeof A=="string"&&(l('="'),l(Fa.encode(A)),l('"')));function N(I){return v&&v.indexOf(I)!==-1}}}function s(d){var f=dn(d),u=(i.allowedTags||[]).indexOf(f)!==-1;u&&n.ignoring===!1?(l("</"),l(f),l(">")):p(f)}function o(d){var f=d[0];if(f==="#"||f==="/")return!0;var u=d.indexOf(":");if(u===-1)return!0;var h=d.indexOf("?");if(h!==-1&&u>h)return!0;var b=d.indexOf("#");if(b!==-1&&u>b)return!0;return i.allowedSchemes.some(E);function E(A){return d.indexOf(A+":")===0}}function c(d){n.ignoring===!1&&l(i.transformText?i.transformText(d):d)}function m(d){Ba.voids[d]||(n.ignoring===!1?n={ignoring:d,depth:1}:n.ignoring===d&&n.depth++)}function p(d){n.ignoring===d&&--n.depth<=0&&x()}function x(){n={ignoring:!1,depth:0}}}Pi.exports=Wa});var Ui=te((Ic,Li)=>{"use strict";var Ha={allowedAttributes:{a:["href","name","target","title","aria-label"],iframe:["allowfullscreen","frameborder","src"],img:["src","alt","title","aria-label"]},allowedClasses:{},allowedSchemes:["http","https","mailto"],allowedTags:["a","abbr","article","b","blockquote","br","caption","code","del","details","div","em","h1","h2","h3","h4","h5","h6","hr","i","img","ins","kbd","li","main","mark","ol","p","pre","section","span","strike","strong","sub","summary","sup","table","tbody","td","th","thead","tr","u","ul"],filter:null};Li.exports=Ha});var Fi=te((Cc,Vi)=>{"use strict";var Rc=mr(),za=Ai(),Ya=Mi(),Ja=ji(),qi=Ui();function Gi(e,t,r){var n=[],i=r===!0?t:za({},qi,t),l=Ja(n,i);return Ya(e,l),n.join("")}Gi.defaults=qi;Vi.exports=Gi});var Ft,Pl=new Uint8Array(16);function vr(){if(!Ft&&(Ft=typeof crypto!="undefined"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||typeof msCrypto!="undefined"&&typeof msCrypto.getRandomValues=="function"&&msCrypto.getRandomValues.bind(msCrypto),!Ft))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return Ft(Pl)}var _n=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function jl(e){return typeof e=="string"&&_n.test(e)}var Nn=jl;var M=[];for(var _r=0;_r<256;++_r)M.push((_r+256).toString(16).substr(1));function Ll(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=(M[e[t+0]]+M[e[t+1]]+M[e[t+2]]+M[e[t+3]]+"-"+M[e[t+4]]+M[e[t+5]]+"-"+M[e[t+6]]+M[e[t+7]]+"-"+M[e[t+8]]+M[e[t+9]]+"-"+M[e[t+10]]+M[e[t+11]]+M[e[t+12]]+M[e[t+13]]+M[e[t+14]]+M[e[t+15]]).toLowerCase();if(!Nn(r))throw TypeError("Stringified UUID is invalid");return r}var kn=Ll;function Ul(e,t,r){e=e||{};var n=e.random||(e.rng||vr)();if(n[6]=n[6]&15|64,n[8]=n[8]&63|128,t){r=r||0;for(var i=0;i<16;++i)t[r+i]=n[i];return t}return kn(n)}var Nr=Ul;var O=10,D=11,P=12,L=13,V=14,U=15,R=16,ye=17,re=18,ne=19,ie=20,le=21,ae=22,se=23;var ge=24,we=25;var be=26,Se=27,J=28,oe=29,lt=30,ve=31,K="fmodel",Oe=()=>({t:lt}),Kt=()=>({t:ye}),$n=()=>({t:be}),En=()=>({t:ve}),An=()=>({t:re}),Sn=()=>({t:ie}),On=()=>({t:ae}),Dn=()=>({t:ne}),In=()=>({t:le}),Rn=()=>({t:se}),Cn=()=>({t:ge}),Mn=()=>({t:we}),Pn=()=>({t:Se}),X=e=>Object.assign({t:O,fields:[]},e),jn=e=>Object.assign({t:D,schs:[C(()=>De(null)),C(X)]},e),Ln=()=>({t:L,sch:C(Oe)}),Un=()=>({t:V,schs:[C(Oe)]}),Vn=()=>({t:U,schs:[C(Oe)]}),qn=()=>({t:R,fields:[{...C(X),key:"tag_a"}],tagname:"tag",allowedSchs:[X()],keyPrefix:"tag"}),Gn=()=>({t:P,schs:[C(Kt),C(Oe)]}),De=(e,t)=>Object.assign({t:J,$r:e},t),Bt=e=>{try{return e=JSON.parse(e),e==null||["string","number","boolean"].includes(typeof e)?{t:oe,v:e}:!1}catch(t){return!1}},C=(e,t={})=>{let r=e();return r.$a||(r.$a=Nr()),t.force&&(r.$a=Nr()),r},Ie=e=>Vl[e],Vl={[O]:"record",[D]:"e_record",[P]:"dict",[L]:"list",[V]:"tuple",[U]:"union",[R]:"tagged_union",[ye]:"string",[ve]:"integer",[re]:"int8",[ne]:"uint8",[ie]:"int16",[le]:"uint16",[ae]:"int32",[se]:"uint32",[ge]:"float32",[we]:"float64",[be]:"boolean",[Se]:"nil",[J]:"ref",[oe]:"value",[lt]:"any"},vt=e=>ql[e],ql={[re]:{min:-128,max:127},[ie]:{min:-32768,max:32767},[ae]:{min:-2147483648,max:2147483647},[ne]:{min:0,max:255},[le]:{min:0,max:65535},[se]:{min:0,max:4294967295}},Wt=(e,t)=>e.find(r=>{if(r.t==De(null).t)return r.to?Gl(r,t):!0}),Gl=(e,t)=>e.to.find(r=>{var i;let n=r.t==t.sch.t;if((i=t.sch).metadata||(i.metadata={}),r.metadata){let l=!0;for(let a of Object.keys(r.metadata))typeof r.metadata[a]=="boolean"&&(l=l&&r.metadata[a]==!!t.sch.metadata[a]);return n&&l}else return n});var at=e=>{var t;((t=e.target.dataset)==null?void 0:t.newline)=="false"&&(e.target.value=e.target.value.replace(/\n/g,"")),e.target.style.overflow="hidden",e.target.style.height="auto",e.target.style.height=`${e.target.scrollHeight}px`},Fn=e=>{at(e),e.target.setSelectionRange(e.target.value.length,e.target.value.length)},{defineProperty:Fl}=Object,Kn=Fl,k=(e,t,r)=>Kn(e,t,{value:r,configurable:!0}),Ht=(e,t,r)=>Kn(e,t,{value:r,configurable:!0,writable:!0}),kr=function(e,t,r){var n=null;return function(){n&&clearTimeout(n);var i=arguments;n=setTimeout(function(){n=null,e.apply(r,i)},t)}},zt=(e,t)=>{for(let r=0;r<e.length;r++)if(t(e[r]))return e[r]},_e=(e,t)=>{for(let r=0;r<e.length;r++)t(e[r],r)},st=(e,t,r)=>{for(let n=0;n<e.length;n++)t(r,e[n]);return r};var Yt=(e,t)=>{let r=JSON.parse(JSON.stringify(e));return j(r,(n,i)=>C(()=>n,{force:!0})),r},Bn=e=>JSON.parse(JSON.stringify(e)),$r=({t:e,$a:t,key:r},{path:n,lpath:i,level:l})=>({t:e,$a:t,key:r,level:l,path:n,lpath:i}),Er=(e,t)=>{let r=e.slice(0);return r.push(t),r},j=(e,t,r={path:"",lpath:[e],level:1,parent:{}})=>{if(delete e._halt,delete e._pruned,e=t(e,r),e._halt||e._pruned)return e;switch(!0){case e.hasOwnProperty("fields"):_e(e.fields,(l,a)=>{let s=l.key,o={path:`${r.path}[${s}]`,level:r.level+1,index:a,parent:$r(e,r),lpath:Er(r.lpath,l)};if(l=j(l,t,o),e.fields[a]=l,l._halt)return Object.assign(e,{_halt:!0})});break;case e.hasOwnProperty("schs"):_e(e.schs,(l,a)=>{let s={path:`${r.path}[][${a}]`,level:r.level+1,index:a,parent:$r(e,r),lpath:Er(r.lpath,l)};if(l=j(l,t,s),e.schs[a]=l,l._halt)return Object.assign(e,{_halt:!0})});break;case e.hasOwnProperty("sch"):let n=e.sch,i={path:`${r.path}[][0]`,level:r.level+1,index:0,parent:$r(e,r),lpath:Er(r.lpath,n)};if(n=j(e.sch,t,i),e.sch=n,n._halt)return Object.assign(e,{_halt:!0});break;default:}return e},Ar=(e,t,r)=>{let n={original:{},popped:[]};return j(e,(i,l)=>{if(typeof t=="function"&&!t.call(null,i,l))return i;if(typeof t!="function"&&l.path!=t)return i;{typeof t=="string"&&(i._halt=!0),typeof r=="function"&&(r=r.call(null,i,l));let a=r.sort((s,o)=>o-s);switch(!0){case i.hasOwnProperty("fields"):for(let s of a)n.popped.unshift({k:i.fields[s].key,sch:i.fields.splice(s,1)[0],index:s});break;case i.hasOwnProperty("sch"):break;case i.hasOwnProperty("schs"):for(let s of a)n.popped.unshift({k:s,sch:i.schs.splice(s,1)[0],index:s});i.schs.length==0&&i.schs.splice(0,0,C(Oe));break;default:}return i}}),n},Kl=e=>e.filter(t=>{for(let r of e){if(t==r)return!0;if(t.startsWith(r)&&r!="")return!1}}),ot=(e,t,r)=>{let n={original:{},inserted:[]},i=(l,a)=>(l=Math.max(l,0),l=Math.min(l,a),l);return j(e,(l,a)=>{var s;if(typeof t=="function"&&!t.call(null,l,a))return l;if(typeof t!="function"&&a.path!=t)return l;{typeof t=="string"&&(l._halt=!0),typeof r=="function"&&(r=r.call(null,l,a));let o=r.sort((c,m)=>c.index-m.index);switch(!0){case l.hasOwnProperty("fields"):let c=(s=e.taggedLevel)==null?void 0:s[a.level+1],m=[],{keys:p,anchors:x}=st(l.fields,(d,f)=>(Object.assign(d.keys,{[f.key]:!0}),Object.assign(d.anchors,{[f.$a]:!0}),d),{keys:{},anchors:{}});for(let{k:d,sch:f,index:u}of o){if(x[f().$a])continue;for(d=d==0?"0":d,d=d||`${c||l.keyPrefix||"key"}_${Math.floor(Date.now()/100)}`,d=`${d}`;p[d];)d=`${d} \u2013`;p[d]=!0,u=i(u,l.fields.length+m.length);let h=C(f);h.key=d,h.index=u,m.push(h),n.inserted.push({k:h.key,sch:h,index:u})}o.length!=0&&l.fields.splice(o[0].index,0,...m);break;case l.hasOwnProperty("sch"):break;case l.hasOwnProperty("schs"):for(let{k:d,sch:f,index:u}of o){u=i(u,l.schs.length);let h=C(f);h.index=u,l.schs.splice(u,0,h),n.inserted.push({k:d,sch:l.schs[u],index:u})}break;default:}return l}}),n},Xt=(e,{isRefConstraint:t,dstPath:r,dstLevel:n,dstStore:i,startIndex:l=0},a)=>{let s=(p,x,d)=>Ne(p,x,(f,u)=>(k(f,"_pinId",d),f)),o=Symbol(r);s(e,r,o);let c=Jt(e,a,{dstPath:r,dstLevel:n,dstStore:i,isRefConstraint:t});return Sr(e,{dstPin:o,startIndex:l},c)},Jt=(e,t,r={})=>{let n={},i=Kl(Object.keys(t));r.isRefConstraint==null&&(r.isRefConstraint=!0);let l=r.dstStore||e;for(let a of i){let s=t[a],o=f=>{var u;return(u=s.find(h=>h.index==f))==null?void 0:u.newK},c=f=>{var u;return((u=f.sch)==null?void 0:u.referrers)&&f.sch.referrers.length!=0&&r.isRefConstraint},m=r.dstLevel!=l.refParentLevel;if(r.dstPath&&zt(s,u=>r.dstPath.startsWith(u.id)))continue;let p=st(s,(f,u)=>(c(u)&&m?f.refed.push(u):f.indices.push(u.index),f),{indices:[],refed:[]});r.isRefConstraint&&_e(p.refed,f=>f.setAttribute("data-err","ref"));let d=Ar(e,a,p.indices).popped.map(({k:f,sch:u,index:h})=>({k:o(h)||f,sch:()=>u}));n[a]=d}return n},Sr=(e,{dstPin:t,dstPath:r,startIndex:n=0},i)=>{let l=(c,m)=>Re(c,(p,x)=>p._pinId==m,(p,x)=>(k(p,"_pinned",x),p));n=Math.max(n,0);let a={},s=Object.values(i).flatMap(c=>c).map((c,m)=>Object.assign(c,{index:n+m}));if(t){let c=l(e,t);c&&(r=c._pinned.path)}let o=ot(e,r,s);return o.inserted.length!=0&&(a[r]=o.inserted),a},Ir=(e,{dstPath:t,startIndex:r=0},n)=>{let i=Or(e,n,{dstPath:t,startIndex:r});return Dr(e,{dstPath:t},i)},Or=(e,t,r={})=>st(Object.values(t),(n,i)=>{let l=i.map(s=>s.id),a=[];Re(e,(s,o)=>(l.includes(o.path)&&(k(s,"_meta",o),a.unshift(s)),a.length==l.length),(s,o)=>s);for(let s of i){if(r.dstPath&&r.dstPath.startsWith(s.id))continue;let o=a.find(c=>c._meta.path==s.id);o&&n.unshift({k:s.key,sch:()=>Yt(o,e),index:r.startIndex+n.length,id:s.id})}return n},[]),Dr=(e,{dstPath:t},r)=>{let n={},i=ot(e,t,r);return i.inserted.length!=0&&(n[t]=i.inserted),n},Qt=(e,t,r)=>Ne(e,t,(n,i)=>{let l=C(r),{title:a,description:s,rw:o,required:c,$a:m,key:p}=n,x=l.t==J&&l.$r!=n.$r,d=l.t==oe&&l.v!=n.v,f=l.t!=n.t;return l.$r==m?n:f||d||x?Object.assign(l,{metadata:{title:a,description:s,rw:o,required:c},$a:m,key:p}):n}),H=(e,t)=>Re(e,(r,n)=>n.path==t,(r,n)=>(k(r,"_meta",n),r)),Ne=(e,t,r)=>Re(e,(n,i)=>i.path==t,r),Re=(e,t,r)=>{let n;return j(e,(i,l)=>t(i,l)?(n=r(i,l),n._halt=!0,n):i),n&&delete n._halt,n};var Rr={};vn(Rr,{clearClipboard:()=>Me,collapseSelected:()=>Pr,createWalker:()=>Wn,ensureNodeConnected:()=>er,expandSelected:()=>Mr,findUnselectedNode:()=>Nt,reselectNodes:()=>dt,selectMultiNode:()=>ze,selectMultiNodeTo:()=>_t,selectNode:()=>S,selectedGroupedByParent:()=>Ce,toggleSelectNode:()=>Yn});var z="aria-selected",Zt="aria-expanded",Wn=e=>(e._walker=e.ownerDocument.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:t=>{var r;if(t.hasAttribute(z)){let n=(r=t.parentElement.closest(`[${Zt}]`))==null?void 0:r.getAttribute(Zt);return n&&n=="false"?NodeFilter.FILTER_REJECT:NodeFilter.FILTER_ACCEPT}else return NodeFilter.FILTER_SKIP}},!1),e),S=(e,t,r={focus:!0})=>{t=er(e,t),!!t&&(e._walker.currentNode=t,Hn(e),ct(t),r.focus&&t.focus())},Yn=(e,t)=>{e&&(e.tabIndex=-1),zn(t)},ze=(e,t,r={focus:!0})=>{!t||(e&&(e.tabIndex=-1),t.getAttribute(z)=="true"?zn(e):ct(t),r.focus&&t.focus())},Hn=(e,t={})=>{t=Object.assign({sync:!0},t);for(let r of e.querySelectorAll(`[${z}='true']`))t.sync?tr(r):kr(tr,0)(r)},Cr=(e,t,r,n={})=>{var a,s,o;let i=e._walker.currentNode,l=t();if(!!l){if(i==r)return(a=n.target)==null?void 0:a.call(null,r);(s=n.pre)==null||s.call(null,i,l),Cr(e,t,r,n),(o=n.post)==null||o.call(null,i,l)}},_t=(e,t,r)=>{if(!(!t||!r))switch(t.compareDocumentPosition(r)){case Node.DOCUMENT_POSITION_FOLLOWING:e._walker.currentNode=t,Cr(e,()=>e._walker.nextSibling(),r,{pre:(n,i)=>{ze(n,i,{focus:!1})}}),e._walker.currentNode=r,ct(r),r.focus();break;case Node.DOCUMENT_POSITION_PRECEDING:e._walker.currentNode=t,ct(r.parentNode.closest(`[${z}]`)),Cr(e,()=>e._walker.previousSibling(),r,{pre:(n,i)=>{ze(n,i,{focus:!1})}}),tr(r.parentNode.closest(`[${z}]`)),e._walker.currentNode=r,ct(r),r.focus();break}},ct=e=>{!e||(e.setAttribute(z,!0),e.tabIndex=0)},tr=e=>{!e||(e.setAttribute(z,!1),e.tabIndex=-1)},zn=e=>(e==null?void 0:e.getAttribute(z))=="true"?tr(e):ct(e),Nt=(e,t)=>{do t=e();while((t==null?void 0:t.getAttribute(z))=="true");return t},Bl=e=>e.filter(t=>{for(let r of e){if(t==r)return!0;if(t.startsWith(r))return!1}}),dt=(e,t,r={})=>{Hn(e,r);for(let n of Bl(Object.keys(t))){let i=t[n];if(n==""?n=e.querySelector("[id][aria-level]"):n=e.querySelector(`[id='${CSS.escape(n)}'][aria-level]`),!n)continue;let l=parseInt(n.getAttribute("aria-level")),a=n.querySelectorAll(`[aria-level='${l+1}'][role='treeitem']`);for(let s=0;s<i.length;s++){let o=i[s].index,c=a[o];if(!c)return;r.direction&&c.classList.add(r.direction),ze(a[o-1],c,{focus:!1}),e._walker.currentNode=c}r=Object.assign({sync:!0},r),r.sync?e._walker.currentNode.focus():kr(()=>e._walker.currentNode.focus())()}},Ce=(e,t={})=>{let r=e.querySelectorAll(`${t.ops||`[${z}='true']`}`),n={};for(let i=0;i<r.length;i++){let l=r[i],a=l.parentNode.closest("[role='treeitem']");if(!a)break;l.index=l.index||parseInt(l.getAttribute("aria-posinset"))-1,n[a.id]=n[a.id]||[],n[a.id].push(l)}return n},Mr=e=>{let t=e.querySelectorAll(`[${z}='true']`);for(let r=0;r<t.length;r++)t[r].setAttribute(Zt,"true")},Pr=e=>{let t=e.querySelectorAll(`[${z}='true']`);for(let r=0;r<t.length;r++)t[r].setAttribute(Zt,"false")},Me=e=>{_e(e.querySelectorAll(".item-cutting, .item-copying, [data-err]"),t=>{t.classList.remove("item-cutting","item-copying"),t.removeAttribute("data-err")}),window._treeClipboard=null},er=(e,t)=>t&&!t.isConnected?t.id?e.querySelector(`[id='${CSS.escape(t.id)}']`):e.querySelector("[id]"):t;var Wl=({tree:e})=>{let t=e._walker.currentNode,r=e._walker.parentNode()&&e._walker.firstChild();_t(e,t,r)},Hl=({tree:e})=>{let t=e._walker.currentNode,r=e._walker.parentNode()&&e._walker.lastChild();_t(e,t,r)},zl=({tree:e})=>{let t=e._walker.currentNode,r=e._walker.previousSibling();ze(t,r)},Yl=({tree:e})=>{let t=e._walker.currentNode,r=e._walker.nextSibling();ze(t,r)},Jl=({tree:e})=>{let t=e._walker.parentNode()&&e._walker.firstChild();S(e,t)},Xl=({tree:e})=>{let t=e._walker.parentNode()&&e._walker.lastChild();S(e,t)},Ql=({tree:e})=>S(e,e._walker.previousSibling()),Zl=({tree:e})=>S(e,e._walker.nextSibling()),ea=({tree:e})=>S(e,e._walker.previousNode()),ta=({tree:e})=>S(e,e._walker.nextNode()),ra=({tree:e})=>{for(;e._walker.parentNode(););S(e,e._walker.nextNode()),S(e,e._walker.parentNode())},na=({tree:e})=>{for(;e._walker.nextNode(););S(e,e._walker.currentNode)},kt=({tree:e},t={})=>S(e,e._walker.currentNode,{focus:t.notFocusIfTextArea}),$t=({tree:e,store:t},r)=>Jn(e,t,r),rr={selectMultiNodeUpTo:Wl,selectMultiNodeDownTo:Hl,selectMultiNodeUp:zl,selectMultiNodeDown:Yl,selectUpEnd:Jl,selectDownEnd:Xl,selectUp:ea,selectDown:ta,selectPrevious:Ql,selectNext:Zl,selectRoot:ra,selectLast:na},ce=({tree:e,store:t})=>{var a,s;let r=e._walker.currentNode,n=H(t,r.id),i,l=((a=jr(e,t))==null?void 0:a[0])||n._addSchDefault||n.allowedSchs&&n.allowedSchs[0]||t.allowedSchs&&t.allowedSchs[0];!l||(((s=t.put)==null?void 0:s.pos)=="prepend"?i=0:i=Number.MAX_SAFE_INTEGER,ot(t,r.id,[{k:null,sch:()=>Yt(l),index:i}]),e._render(t),S(e,r))},ut=({tree:e,store:t})=>{var i,l;let r=e._walker.currentNode;if(((l=(i=r.closest("[role='group']"))==null?void 0:i.dataset)==null?void 0:l.group)=="keyed"){let a=r.querySelector(".k").getBoundingClientRect();Xn({tree:e,store:t,editMode:"editKey",textRect:a})}},ft=({tree:e,store:t})=>{let r=e._walker.currentNode.querySelector(".t").getBoundingClientRect(),n=jr(e,t)||t.allowedSchs;Xn({tree:e,store:t,editMode:"editType",textRect:r,opts:{allowedTs:n}})},Xn=({tree:e,store:t,editMode:r,textRect:n,opts:i={}})=>{let l=e._walker.currentNode,a=Ne(t,l.id,(c,m)=>k(c,"uiMode",r));e._render(t);let s=e.querySelector("textarea");if(!s)return;let o=window.getComputedStyle(s);s.style.minWidth=n.width+"px",s.style.minHeight=n.height+"px",s._treeItem=l,s.opts=i,s.onblur=c=>c.relatedTarget&&c.relatedTarget.id!=s._treeItem.id&&Jn(e,t,s),s.focus()},Jn=(e,t,r)=>{let n=Ne(t,r._treeItem.id,(i,l)=>k(i,"uiMode","cancelled-edit"));e._render(t),n&&(e._walker.currentNode=e.querySelector(`[id='${CSS.escape(r._treeItem.id)}']`),S(e,e._walker.currentNode))},ke=({tree:e,store:t},r)=>{r.id=="key-edit"?Qn(e,t,r,la):r.id=="type-edit"&&Qn(e,t,r,ia)},Qn=(e,t,r,n)=>{let i=e._walker.currentNode;r._treeItem=r.closest("[role='treeitem']"),S(e,r._treeItem,{focus:!1});let l=n(e,t,r)||i.id;Ne(t,l,(a,s)=>k(a,"uiMode","editted")),e._render(t),e._walker.currentNode=e.querySelector(`[id='${CSS.escape(l)}']`),S(e,e._walker.currentNode)},ia=(e,t,r)=>{let n=jr(e,t)||t.allowedSchs,i=n.find(s=>Ie(s.t)==r.value),l=t._models[r.value]&&r.value||Object.keys(t._models).find(s=>{let o=t._models[s];return t._models[s].display==r.value?Wt(n,o):!1}),a=Bt(r.value);return i?Qt(t,r._treeItem.id,()=>Yt(i)):l?Qt(t,r._treeItem.id,()=>De(l)):a&&Qt(t,r._treeItem.id,()=>a),e._walker.currentNode.id},la=(e,t,r)=>{let n=Ce(e),i=r.dataset.parentPath;n[r.dataset.parentPath]=n[r.dataset.parentPath].filter(c=>c.id==r._treeItem.id).map(c=>Object.assign(c,{newK:r.value}));let l=n[r.dataset.parentPath][0].index,s=Xt(t,{dstPath:i,startIndex:l,isRefConstraint:!1},n)[i][0].k;return`${r._treeItem.parentNode.closest("[role='treeitem']").id}[${s}]`},Y=({tree:e,store:t})=>{let r=e._walker.currentNode,n=Nt(()=>e._walker.nextSibling())||Nt(()=>e._walker.previousSibling())||Nt(()=>e._walker.parentNode());Jt(t,Ce(e)),e._render(t),r.getAttribute("data-err")=="ref"?e._walker.currentNode=r:S(e,n)},Et=({tree:e,store:t})=>{var n;let r=e._walker.currentNode;!r||((n=t.entryable)==null?void 0:n.includes(r.dataset.tag))&&(Ne(t,r.id,(i,l)=>Object.assign(i,{isEntry:!0})),e._render(t),S(e,r))};var Ye=({store:e,tree:t})=>{Me(t);for(let n of t.querySelectorAll("[aria-selected='true']"))n.classList.add("item-cutting");let r=Ce(t,{ops:".item-cutting"});window._treeClipboard={type:"cut",srcStore:e,ops:({dstPath:n,dstLevel:i,dstStore:l})=>Jt(e,r,{dstPath:n,dstLevel:i,dstStore:l}),selected:r}},Je=({store:e,tree:t})=>{if(document.getSelection().toString().length!=0)return;Me(t);for(let n of t.querySelectorAll("[aria-selected='true']"))n.classList.add("item-copying");let r=Ce(t,{ops:".item-copying"});window._treeClipboard={type:"copy",srcStore:e,ops:({dstPath:n})=>Or(e,r,{dstPath:n,startIndex:0}),selected:r}},de=({tree:e,store:t,srcStore:r})=>{var i;let n=H(t,e._walker.currentNode.id);if(!!(n.hasOwnProperty("fields")||n.hasOwnProperty("schs")||n.hasOwnProperty("sch"))&&!(((i=t.put)==null?void 0:i.onlyDst)&&!t.put.onlyDst[t.taggedLevel[n._meta.level]])&&window._treeClipboard){let l=e._walker.currentNode.id,{type:a,srcStore:s,ops:o,selected:c}=window._treeClipboard,m=c,p={};if(t.key==s.key)switch(a){case"copy":p=Ir(t,{dstPath:l},m);break;case"cut":p=Xt(t,{dstPath:l,dstLevel:n._meta.level,dstStore:t},m);break}else switch(a){case"copy":let d=o({dstPath:""});p=Dr(t,{dstPath:l},d);break;case"cut":let f=o({dstPath:"",dstLevel:n._meta.level,dstStore:t});p=Sr(t,{dstPath:l},f);break}let x=(d,f)=>{let u={};for(let h of Object.keys(f))h==n._meta.path?u[""]=f[h]:u[h]=f[h];d._render(n),Me(d),dt(d,u)};Object.keys(p).length!=0&&(n._tree?x(n._tree,p):(e._render(t),Me(e),dt(e,p)))}},$e=({tree:e,store:t})=>Zn({tree:e,store:t,direction:""},r=>r[0].index),Ee=({tree:e,store:t})=>Zn({tree:e,store:t,direction:""},r=>r[r.length-1].index+1),Zn=({tree:e,store:t,direction:r},n)=>{let i=Ce(e),l={};for(let a of Object.keys(i))l=Ir(t,{dstPath:a,startIndex:n(i[a])},{[a]:i[a]});Object.keys(l).length!=0&&(e._render(t),dt(e,l,{direction:r,sync:!!e.sync}))},ue=({tree:e,store:t})=>ei({tree:e,store:t,startIndex:r=>r-1,direction:""}),fe=({tree:e,store:t})=>ei({tree:e,store:t,startIndex:r=>r+1,direction:""}),ei=({tree:e,store:t,startIndex:r,direction:n})=>{let i=Ce(e),l={};for(let a of Object.keys(i)){let s=i[a].sort((o,c)=>o.index-c.index);l=Xt(t,{dstPath:a,startIndex:r(s[0].index),isRefConstraint:!1},i)}Object.keys(l).length!=0&&(e._render(t),dt(e,l))},jr=(e,t)=>{var s,o,c;let r=e._walker.currentNode.parentNode.closest("[role='treeitem']");if(!r)return;let n=H(t,r.id),i=e._walker.currentNode,l=H(t,i.id),a=(m,p)=>{if(!m)return!1;let x=!0;for(let d of p)x=x&&m[d[0]]==d[1];return x};for(let m of t.rulesTable||[])if(a(n,m.selector)){if((o=(s=m.rules)==null?void 0:s.nthChild)==null?void 0:o[l._meta.index])return m.rules.nthChild[l._meta.index].allowedSchs;if((c=m.rules.children)==null?void 0:c.allowedSchs)return m.rules.children.allowedSchs}return null},At=({tree:e})=>Mr(e),St=({tree:e})=>Pr(e);var{defineProperties:aa}=Object,nr=({store:e,target:t,view:r,treeKeyDownCmds:n,textAreaKeyDownCmd:i,opts:l={}})=>{aa(e,{render:{value:function(s){r(s||this)},configurable:!0},currentNode:{writable:!0,configurable:!0},_tree:{writable:!0,configurable:!0}}),e.render();let a=document.querySelector(`${t} [role='tree']`);if(a){a._aria=Rr,a._render=r,e._tree=a,Wn(a),a.onkeydown=sa(e,n,{textAreaKeyDownCmd:i}),a.onclick=oa(e);let s=a.querySelector(`[id='${CSS.escape(l.selectId)}']`);if(l.selectId!==!1)if(s&&l.selectId!="")a._walker.currentNode=s,S(a,a._walker.currentNode,{focus:l.focus});else{e.currentNode=er(a,e.currentNode);let o=a._walker.nextNode(),c=e.currentNode||a._walker.nextNode()||o;S(a,c,{focus:l.focus})}return l.focus&&a._walker.currentNode.scrollIntoView({block:"center"}),a}},sa=(e,t,r)=>function(n){ca(n,this,e,t,r)};async function ca(e,t,r,n=[],i={}){if(e.stopPropagation(),e.target instanceof HTMLTextAreaElement)return ua(e,t,r,i.textAreaKeyDownCmd);switch(e.code){case"ArrowUp":e.preventDefault();break;case"ArrowDown":e.preventDefault();break}let a=new Map(n).get(ti(e));!a||(i.denyCmds||[]).includes(a.name)||da(t,r,a)||(a({tree:t,store:r}),t._walker.currentNode=er(t,t._walker.currentNode),S(t._walker.currentNode),r.currentNode=t._walker.currentNode,Lr(t,t._walker.currentNode,a))}var da=(e,t,r)=>{var o,c,m,p,x,d,f;let n=e._walker.currentNode.parentNode.closest("[role='treeitem']");if(!n)return;let i=H(t,n.id),l=e._walker.currentNode,a=H(t,l.id),s=(u,h)=>{if(!u)return!1;let b=!0;for(let E of h)b=b&&u[E[0]]==E[1];return b};for(let u of t.rulesTable||[])if(s(i,u.selector)&&(((m=(c=(o=u.rules)==null?void 0:o.nthChild)==null?void 0:c[a._meta.index])==null?void 0:m.exceptActions)&&u.rules.nthChild[a._meta.index].exceptActions.map(h=>h.name).includes(r.name)||((p=u.rules.children)==null?void 0:p.onlyActions)&&!u.rules.children.onlyActions.map(h=>h.name).includes(r.name)||((x=u.rules.children)==null?void 0:x.exceptActions)&&u.rules.children.exceptActions.map(h=>h.name).includes(r.name))||s(a,u.selector)&&(((d=u.rules.self)==null?void 0:d.onlyActions)&&!u.rules.self.onlyActions.map(h=>h.name).includes(r.name)||((f=u.rules.self)==null?void 0:f.exceptActions)&&u.rules.self.exceptActions.map(h=>h.name).includes(r.name)))return!0;return!1},ua=(e,t,r,n=[])=>{e.stopPropagation();let i=e.target,a=new Map(n).get(ti(e));!a||(a({tree:t,store:r},i),r.currentNode=t._walker.currentNode,Lr(t,t._walker.currentNode,a))},oa=e=>function(t){return fa(t,this,e)};function fa(e,t,r){e.stopPropagation();let n=t._walker.currentNode,i=e.target.closest("[role='treeitem']"),l=!t.querySelector("textarea");if(!!i){if(e.shiftKey||e.metaKey)switch(n.compareDocumentPosition(i)){case Node.DOCUMENT_POSITION_CONTAINS:return S(t,i);case Node.DOCUMENT_POSITION_CONTAINED_BY:return S(t,n);default:if(i.parentNode.closest("[role='treeitem']")!=n.parentNode.closest("[role='treeitem']"))return S(t,i)}e.shiftKey?(n!=i&&document.getSelection().removeAllRanges(),_t(t,n,i)):e.metaKey?Yn(n,t._walker.currentNode=i):(t._walker.currentNode=i,kt({tree:t},{notFocusIfTextArea:l}),r.currentNode=t._walker.currentNode,Lr(t,i,kt))}}var ti=({shiftKey:e,metaKey:t,altKey:r,ctrlKey:n,key:i})=>{let l=[];return e&&l.push("shift"),(t||n)&&l.push("meta"),r&&l.push("alt"),i&&l.push(i),l.join("-")},Lr=(e,t,r)=>e.dispatchEvent(new CustomEvent("tree-command",{bubbles:!0,detail:{target:t,command:r}}));var ri=new WeakMap,Ot=e=>(...t)=>{let r=e(...t);return ri.set(r,!0),r},Xe=e=>typeof e=="function"&&ri.has(e);var Ur=typeof window!="undefined"&&window.customElements!=null&&window.customElements.polyfillWrapFlushCallback!==void 0,ir=(e,t,r=null,n=null)=>{for(;t!==r;){let i=t.nextSibling;e.insertBefore(t,n),t=i}},Qe=(e,t,r=null)=>{for(;t!==r;){let n=t.nextSibling;e.removeChild(t),t=n}};var B={},pe={};var me=`{{lit-${String(Math.random()).slice(2)}}}`,Vr=`<!--${me}-->`,ni=new RegExp(`${me}|${Vr}`),pt="$lit$",lr=class{constructor(t,r){this.parts=[],this.element=r;let n=[],i=[],l=document.createTreeWalker(r.content,133,null,!1),a=0,s=-1,o=0,{strings:c,values:{length:m}}=t;for(;o<m;){let p=l.nextNode();if(p===null){l.currentNode=i.pop();continue}if(s++,p.nodeType===1){if(p.hasAttributes()){let x=p.attributes,{length:d}=x,f=0;for(let u=0;u<d;u++)ii(x[u].name,pt)&&f++;for(;f-- >0;){let u=c[o],h=ar.exec(u)[2],b=h.toLowerCase()+pt,E=p.getAttribute(b);p.removeAttribute(b);let A=E.split(ni);this.parts.push({type:"attribute",index:s,name:h,strings:A}),o+=A.length-1}}p.tagName==="TEMPLATE"&&(i.push(p),l.currentNode=p.content)}else if(p.nodeType===3){let x=p.data;if(x.indexOf(me)>=0){let d=p.parentNode,f=x.split(ni),u=f.length-1;for(let h=0;h<u;h++){let b,E=f[h];if(E==="")b=W();else{let A=ar.exec(E);A!==null&&ii(A[2],pt)&&(E=E.slice(0,A.index)+A[1]+A[2].slice(0,-pt.length)+A[3]),b=document.createTextNode(E)}d.insertBefore(b,p),this.parts.push({type:"node",index:++s})}f[u]===""?(d.insertBefore(W(),p),n.push(p)):p.data=f[u],o+=u}}else if(p.nodeType===8)if(p.data===me){let x=p.parentNode;(p.previousSibling===null||s===a)&&(s++,x.insertBefore(W(),p)),a=s,this.parts.push({type:"node",index:s}),p.nextSibling===null?p.data="":(n.push(p),s--),o++}else{let x=-1;for(;(x=p.data.indexOf(me,x+1))!==-1;)this.parts.push({type:"node",index:-1}),o++}}for(let p of n)p.parentNode.removeChild(p)}},ii=(e,t)=>{let r=e.length-t.length;return r>=0&&e.slice(r)===t},qr=e=>e.index!==-1,W=()=>document.createComment(""),ar=/([ \x09\x0a\x0c\x0d])([^\0-\x1F\x7F-\x9F "'>=/]+)([ \x09\x0a\x0c\x0d]*=[ \x09\x0a\x0c\x0d]*(?:[^ \x09\x0a\x0c\x0d"'`<>=]*|"[^"]*|'[^']*))$/;var Dt=class{constructor(t,r,n){this.__parts=[],this.template=t,this.processor=r,this.options=n}update(t){let r=0;for(let n of this.__parts)n!==void 0&&n.setValue(t[r]),r++;for(let n of this.__parts)n!==void 0&&n.commit()}_clone(){let t=Ur?this.template.element.content.cloneNode(!0):document.importNode(this.template.element.content,!0),r=[],n=this.template.parts,i=document.createTreeWalker(t,133,null,!1),l=0,a=0,s,o=i.nextNode();for(;l<n.length;){if(s=n[l],!qr(s)){this.__parts.push(void 0),l++;continue}for(;a<s.index;)a++,o.nodeName==="TEMPLATE"&&(r.push(o),i.currentNode=o.content),(o=i.nextNode())===null&&(i.currentNode=r.pop(),o=i.nextNode());if(s.type==="node"){let c=this.processor.handleTextExpression(this.options);c.insertAfterNode(o.previousSibling),this.__parts.push(c)}else this.__parts.push(...this.processor.handleAttributeExpressions(o,s.name,s.strings,this.options));l++}return Ur&&(document.adoptNode(t),customElements.upgrade(t)),t}};var li=window.trustedTypes&&trustedTypes.createPolicy("lit-html",{createHTML:e=>e}),pa=` ${me} `,mt=class{constructor(t,r,n,i){this.strings=t,this.values=r,this.type=n,this.processor=i}getHTML(){let t=this.strings.length-1,r="",n=!1;for(let i=0;i<t;i++){let l=this.strings[i],a=l.lastIndexOf("<!--");n=(a>-1||n)&&l.indexOf("-->",a+1)===-1;let s=ar.exec(l);s===null?r+=l+(n?pa:Vr):r+=l.substr(0,s.index)+s[1]+s[2]+pt+s[3]+me}return r+=this.strings[t],r}getTemplateElement(){let t=document.createElement("template"),r=this.getHTML();return li!==void 0&&(r=li.createHTML(r)),t.innerHTML=r,t}};var sr=e=>e===null||!(typeof e=="object"||typeof e=="function"),or=e=>Array.isArray(e)||!!(e&&e[Symbol.iterator]),It=class{constructor(t,r,n){this.dirty=!0,this.element=t,this.name=r,this.strings=n,this.parts=[];for(let i=0;i<n.length-1;i++)this.parts[i]=this._createPart()}_createPart(){return new ht(this)}_getValue(){let t=this.strings,r=t.length-1,n=this.parts;if(r===1&&t[0]===""&&t[1]===""){let l=n[0].value;if(typeof l=="symbol")return String(l);if(typeof l=="string"||!or(l))return l}let i="";for(let l=0;l<r;l++){i+=t[l];let a=n[l];if(a!==void 0){let s=a.value;if(sr(s)||!or(s))i+=typeof s=="string"?s:String(s);else for(let o of s)i+=typeof o=="string"?o:String(o)}}return i+=t[r],i}commit(){this.dirty&&(this.dirty=!1,this.element.setAttribute(this.name,this._getValue()))}},ht=class{constructor(t){this.value=void 0,this.committer=t}setValue(t){t!==B&&(!sr(t)||t!==this.value)&&(this.value=t,Xe(t)||(this.committer.dirty=!0))}commit(){for(;Xe(this.value);){let t=this.value;this.value=B,t(this)}this.value!==B&&this.committer.commit()}},Q=class{constructor(t){this.value=void 0,this.__pendingValue=void 0,this.options=t}appendInto(t){this.startNode=t.appendChild(W()),this.endNode=t.appendChild(W())}insertAfterNode(t){this.startNode=t,this.endNode=t.nextSibling}appendIntoPart(t){t.__insert(this.startNode=W()),t.__insert(this.endNode=W())}insertAfterPart(t){t.__insert(this.startNode=W()),this.endNode=t.endNode,t.endNode=this.startNode}setValue(t){this.__pendingValue=t}commit(){if(this.startNode.parentNode===null)return;for(;Xe(this.__pendingValue);){let r=this.__pendingValue;this.__pendingValue=B,r(this)}let t=this.__pendingValue;t!==B&&(sr(t)?t!==this.value&&this.__commitText(t):t instanceof mt?this.__commitTemplateResult(t):t instanceof Node?this.__commitNode(t):or(t)?this.__commitIterable(t):t===pe?(this.value=pe,this.clear()):this.__commitText(t))}__insert(t){this.endNode.parentNode.insertBefore(t,this.endNode)}__commitNode(t){this.value!==t&&(this.clear(),this.__insert(t),this.value=t)}__commitText(t){let r=this.startNode.nextSibling;t=t==null?"":t;let n=typeof t=="string"?t:String(t);r===this.endNode.previousSibling&&r.nodeType===3?r.data=n:this.__commitNode(document.createTextNode(n)),this.value=t}__commitTemplateResult(t){let r=this.options.templateFactory(t);if(this.value instanceof Dt&&this.value.template===r)this.value.update(t.values);else{let n=new Dt(r,t.processor,this.options),i=n._clone();n.update(t.values),this.__commitNode(i),this.value=n}}__commitIterable(t){Array.isArray(this.value)||(this.value=[],this.clear());let r=this.value,n=0,i;for(let l of t)i=r[n],i===void 0&&(i=new Q(this.options),r.push(i),n===0?i.appendIntoPart(this):i.insertAfterPart(r[n-1])),i.setValue(l),i.commit(),n++;n<r.length&&(r.length=n,this.clear(i&&i.endNode))}clear(t=this.startNode){Qe(this.startNode.parentNode,t.nextSibling,this.endNode)}},cr=class{constructor(t,r,n){if(this.value=void 0,this.__pendingValue=void 0,n.length!==2||n[0]!==""||n[1]!=="")throw new Error("Boolean attributes can only contain a single expression");this.element=t,this.name=r,this.strings=n}setValue(t){this.__pendingValue=t}commit(){for(;Xe(this.__pendingValue);){let r=this.__pendingValue;this.__pendingValue=B,r(this)}if(this.__pendingValue===B)return;let t=!!this.__pendingValue;this.value!==t&&(t?this.element.setAttribute(this.name,""):this.element.removeAttribute(this.name),this.value=t),this.__pendingValue=B}},dr=class extends It{constructor(t,r,n){super(t,r,n);this.single=n.length===2&&n[0]===""&&n[1]===""}_createPart(){return new Gr(this)}_getValue(){return this.single?this.parts[0].value:super._getValue()}commit(){this.dirty&&(this.dirty=!1,this.element[this.name]=this._getValue())}},Gr=class extends ht{},ai=!1;(()=>{try{let e={get capture(){return ai=!0,!1}};window.addEventListener("test",e,e),window.removeEventListener("test",e,e)}catch(e){}})();var ur=class{constructor(t,r,n){this.value=void 0,this.__pendingValue=void 0,this.element=t,this.eventName=r,this.eventContext=n,this.__boundHandleEvent=i=>this.handleEvent(i)}setValue(t){this.__pendingValue=t}commit(){for(;Xe(this.__pendingValue);){let l=this.__pendingValue;this.__pendingValue=B,l(this)}if(this.__pendingValue===B)return;let t=this.__pendingValue,r=this.value,n=t==null||r!=null&&(t.capture!==r.capture||t.once!==r.once||t.passive!==r.passive),i=t!=null&&(r==null||n);n&&this.element.removeEventListener(this.eventName,this.__boundHandleEvent,this.__options),i&&(this.__options=ma(t),this.element.addEventListener(this.eventName,this.__boundHandleEvent,this.__options)),this.value=t,this.__pendingValue=B}handleEvent(t){typeof this.value=="function"?this.value.call(this.eventContext||this.element,t):this.value.handleEvent(t)}},ma=e=>e&&(ai?{capture:e.capture,passive:e.passive,once:e.once}:e.capture);var Fr=class{handleAttributeExpressions(t,r,n,i){let l=r[0];return l==="."?new dr(t,r.slice(1),n).parts:l==="@"?[new ur(t,r.slice(1),i.eventContext)]:l==="?"?[new cr(t,r.slice(1),n)]:new It(t,r,n).parts}handleTextExpression(t){return new Q(t)}},Kr=new Fr;function Wr(e){let t=Br.get(e.type);t===void 0&&(t={stringsArray:new WeakMap,keyString:new Map},Br.set(e.type,t));let r=t.stringsArray.get(e.strings);if(r!==void 0)return r;let n=e.strings.join(me);return r=t.keyString.get(n),r===void 0&&(r=new lr(e,e.getTemplateElement()),t.keyString.set(n,r)),t.stringsArray.set(e.strings,r),r}var Br=new Map;var Hr=new WeakMap,Pe=(e,t,r)=>{let n=Hr.get(t);n===void 0&&(Qe(t,t.firstChild),Hr.set(t,n=new Q(Object.assign({templateFactory:Wr},r))),n.appendInto(t)),n.setValue(e),n.commit()};typeof window!="undefined"&&(window.litHtmlVersions||(window.litHtmlVersions=[])).push("1.4.1");var y=(e,...t)=>new mt(e,t,"html",Kr);var si=(e,t)=>{let r=e.startNode.parentNode,n=t===void 0?e.endNode:t.startNode,i=r.insertBefore(W(),n);r.insertBefore(W(),n);let l=new Q(e.options);return l.insertAfterNode(i),l},Ze=(e,t)=>(e.setValue(t),e.commit(),e),zr=(e,t,r)=>{let n=e.startNode.parentNode,i=r?r.startNode:e.endNode,l=t.endNode.nextSibling;l!==i&&ir(n,t.startNode,l,i)},Yr=e=>{Qe(e.startNode.parentNode,e.startNode,e.endNode.nextSibling)},oi=(e,t,r)=>{let n=new Map;for(let i=t;i<=r;i++)n.set(e[i],i);return n},ci=new WeakMap,di=new WeakMap,Z=Ot((e,t,r)=>{let n;return r===void 0?r=t:t!==void 0&&(n=t),i=>{if(!(i instanceof Q))throw new Error("repeat can only be used in text bindings");let l=ci.get(i)||[],a=di.get(i)||[],s=[],o=[],c=[],m=0;for(let b of e)c[m]=n?n(b,m):m,o[m]=r(b,m),m++;let p,x,d=0,f=l.length-1,u=0,h=o.length-1;for(;d<=f&&u<=h;)if(l[d]===null)d++;else if(l[f]===null)f--;else if(a[d]===c[u])s[u]=Ze(l[d],o[u]),d++,u++;else if(a[f]===c[h])s[h]=Ze(l[f],o[h]),f--,h--;else if(a[d]===c[h])s[h]=Ze(l[d],o[h]),zr(i,l[d],s[h+1]),d++,h--;else if(a[f]===c[u])s[u]=Ze(l[f],o[u]),zr(i,l[f],l[d]),f--,u++;else if(p===void 0&&(p=oi(c,u,h),x=oi(a,d,f)),!p.has(a[d]))Yr(l[d]),d++;else if(!p.has(a[f]))Yr(l[f]),f--;else{let b=x.get(c[u]),E=b!==void 0?l[b]:null;if(E===null){let A=si(i,l[d]);Ze(A,o[u]),s[u]=A}else s[u]=Ze(E,o[u]),zr(i,E,l[d]),l[b]=null;u++}for(;u<=h;){let b=si(i,s[h+1]);Ze(b,o[u]),s[u++]=b}for(;d<=f;){let b=l[d++];b!==null&&Yr(b)}ci.set(i,s),di.set(i,c)}});var Jr=new WeakMap,q=Ot(e=>t=>{let r=Jr.get(t);if(e===void 0&&t instanceof ht){if(r!==void 0||!Jr.has(t)){let n=t.committer.name;t.committer.element.removeAttribute(n)}}else e!==r&&t.setValue(e);Jr.set(t,e)});var fr={};vn(fr,{ENTRY_MARKED:()=>yt,MOVED:()=>he,NEW:()=>Le,NEW_KEY:()=>qe,NEW_ORDER:()=>Ve,NEW_TYPE:()=>Te,REMOVED:()=>Ue,buildBaseIndices:()=>Xr,diff:()=>ga,mergeToBase:()=>wa,mergeToCurrent:()=>ba});var ee="file",Tt="project",ui=(e,t)=>(Object.assign(t,e),t.fields=[],C(()=>t)),fi=(e,t)=>j(e,(r,n)=>(t[r.$a]&&(r.metadata=t[r.$a]),r)),pi=(e,t)=>{Xr(e);let r=e._indices;for(let n of e.fields)for(let i of n.fields)if(t[i.$a]){let l=st(t[i.$a],(a,s)=>(r[s]&&a.push(r[s]),a),[]);l.length!=0?k(i,"referrers",l):delete i.referrers}else delete i.referrers},xt=(e,t,r)=>(t||(t=mi()),Object.assign(t,e),C(()=>t)),Ti=()=>hi({taggedLevel:{1:Tt,2:ee,3:K},refParentLevel:2,allowedSchs:[mi],put:{pos:"prepend",onlyDst:{[ee]:!0}}}),mi=()=>hi({taggedLevel:{1:ee,2:K},refParentLevel:1,addDefault:X,entryable:[K],put:{pos:"prepend"},rulesTable:Qr}),hi=(e={})=>{let t=C(X);return t.allowedSchs=(e.allowedSchs||Zr).map(r=>r()),t.taggedLevel=e.taggedLevel,e.put&&(t.put=e.put),e.entryable&&(t.entryable=e.entryable),e.addDefault&&(t._addSchDefault=t.allowedSchs.find(r=>r.t==e.addDefault().t)&&e.addDefault()),e.rulesTable&&(t.rulesTable=e.rulesTable),e.refParentLevel&&(t.refParentLevel=e.refParentLevel),t},Rt=(e,t)=>H(e,`[${t}]`)||e._currentFileStore,je=e=>{let t={};return en(e,(r,n)=>{t[r.$a]={display:[n.file.key,r.key].join(" :: "),file:n.file.key,fmodel:r.key,sch:r}}),t},en=(e,t)=>{for(let r of e.fields)for(let n=0;n<r.fields.length;n++)r.fields[n]=t(r.fields[n],{path:`[${r.key}][${r.fields[n].key}]`,file:r})||r.fields[n]},Zr=[Kt,X,Ln,Un,Vn,Oe,$n,Pn,()=>Bt('"json string"'),En,An,Sn,On,Dn,In,Rn,Cn,Mn,qn,Gn,jn,()=>De(null)],Ta={selector:[["t",P]],rules:{self:{exceptActions:[ce,de]},children:{exceptActions:[Ye,Je,$e,Ee,Y,ue,fe]},nthChild:[{allowedSchs:[Kt()]}]}},xa={selector:[["t",D]],rules:{self:{exceptActions:[ce,de]},children:{exceptActions:[Ye,Je,$e,Ee,Y,ue,fe]},nthChild:[{allowedSchs:[De(null,{to:[X({metadata:{strict:!1}})]})]},{allowedSchs:[X()],exceptActions:[ft,ke]}]}},ya={selector:[["t",R]],rules:{children:{min:1,allowedSchs:[X(),De(null,{to:[X()]})]}}},Qr=[Ta,ya,xa];var Le="new",Ue="removed",he="moved",Ve="order_changed",qe="key_changed",Te="type_changed",yt="entry_changed",Xr=e=>{let t={};return j(e,(r,n)=>(k(r,"_meta",n),Object.assign(t,{[r.$a]:r}),delete r._visit,delete r._pruned,r)),k(e,"_indices",t),e},ga=(e,t,r={})=>{let n=[],i=t._indices;j(e,(a,s)=>{delete a._diff;let o={},c=i[a.$a];if(c){let m=s.parent,p=c._meta.parent;p.$a!=m.$a&&Object.assign(o,{[he]:{oldParent:p,newParent:m,oldPath:c._meta.path,newPath:s.path}}),c._meta.index!=s.index&&p.$a==m.$a&&Object.assign(o,{[Ve]:{oldOrder:c.index,newOrder:a.index}}),c.t!=a.t&&Object.assign(o,{[Te]:{oldType:c.t,newType:a.t,parent:m}}),c.$r!=a.$r&&Object.assign(o,{[Te]:{oldType:c.$r,newType:a.$r,parent:m}}),c.v!=a.v&&Object.assign(o,{[Te]:{oldType:c.v,newType:a.v,parent:m}}),c.key!=a.key&&Object.assign(o,{[qe]:{oldKey:c.key,newKey:a.key,parent:m}}),c.isEntry!=a.isEntry&&Object.assign(o,{[yt]:{oldIsEntry:c.isEntry,newIsEntry:a.isEntry,parent:m}}),Object.keys(o).length!=0&&(k(a,"_diff",Object.assign(o,{meta:tn(s)})),n.push(a)),k(c,"_visit",!0)}else k(a,"_diff",{[Le]:{parent:s.parent},meta:tn(s)}),n.push(a);return a});let l=[];return j(t,(a,s)=>(a._visit||(k(a,"_diff",{[Ue]:{parent:s.parent},meta:tn(s)}),l.push(a),k(a,"_pruned",!0)),delete a._visit,a)),n=n.concat(l),n},tn=({level:e,path:t,lpath:r,parent:n})=>({level:e,path:t,lpath:r,pa:n.$a}),wa=(e,t)=>(e._indices||(e._indices={}),yi(e,t.removed),gi(e,t.added),xi(e,t.changed),wi(e,t.reorder),e),ba=(e,t)=>(e._indices||(e._indices={}),yi(e,t.removed),gi(e,t.added),xi(e,t.changed),wi(e,t.reorder),e),xi=(e,{fmodels:t,files:r})=>{bi(e,r,(n,i)=>{let{key:l,index:a}=i;return Object.assign(n,{key:l,index:a})}),bi(e,t,(n,i)=>(n.referrers&&k(i,"referrers",n.referrers),i))},bi=(e,t,r=n=>n)=>{let n={};for(let a of t)n[a.$a]=!0;let i={},l={};for(let a of t)j(a,(s,o)=>(i[s.$a]=s,l[s.$a]=s,s));j(e,(a,s)=>{if(Object.keys(i).length==0&&(a._halt=!0),i[a.$a]){if(e._indices[a.$a]){let o=e._indices[a.$a].metadata;o&&Ht(i[a.$a],"metadata",o)}n[a.$a]?a=r(a,i[a.$a]):a=i[a.$a],delete i[a.$a]}return a}),rn(e,l)},yi=(e,{fmodels:t,files:r})=>{vi(e,r,n=>xt(n)),vi(e,t)},vi=(e,t)=>{var i;let r={};for(let l of t)r[i=l.pa]||(r[i]=[]),r[l.pa].push(l.$a);let n=(l,a)=>a.reduce((s,o,c)=>(r[l.$a].includes(o.$a)&&s.push(c),s),[]);if(Ar(e,(l,a)=>(Object.keys(r).length==0&&(l._halt=!0),r[l.$a]),(l,a)=>{let s=[];switch(!0){case l.hasOwnProperty("fields"):s=n(l,l.fields);break;case l.hasOwnProperty("schs"):s=n(l,l.schs);break}return delete r[l.$a],s}),e._indices)for(let l of t)delete e._indices[l.$a]},gi=(e,{fmodels:t,files:r})=>{_i(e,r,n=>xt(n)),_i(e,t)},_i=(e,t,r=n=>n)=>{var l;let n={};for(let a of t)n[l=a.pa]||(n[l]=[]),n[a.pa].push({k:a.key,sch:()=>Bn(r(a)),index:a.index});ot(e,(a,s)=>(Object.keys(n).length==0&&(a._halt=!0),n[a.$a]),(a,s)=>{let o=n[a.$a];return delete n[a.$a],o});let i={};for(let a of t)j(a,(s,o)=>(i[s.$a]=s,s));rn(e,i)},wi=(e,{fmodels:t,files:r})=>{Ni(e,r,n=>xt(n)),Ni(e,t)},Ni=(e,t)=>{var l;let r={};for(let a of t){let{$a:s,index:o}=a;r[l=a.pa]||(r[l]=[]),r[a.pa].push({$a:s,index:o})}let n=(a,s)=>{let o={};for(let c of s)o[c.$a]=c;return r[a.$a].sort((c,m)=>c.index-m.index).map(c=>o[c.$a])};Re(e,(a,s)=>(Object.keys(r).length==0&&(a._halt=!0),r[a.$a]),(a,s)=>{switch(!0){case a.hasOwnProperty("fields"):a.fields=n(a,a.fields);break;case a.hasOwnProperty("schs"):a.schs=n(a,a.schs);break}return delete r[a.$a],a});let i={};for(let a of t)i[a.$a]=a;rn(e,i)},rn=(e,t)=>j(e,(r,n)=>(Object.keys(t).length==0&&(r._halt=!0),t[r.$a]&&(k(r,"_visit",!0),k(r,"_meta",n),e._indices[r.$a]=r,delete r._diff,delete t[r.$a]),r));var Ct=(e,t)=>{let r,n=e.metadata;switch(!0){case(e.t==O&&e.fields.length==0&&(n==null?void 0:n.strict)):r="{ empty }";break;case(e.t==O&&e.fields.length==0):r="{ any }";break;case(e.t==O&&(n==null?void 0:n.strict)):r="{ strict }";break;case e.t==O:r="{ \xA0 }";break;case(e.t==D&&(n==null?void 0:n.strict)):r="{ e | r strict }";break;case e.t==D:r="{ e | r }";break;case e.t==L:r=y`[\xa0 ${Ct(e.sch,t)} \xa0]`;break;case e.t==V:r="( \xA0 )";break;case e.t==P:r="dict";break;case e.t==U:r="||";break;case e.t==R:r=`|| ${(n==null?void 0:n.tagname)||e.tagname}`;break;case e.t==ye:r="string",(n==null?void 0:n.pattern)&&(r=y`${r} <span class="m pattern">/${n.pattern}/<span>`);break;case e.t==ve:r="integer";break;case e.t==re:r="int_8";break;case e.t==ie:r="int_16";break;case e.t==ae:r="int_32";break;case e.t==ne:r="uint_8";break;case e.t==le:r="uint_16";break;case e.t==se:r="uint_32";break;case e.t==ge:r="float_32";break;case e.t==we:r="float_64";break;case e.t==be:r="bool";break;case e.t==Se:r="nil";break;case e.t==lt:r="any";break;case(e.t==J&&!!t.models[e.$r]):Ht(e,"_text",pr(e,t)),r=y`<span class="ref" ._a="${e.$r}">${e._text}</span >`;break;case(e.t==J&&e.$r==null):r=y`<span class="ref" title="Ref type">{ }</span>`;break;case e.t==J:r=y`<span class="ref notfound" title="Ref type">${`${e._text||e.$r} (#404)`}</span>`;break;case e.t==oe:r=y`<span class="value" title="Value type">${pr(e,t)}</span>`;break;default:r="# UNDEFINED_TYPE #"}return t.tText&&(r=t.tText(e,t)||r),r},pr=(e,t)=>{var r;switch(!0){case e.t==oe:return JSON.stringify(e.v);case e.t==J:return(r=t.models[e.$r])==null?void 0:r.display;default:return Ie(e.t)}};var Bi=Ml(Fi());var Xa={"":["<em>","</em>"],_:["<strong>","</strong>"],"*":["<strong>","</strong>"],"~":["<s>","</s>"],"\n":["<br />"]," ":["<br />"],"-":["<hr />"]};function Ki(e){return e.replace(RegExp("^"+(e.match(/^(\t| )+/)||"")[0],"gm"),"")}function Mt(e){return(e+"").replace(/"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function Pt(e,t){var r,n,i,l,a,s=/((?:^|\n+)(?:\n---+|\* \*(?: \*)+)\n)|(?:^``` *(\w*)\n([\s\S]*?)\n```$)|((?:(?:^|\n+)(?:\t|  {2,}).+)+\n*)|((?:(?:^|\n)([>*+-]|\d+\.)\s+.*)+)|(?:!\[([^\]]*?)\]\(([^)]+?)\))|(\[)|(\](?:\(([^)]+?)\))?)|(?:(?:^|\n+)([^\s].*)\n(-{3,}|={3,})(?:\n+|$))|(?:(?:^|\n+)(#{1,6})\s*(.+)(?:\n+|$))|(?:`([^`].*?)`)|(  \n\n*|\n{2,}|__|\*\*|[_*]|~~)/gm,o=[],c="",m=t||{},p=0;function x(f){var u=Xa[f[1]||""],h=o[o.length-1]==f;return u?u[1]?(h?o.pop():o.push(f),u[0|h]):u[0]:f}function d(){for(var f="";o.length;)f+=x(o[o.length-1]);return f}for(e=e.replace(/^\[(.+?)\]:\s*(.+)$/gm,function(f,u,h){return m[u.toLowerCase()]=h,""}).replace(/^\n+|\n+$/g,"");i=s.exec(e);)n=e.substring(p,i.index),p=s.lastIndex,r=i[0],n.match(/[^\\](\\\\)*\\$/)||((a=i[3]||i[4])?r='<pre class="code '+(i[4]?"poetry":i[2].toLowerCase())+'"><code'+(i[2]?' class="language-'+i[2].toLowerCase()+'"':"")+">"+Ki(Mt(a).replace(/^\n+|\n+$/g,""))+"</code></pre>":(a=i[6])?(a.match(/\./)&&(i[5]=i[5].replace(/^\d+/gm,"")),l=Pt(Ki(i[5].replace(/^\s*[>*+.-]/gm,""))),a==">"?a="blockquote":(a=a.match(/\./)?"ol":"ul",l=l.replace(/^(.*)(\n|$)/gm,"<li>$1</li>")),r="<"+a+">"+l+"</"+a+">"):i[8]?r='<img src="'+Mt(i[8])+'" alt="'+Mt(i[7])+'">':i[10]?(c=c.replace("<a>",'<a href="'+Mt(i[11]||m[n.toLowerCase()])+'">'),r=d()+"</a>"):i[9]?r="<a>":i[12]||i[14]?r="<"+(a="h"+(i[14]?i[14].length:i[13]>"="?1:2))+">"+Pt(i[12]||i[15],m)+"</"+a+">":i[16]?r="<code>"+Mt(i[16])+"</code>":(i[17]||i[1])&&(r=x(i[17]||"--"))),c+=n,c+=r;return(c+e.substring(p)+d()).replace(/^\n+|\n+$/g,"")}customElements.define("t-md",class extends HTMLElement{connectedCallback(){this.innerHTML=(0,Bi.default)(Pt(this.textContent))}});var Wi=(e,t)=>y`
  ${Qa(e)}
  <ul>
    ${Za(e,{models:t._models,path:"",rootKey:t.key})}
  </ul>`,Qa=e=>{switch(!0){case[O,D].includes(e.t):return y`<p class="defs-docs">Fields Description</p>`;case[V,L].includes(e.t):return y`<p class="defs-docs">Elements Description</p>`;case[P].includes(e.t):return y`<p class="defs-docs">K V Description</p>`;case[U,R].includes(e.t):return y`<p class="defs-docs">Cases Description</p>`}},Za=(e,t)=>{switch(!0){case e.hasOwnProperty("fields"):return Z(e.fields,r=>r.$a,(r,n)=>fn({key:r.key,m:r.metadata,sch:r,ui:{...t,path:`${un(e,t)}[${r.key}]`}}));case e.hasOwnProperty("schs"):return Z(e.schs,r=>r.$a,(r,n)=>fn({key:es(e,n),m:r.metadata,sch:r,ui:{...t,path:`${un(e,t)}[][${n}]`}}));case e.hasOwnProperty("sch"):return fn({key:"\u2514",m:e.sch.metadata,sch:e.sch,ui:{...t,path:`${un(e,t)}[][${0}]`}})}},un=(e,t)=>e._meta.path.replace(`[${t.rootKey}]`,""),es=(e,t)=>{switch(e.t){case D:return{0:"e",1:"r"}[t];case P:return{0:"k",1:"v"}[t];default:return t}},fn=({key:e,sch:t,ui:r,m:n})=>y`<li>
  <dl>
    <dt>
      <a href="#${r.path}" class="k">${e}</a>
      <span class="s">:</span>
      <span class="t">${Ct(t,r)}</span>
    </dt>
    ${n&&n.description?y`<dd><t-md>${n.description}</t-md></dd>`:y`<dd><t-md>–––</t-md></dd>`}
  </dl>
</li>`;customElements.define("sch-meta",class extends HTMLElement{connectedCallback(){this.addEventListener("change",this.handleMetaChange),this.addEventListener("input",this.handleMetaChange),this.addEventListener("paste",this.handleMetaChange),this.addEventListener("focusout",this.handleMetaChange)}disconnectedCallback(){this.removeEventListener("change",this.handleMetaChange),this.removeEventListener("input",this.handleMetaChange),this.removeEventListener("paste",this.handleMetaChange),this.removeEventListener("focusout",this.handleMetaChange)}handleMetaChange(e){if(e.target instanceof HTMLTextAreaElement||e.target instanceof HTMLInputElement||e.target instanceof HTMLSelectElement){let t=l=>["checkbox","radio"].includes(l.type)?l.checked:l.value,r=this.querySelector("form").elements,n={};for(let l=0;l<r.length;l++){let a=t(r[l]);!(r[l]instanceof HTMLTextAreaElement)&&a==""||(n[r[l].name]=a)}let i={path:e.target.closest("[data-path]").dataset.path,file:e.target.closest("[data-file]").dataset.file,attrs:n};this.dispatchEvent(new CustomEvent("sch-update",{detail:i,bubbles:!0}))}}});customElements.define("autosize-text",class extends HTMLElement{static get observedAttributes(){return["data-value"]}attributeChangedCallback(e,t,r){this.autosize(r)}connectedCallback(){this.autosize.bind(this)()}autosize(e){for(let t of this.getElementsByTagName("textarea"))e||(e=t.value),e&&(t.value=e,at({target:t}))}});var Hi=e=>Pe(Z([{$a:"nothing"}],t=>t.$a,t=>pe),document.querySelector(e)),pn=(e,t,r)=>{try{let n=t.referrers||[];Pe(Z([t],i=>i.$a,i=>y`
    <p class="meta-def">${ns(r.key,i._meta.path)||"-"}</p>
    <p>${Ie(i.t)}</p>
    <form data-path="${i._meta.path}" data-file="${r.key}" class="fbox">
      ${et(i,"title",{keyDisplay:"Title"})}
      ${et(i,"description",{keyDisplay:"Description"})}
      ${ls(i)}
      ${zi(i,"rw",{collection:[["r","Readonly"],["w","Writeonly"],["rw","Read and Write"]],selected:$(i,"rw","rw"),keyDisplay:"Read / Write"})}
      ${is(i,"default",{keyDisplay:"Default",min:$(i,"min"),max:$(i,"max")})}
    </form>
    ${ts(n)}
    ${rs(i,r)}
  `),document.querySelector(e))}catch(n){console.log(n)}},ts=e=>e.length!=0?y`
    <p class="referrers">Referrers</p>
    <ul>
      ${e.map(t=>y`<li>${t._meta.lpath.slice(1).map(r=>r.key||r.index||r._meta.index).join(" / ")}</li>`)}
    </ul>
    `:pe,rs=(e,t)=>Wi(e,t),ns=(e,t)=>{t=t.substring(1,t.length-1).split("][").filter(n=>n!=""),t.splice(0,0,e);let r=y`<span style="color: var(--meta-def-color);">${t[0]} :: ${t[1]}</span>`;return t=t.slice(2).flatMap(n=>[y`<span style="margin: 0 .5rem;">/</span>`,document.createTextNode(n)]),t.splice(0,0,r),t},gt=(e,t,r,n={})=>{var i;return y`
  <label class="${n.readonly&&`box-label ${t} readonly`||`box-label ${t}`}">
    <p class="l">${n.keyDisplay||t}</p>
    ${n.title}
    ${r}
    ${(i=jt(e,t))==null?void 0:i.map(l=>y`<p class="err">${l}</p>`)}
  </label>
  `};var et=(e,t,r={})=>gt(e,t,y`
    <autosize-text data-value="${$(e,t)||""}">
      <textarea name="${wt(e,t)}" maxlength="${q(Ge(r.maxlength))}" minlength="${q(Ge(r.minlength))}" ?readonly="${r.readonly}" rows="1" spellcheck="false" class="${q(jt(e,t)&&"invalid")}" @input="${at}">${r.value||$(e,t,"")}</textarea>
    </autosize-text>
  `,r),tt=(e,t,r={})=>gt(e,t,y`
    <input type="number" name="${wt(e,t)}" inputmode="decimal" step="${r.step||"any"}" min="${q(Ge(r.min))}" max="${q(Ge(r.max))}" value="${q(Ge(r.value)||$(e,t))}" ?readonly="${r.readonly}" class="${q(jt(e,t)&&"invalid")}">
  `,r),Fe=(e,t,r={})=>gt(e,t,y`
    <input type="number" name="${wt(e,t)}" inputmode="numeric" pattern="[0-9]*" min="${q(Ge(r.min))}" max="${q(Ge(r.max))}" value="${q(Ge(r.value)||$(e,t))}" ?readonly="${r.readonly}" class="${q(jt(e,t)&&"invalid")}">
  `,r),rt=(e,t,r={})=>gt(e,t,y`
    <input type="checkbox" name="${wt(e,t)}" ?disabled="${r.readonly}" ?checked="${!!$(e,t)}" .checked="${!!$(e,t)}" .indeterminate="${r.indeterminate}">
  `,r),zi=(e,t,r={})=>gt(e,t,y`
    <select name="${wt(e,t)}" ?disabled="${r.readonly}">
      ${r.collection.map(([n,i])=>y`<option value="${n}" ?selected="${(r.selected||$(e,t))==n}">${i}</option>`)}
    </select>
  `,r),as=(e,t,r={})=>gt(e,t,y`
    <input type="text" list="${e._meta.level}${e._meta.index}" name="${wt(e,t)}" ?readonly="${r.readonly}" class="${q(jt(e,t)&&"invalid")}">
    <datalist id="${e._meta.level}${e._meta.index}">
      ${r.collection.map(([n,i])=>y`<option value="${n}">${i}</option>`)}
    </datalist>
  `,r),is=(e,t,r={})=>{let n=vt(e.t)||{};switch(e.t){case be:let i={collection:[["t","True"],["f","False"],["i","Unset"]],selected:$(e,t,"i")};return zi(e,t,Object.assign(r,i));case ve:case re:case ie:case ae:case ne:case le:case se:case ge:case we:return tt(e,t,Object.assign(r,n));case ye:return et(e,t,r);default:return""}},ss=["uuid","date-time","date","time","duration","email","idn-email","hostname","idn-hostname","ipv4","ipv6","uri","uri-reference","iri","iri-reference","uri-template","json-pointer","relative-json-pointer"],Ge=e=>e==0?"0":e,wt=(e,t)=>t,$=(e,t,r)=>(e.metadata||{})[t]||r,bt=e=>Math.max(0,e),ls=e=>{let t,r=vt(e.t)||{};switch(e.t){case O:!e.referrers||e.referrers.length==0?t=[rt(e,"strict",{keyDisplay:"Strict"})]:t=[];break;case D:!e.referrers||e.referrers.length==0?t=[rt(e,"strict",{keyDisplay:"Strict"})]:t=[];break;case L:t=[Fe(e,"min",{keyDisplay:"Min Items",min:0,max:bt($(e,"max"))}),Fe(e,"max",{keyDisplay:"Max Items",min:bt($(e,"min",0))}),rt(e,"unique",{keyDisplay:"Item uniqueness"})];break;case V:t=[Fe(e,"min",{keyDisplay:"Min Items",value:e.schs.length,readonly:!0}),Fe(e,"max",{keyDisplay:"Max Items",value:e.schs.length,readonly:!0})];break;case P:t=[Fe(e,"min",{keyDisplay:"Min Properties",min:0,max:bt($(e,"max"))}),Fe(e,"max",{keyDisplay:"Max Properties",min:bt($(e,"min",0))})];break;case R:t=[et(e,"tagname",{keyDisplay:"Tag name",value:e.tagname})];break;case ye:t=[Fe(e,"min",{keyDisplay:"Min Length",min:0,max:bt($(e,"max"))}),Fe(e,"max",{keyDisplay:"Max Length",min:bt($(e,"min",0))}),et(e,"pattern",{keyDisplay:"String Pattern",maxlength:256}),as(e,"format",{collection:ss.map(l=>[l,l]),keyDisplay:"Format"})];break;case ve:t=[tt(e,"min",{keyDisplay:"Min",max:$(e,"max")}),tt(e,"max",{keyDisplay:"Max",min:$(e,"min")}),tt(e,"multipleOf",{keyDisplay:"Multiple of",min:1,max:Math.min($(e,"max",r.max),r.max)})];break;case re:case ie:case ae:case ne:case le:case se:t=[tt(e,"multipleOf",{keyDisplay:"Multiple of",min:1,max:Math.min($(e,"max",r.max),r.max)}),et(e,"format",{keyDisplay:"Format"})];break;case ge:case we:t=[tt(e,"min",{keyDisplay:"Min",max:$(e,"max")}),tt(e,"max",{keyDisplay:"Max",min:$(e,"min")}),et(e,"format",{keyDisplay:"Format"})];break;case be:t=[];case Se:t=[];break;case U:e.schs.reduce((l,a)=>a.t==oe&&l,!0)?t=[rt(e,"asUnion",{keyDisplay:"As Union"})]:t=[];break;case lt:t=[];case J:t=[];case oe:t=[];default:t=[]}let n=e._meta.parent.t==O,i=e._meta.level>2;if(n&&i)switch(!0){case(!$(e,"isKeyPattern")&&!$(e,"required")):t.push(rt(e,"required",{keyDisplay:"Required"}));break;case $(e,"isKeyPattern"):t.push(rt(e,"required",{keyDisplay:"Required",readonly:!0}));break;case $(e,"required"):t.push(rt(e,"required",{keyDisplay:"Required"}));break}return t},jt=(e,t)=>e.errors&&e.errors[t];var Yi=e=>Pe(y`<ul role="tree"></ul>`,document.querySelector(e)),hr=(e,t,r={})=>{var n;try{let i={level:1,tab:((n=r.ui)==null?void 0:n.tab)||0,models:t._models||{},taggedLevel:t.taggedLevel||{}};i.rootLevel=i.level,Object.assign(i,r.ui),r.ui.lineClass&&Object.assign(i,{tab:r.ui.tab+2}),os(e,{sch:t,ui:i,path:t.path||"",key:t.key,parent:t})}catch(i){console.log(i)}},os=(e,t)=>Pe(y`
  <ul role="tree" aria-multiselectable="true" class="${`${t.ui.lineClass||""} text-sm`}" aria-labelledby="${mn(t.ui)+"_tree"}">
    ${Lt(t)}
  </ul>
  `,document.querySelector(e)),hn=e=>q(mn(e)),mn=e=>e.taggedLevel[e.level],Ji=e=>{let t;if(!e)return"";for(let r of Object.keys(e))switch(r){case Le:t="N";break;case Ue:t="R";break;case he:t="M";break;case Ve:t="O";break;case qe:t="C";break;case Te:t="C";break;case yt:t="C";break}return t||""},Lt=e=>{switch(!0){case e.ui.level==e.ui.rootLevel:return Object.assign(e.ui,{expanded:!0}),cs(e);case[L].includes(e.sch.t):return e.sch.sch.hasOwnProperty("fields")||e.sch.sch.hasOwnProperty("schs")?Object.assign(e.ui,{expanded:!0}):Object.assign(e.ui,{expanded:!1}),Xi(e);case(e.sch.hasOwnProperty("fields")||e.sch.hasOwnProperty("schs")):return Object.assign(e.ui,{expanded:!0}),Xi(e);default:return ds(e)}},cs=e=>y`
  <li id="${e.path}" data-tag="${hn(e.ui)}" .key="${e.key}" .index="${0}" .sch=${e.sch} aria-posinset="${1}" class="root-item" role="treeitem" aria-level="${e.ui.level}" aria-selected="false" aria-expanded="${e.ui.expanded}" tabindex="-1">
    <dfn class="h" id="${mn(e.ui)}_tree">
      ${Tn(e.key)}
    </dfn>
    <ul data-group="${Zi(e.sch)}" role="group" tabindex="-1">
      ${Qi(e)}
    </ul>
  </li>`,Xi=e=>y`
  <li id="${e.path}" data-tag="${hn(e.ui)}" .key="${e.key}" .index="${e.ui.index}" .sch=${e.sch} aria-posinset="${e.ui.index+1}" class="folder" role="treeitem" aria-level="${e.ui.level}" aria-selected="false" aria-expanded="${e.ui.expanded}" tabindex="-1">
    <dfn class="h" data-diff="${Ji(e.sch._diff)}" data-group-size="${us(e.sch)}">
      ${el(Object.assign(e,{key:Tn(e.key)}))}
      ${tl(e)}
    </dfn>
    <ul data-group="${Zi(e.sch)}" role="group">
      ${Qi(e)}
    </ul>
  </li>`,ds=e=>y`
  <li id="${e.path}" data-tag="${hn(e.ui)}" data-diff="${Ji(e.sch._diff)}" .key="${e.key}" .index="${e.ui.index}" .sch=${e.sch} aria-posinset="${e.ui.index+1}" class="file" role="treeitem" aria-level="${e.ui.level}" aria-selected="false" tabindex="-1">
    ${el(Object.assign(e,{key:Tn(e.key)}))}
    ${tl(e)}
  </li>`,Qi=e=>{if(e.ui.depthLimit&&e.ui.level>=e.ui.depthLimit)return pe;switch(!0){case[O,R].includes(e.sch.t):return fs(e);case[V,P,D].includes(e.sch.t):return ps(e);case[L].includes(e.sch.t):return ms(e);case[U].includes(e.sch.t):return hs(e);default:return pe}},fs=e=>Z(e.sch.fields,t=>t.$a,(t,r)=>Lt({key:t.key,sch:t,parent:e.sch,ui:{...e.ui,level:e.ui.level+1,index:r,parentPath:e.path},path:`${e.path}[${t.key}]`})),ps=e=>Z(e.sch.schs,t=>t.$a,(t,r)=>Lt({key:r,sch:t,parent:e.sch,ui:{...e.ui,level:e.ui.level+1,index:r,parentPath:e.path},path:`${e.path}[][${r}]`})),ms=e=>Z([e.sch.sch],t=>t.$a,(t,r)=>Lt({key:r,sch:e.sch.sch,parent:e.sch,ui:{...e.ui,level:e.ui.level+1,index:r,parentPath:e.path},path:`${e.path}[][${r}]`})),hs=e=>Z(e.sch.schs,t=>t.$a,(t,r)=>Lt({key:"",sch:t,parent:e.sch,ui:{...e.ui,level:e.ui.level+1,index:r,parentPath:e.path},path:`${e.path}[][${r}]`})),xe=(e,t=0)=>`padding-left: ${(e.ui.level-1)*2+e.ui.tab-1+t}ch`,rl=(e,t,r)=>y`<textarea id="${e}" class="no-resize" spellcheck="false" maxlength="255" rows="1" autofocus
  data-parent-path="${t}"
  data-newline="false"
  @input="${at}"
  @focus="${Fn}"
  >${r}</textarea>`,el=e=>e.ui.level==e.ui.rootLevel+1?Ts(e):xs(e),Ts=e=>y`
  <span class="def" style="${xe(e)}">
    ${ys(e.sch,e.ui)}
  </span>
  <span class="k">${Tr(e)}</span>
  <span class="s">=</span>
  `,xs=e=>{var t,r;switch(!0){case e.parent.t==U:return y`
      <span class="s" style="${xe(e,1)}">|</span>
      `;case(e.parent.t==P&&e.sch.$a==e.parent.schs[0].$a):return y`
      <span class="s" style="${xe(e)}">k</span>
      `;case(e.parent.t==P&&e.sch.$a==e.parent.schs[1].$a):return y`
      <span class="s" style="${xe(e)}">v</span>
      `;case(e.parent.t==D&&e.sch.$a==e.parent.schs[0].$a):return y`
      <span class="s" style="${xe(e)}">e</span>
      `;case(e.parent.t==D&&e.sch.$a==e.parent.schs[1].$a):return y`
      <span class="s" style="${xe(e)}">r</span>
      `;case e.parent.t==L:return y`
      <span class="s" style="${xe(e)}">└</span>
      `;case e.parent.t==O:return y`
      <span class="k" style="${xe(e,1)}" data-required="${!!((t=e.sch.metadata)==null?void 0:t.required)}" data-is-pattern="${!!((r=e.sch.metadata)==null?void 0:r.isKeyPattern)}">
        ${Tr(e)}
      </span>
      <span class="s">:</span>
    `;case e.parent.t==R:return y`
      <span class="s" style="${xe(e,.5)}">|</span>
      <span class="k tag">
        ${Tr(e)}
      </span>
      <span class="s">·</span>
    `;default:return y`
      <span class="k" style="${xe(e,1)}">
        ${Tr(e)}
      </span >
      <span class="s">:</span>
    `}},Tr=e=>e.sch.uiMode=="editKey"?rl("key-edit",e.ui.parentPath,e.key):y`${e.key}`,tl=e=>e.ui.level==e.ui.rootLevel+1?gs(e):ws(e),gs=e=>e.ui.viewTypeTop?e.ui.viewTypeTop(e):y`<span class="t">${nl(e)}</span>`,ws=e=>y`<span class="t">${nl(e)}</span>`,nl=e=>e.sch.uiMode=="editType"?y`<combo-box id="type_search" list="typesearch">
      ${rl("type-edit",e.ui.parentPath,bs(e.sch,e.ui))}
    </combo-box>`:y`${vs(e.sch,e.ui)}`,bs=(e,t)=>pr(e,t),vs=(e,t)=>Ct(e,t),Tn=e=>e,Zi=e=>{switch(!0){case[O,R].includes(e.t):return"keyed";case[V,U,D].includes(e.t):return"indexed";default:return"none"}},us=e=>{switch(!0){case[O,R].includes(e.t):return e.fields.length;case[V,U,D].includes(e.t):return e.schs.length;case[L].includes(e.t):return 1;default:return 0}},ys=(e,t)=>{let r;switch(!0){case e.t==O:r="record";break;case e.t==L:r="list";break;case e.t==V:r="tuple";break;case e.t==U:r="union";break;case e.t==R:r="tagged union";break;case e.t==D:r="extensible union";break;default:r="field"}return t.modelTypeText&&(r=t.modelTypeText(e,t)||r),r};var{selectMultiNodeUpTo:il,selectMultiNodeDownTo:ll,selectMultiNodeUp:al,selectMultiNodeDown:sl,selectUpEnd:ol,selectDownEnd:cl,selectUp:xn,selectDown:yn,selectPrevious:_s,selectNext:Ns,selectRoot:dl,selectLast:ul}=rr,fl=({store:e,target:t,select:r,focus:n=!0})=>{nr({store:e,target:t,treeKeyDownCmds:[["shift-meta-ArrowUp",il],["shift-meta-ArrowDown",ll],["shift-ArrowUp",al],["shift-ArrowDown",sl],["meta-ArrowUp",ol],["meta-ArrowDown",cl],["ArrowUp",xn],["ArrowDown",yn],["Home",dl],["End",ul],["shift-+",ce],["Enter",ut],["Delete",Y],["meta-v",de],["alt-ArrowUp",ue],["alt-ArrowDown",fe]],textAreaKeyDownCmd:[["Enter",ke],["Escape",$t]],view:i=>hr(t,i||e,{ui:{depthLimit:2,tab:0,modelTypeText:(l,a)=>"modu",typeText:(l,a)=>{if(l.t==T.RECORD)return"record";if(l.t==T.VALUE)return"value";if(l.t==T.TUPLE)return"tuple";if(l.t==T.UNION)return"union"},viewTypeTop:l=>""}}),opts:{focus:n,selectId:r}})},xr=(e={})=>{let{store:t,target:r}=e;nr({store:t,target:r,treeKeyDownCmds:[["shift-meta-ArrowUp",il],["shift-meta-ArrowDown",ll],["shift-ArrowUp",al],["shift-ArrowDown",sl],["meta-ArrowUp",ol],["meta-ArrowDown",cl],["ArrowUp",xn],["ArrowDown",yn],["k",_s],["j",Ns],["Home",dl],["End",ul],["shift-+",ce],["Enter",ut],["shift-Enter",ft],["Delete",Y],["m",Et],["meta-x",Ye],["meta-c",Je],["meta-v",de],["shift-alt-ArrowUp",$e],["shift-alt-ArrowDown",Ee],["alt-ArrowUp",ue],["alt-ArrowDown",fe],["ArrowRight",At],["ArrowLeft",St],["Escape",({tree:n})=>Me(n)]],textAreaKeyDownCmd:[["Enter",ke],["Escape",$t]],view:n=>hr(r,n||t,{ui:{lineClass:"setnu",tab:3,modelTypeText:(i,l)=>i.isEntry?"entrypoint":"type"}}),opts:{focus:e.focus,selectId:e.select}})},yr=({store:e,target:t,select:r,focus:n=!1})=>{nr({store:e,target:t,treeKeyDownCmds:[["ArrowUp",xn],["ArrowDown",yn],["ArrowRight",At],["ArrowLeft",St]],textAreaKeyDownCmd:[],view:i=>hr(t,i||e,{ui:{lineClass:"setnu",tab:3,modelTypeText:(l,a)=>l.isEntry?"entrypoint":"type"}}),opts:{focus:n,selectId:r}})},gr=({store:e,target:t,treeTarget:r})=>{let n=document.querySelector(t),i=document.querySelector(`${r} [role='tree']`);!n||!i||(k(e,"renderSchMeta",function(l){ks({tree:i,store:l||this,metaForm:t})}),e.renderSchMeta())},ks=({tree:e,store:t,metaForm:r})=>{let n=e.querySelectorAll("[role='treeitem'][aria-selected='true']");if(n.length==1){let i=H(t,n[0].id);i&&pn(r,i,t)}},pl=e=>Yi(e),ml=e=>Hi(e);var Tl=(e,t)=>{e.errors={},e.changes={},e.metadata||(e.metadata={}),nt(e,"title",t),nt(e,"description",t),hl(e,"rw",["rw","r","w"],t),$s(e,t);for(let r of Object.keys(e.changes))(e.errors[r]||[]).length==0&&e.changes[r]!=null?e.metadata[r]=e.changes[r]:delete e.metadata[r];return e},$s=(e,t)=>{let r=vt(e.t)||{};switch(e.t){case O:Os(e,t);break;case D:Ds(e,t);break;case L:Is(e,t);break;case V:Rs(e,t);break;case P:Cs(e,t);break;case U:Ms(e,t);break;case R:Ps(e,t);break;case ye:Es(e,t);break;case ve:gn(e,t);break;case re:case ie:case ae:case ne:case le:case se:gn(e,t,{min:r.min,max:r.max});break;case ge:case we:gn(e,t);break;case be:As(e,t);break;case Se:Ss(e,t);break}switch(e._meta.parent.t){case O:Ut(e,"required",t);break}},Es=(e,t)=>{js(e,"pattern",t),Ae(e,"min",t,{min:0}),Ae(e,"max",t,{min:0}),nt(e,"format",t),Vt(e,t),nt(e,"default",t,Object.assign(xl(e,["min","max","pattern"]),{ignoreEmpty:!0}))},As=(e,t)=>{hl(e,"default",["t","f","i"],t)},gn=(e,t,r)=>{wr(e,"min",t,r),wr(e,"max",t,r),Ae(e,"multipleOf",t),nt(e,"format",t),Vt(e,t),wr(e,"default",t,Object.assign(xl(e,["min","max","multipleOf"]),r))},Ss=(e,t)=>{Ls(e,"default",t)},Os=(e,t)=>{Ut(e,"strict",t)},Ds=(e,t)=>{Ut(e,"strict",t)},Is=(e,t)=>{Ae(e,"min",t,{min:0}),Ae(e,"max",t,{min:0}),Vt(e,t),Ut(e,"unique",t)},Rs=(e,t)=>{Ae(e,"min",t,{min:1}),Ae(e,"max",t,{min:1}),Vt(e,t)},Cs=(e,t)=>{Ae(e,"min",t,{min:0}),Ae(e,"max",t,{min:0}),Vt(e,t)},Ms=(e,t)=>{Ut(e,"asUnion",t)},Ps=(e,t)=>{nt(e,"tagname",t,{min:1})},xl=(e,t=[])=>{let r={};for(let n of t)(e.errors[n]||[]).length==0&&(typeof e.changes[n]=="number"?(e.changes[n]||e.changes[n]==0)&&(r[n]=e.changes[n]):r[n]=e.changes[n]);return r},nt=(e,t,r,n={})=>{if(!r.hasOwnProperty(t))return e.changes[t]=void 0;if(n.ignoreEmpty&&r[t]=="")return;let i=r[t],l=2**18,a=o=>new Blob([o]).size,s=o=>n[o]!=null;a(i)>l?F(e,t,`string size limit is ${Math.ceil(l/1024)} KB`):s("max")&&i.length>n.max?F(e,t,`must be less than or equal ${n.max} length`):s("min")&&i.length<n.min?F(e,t,`must be grater than or equal ${n.min} length`):s("pattern")&&n.pattern!=""?new RegExp(n.pattern).test(i)||F(e,t,`must matche pattern ${n.pattern}`):e.changes[t]=i},Ut=(e,t,r)=>{if(!r.hasOwnProperty(t))return e.changes[t]=void 0;let n=!!r[t];e.changes[t]=n},wr=(e,t,r,n={})=>{if(!r.hasOwnProperty(t))return e.changes[t]=void 0;let i=wn(r[t]),l=a=>n[a]!=null;!i&&i!=0?F(e,t,"must be number"):l("min")&&i<n.min?F(e,t,`must be greater than or equal ${n.min}`):l("max")&&i>n.max?F(e,t,`must be less than than or equal ${n.max}`):l("multipleOf")&&i%n.multipleOf!=0?F(e,t,`must be multiple of ${n.multipleOf}`):e.changes[t]=i},Ae=(e,t,r,n)=>{if(!r.hasOwnProperty(t))return e.changes[t]=void 0;wr(e,t,r,n);let i=e.changes[t];(e.errors[t]||[]).length==0&&!Number.isInteger(e.changes[t])&&F(e,t,"must be integer number")},js=(e,t,r)=>{if(!r.hasOwnProperty(t))return e.changes[t]=void 0;if(nt(e,t,r),(e.errors[t]||[]).length==0)try{let n=r[t];if(n=="")return;new RegExp(n),e.changes[t]=n}catch(n){F(e,t,"invalid regex")}},Vt=(e,t)=>{if(t.min&&t.max){let r=wn(t.min),n=wn(t.max);(r||r==0)&&(n||n==0)&&r>n&&(F(e,"min","min is greater than max"),F(e,"max","max is less than min"))}},Ls=(e,t,r)=>{if(!r.hasOwnProperty(t))return e.changes[t]=void 0;r[t]!=null?F(e,t,"must be null"):e.changes[t]=r[t]},hl=(e,t,r,n)=>{if(!n.hasOwnProperty(t))return e.changes[t]=void 0;r.includes(n[t])?e.changes[t]=n[t]:F(e,t,"value must be r, w, or rw")},F=(e,t,r)=>{e.errors[t]=[],e.errors[t].push(r)},wn=e=>Us(e,"number");var Us=(e,t)=>{try{return e=JSON.parse(e),t==typeof e?e:void 0}catch(r){return}};var{selectMultiNodeUpTo:yl,selectMultiNodeDownTo:gl,selectMultiNodeUp:wl,selectMultiNodeDown:bl,selectUpEnd:Vs,selectDownEnd:qs,selectUp:Gs,selectDown:Fs,selectPrevious:Id,selectNext:Rd,selectRoot:vl,selectLast:Ks}=rr,_l=(e,t,r,n)=>{let i=t.closest("[data-tag='file']"),l=i==null?void 0:i.key;t.closest("[id='project']")?Bs(e,l,r,n):t.closest("[id='fmodel']")&&Ws(e,l,t,r,n)},Bs=(e,t,r,n)=>{switch(r){case ut:case ue:case fe:case yl:case gl:case wl:case bl:case vl:break;case ce:case Y:case $e:case Ee:case ke:case kt:case Vs:case qs:case Gs:case Fs:case Ks:bn({projectStore:e,filename:t});break;case de:e.render();break}},Ws=(e,t,r,n,i)=>{switch(n){case vl:case yl:case gl:case wl:case bl:case ue:case fe:case At:case St:case $t:case ut:case ft:case Ye:case Je:return}let l=Rt(e,t);switch(r.dataset.tag){case ee:switch(n){case ce:case Y:case de:l._models=je(e),e.render();break}break;case K:switch(n){case Et:Nl(r,e,t),l.render();break;case Y:l._models=je(e),e.render();break;case $e:case Ee:Nl(r,e,t),l._models=je(e),l.render(),e.render();break;case ke:l._models=je(e),l.render()}break}l.renderSchMeta()},bn=e=>{let{projectStore:t,filename:r,fmodelname:n=null,focus:i=!1}=e,l=Rt(t,r);if(l){if(k(t,"_currentFileStore",l),l._models=je(t),xr({store:l,target:"[id='fmodel']",select:n,focus:i}),gr({store:l,target:"[id='fsch']",treeTarget:"[id='fmodel']"}),!window._treeClipboard){let a=document.querySelector("[id='fmodel'] [role='tree']");a._aria.clearClipboard(a)}}else if(t.fields.length==0){let a=document.querySelector("[id='fmodel'] [role='tree']");pl("[id='fmodel']"),ml("[id='fsch']")}},Nl=(e,t,r)=>{e.dataset.tag==K&&en(t,(n,i)=>(i.path!=`[${r}]${e.id}`&&n.isEntry&&delete n.isEntry,n))},kl={update:({store:e,detail:t})=>{let{path:r,attrs:n}=t,i=Ne(e,r,(l,a)=>Tl(l,n));return i&&(e.render&&e.render(e),e.renderSchMeta&&e.renderSchMeta(e)),i}},$l=e=>[ce,Y,ke,de,$e,Ee,ue,fe,Y,Et].map(t=>t.name).includes(e);var{assign:Ke}=Object,El=(e,t)=>{var f,u,h,b,E,A;let r={},n=v=>{if(r[v])return r[v];for(let g of e.fields)for(let w of g.fields)if(r[w.key]={file:g,fmodelOf:w},w.key==v)return r[v]},i={},l=v=>i[v]?i[v]:Re(e,(g,w)=>{if(e.taggedLevel[w.level]==K&&w.path!="")return v.startsWith(w.path)?(i[v]=g,!0):!1},(g,w)=>(k(g,"_meta",w),g)),a=({$a:v,key:g,index:w,t:_})=>({$a:v,key:g,index:w,t:_}),s=v=>a(v),o=e._diffToRemote;if(!o)return;let c={};c.files=[],c.fmodels=[],c.subfmodels=[];for(let v of o){let g=e.taggedLevel[v._diff.meta.level];g==Tt?c.project=v:g==ee?c.files.push(v):g==K?c.fmodels.push(v):c.subfmodels.push(v)}let m={},p={},x={},d={};p.files||(p.files={}),p.fmodels||(p.fmodels={}),x.files||(x.files={}),x.fmodels||(x.fmodels={}),m.files||(m.files={}),m.fmodels||(m.fmodels={}),d.files||(d.files={}),d.fmodels||(d.fmodels={}),c.project&&(m.project=s(c.project));for(let v=0;v<c.files.length;v++){let g=c.files[v],w=a(g),_=g._diff.meta.path;if(g._diff[Le]){p.files[_]=w;for(let N of g.fields)p.fmodels[`[${g.key}][${N.key}]`]=Ke(N,{pa:w.$a})}else g._diff[Ue]?x.files[_]={$a:w.$a}:g._diff[Ve]?_e(e.fields,(N,I)=>{d.files[`[${N.key}]`]=a(Object.assign(N,{index:I}))}):g._diff[he]?console.log("project does not permit as parent for moving items"):(g._diff[qe]&&(m.files[_]=w),g._diff[Te]&&console.log("file type is always record, cannot be changed"))}for(let v=0;v<c.fmodels.length;v++){let g=c.fmodels[v],w=g._diff.meta.path,_=g._diff.meta.pa;if(g._diff[Le])p.fmodels[w]=Ke(g,{pa:_});else if(g._diff[Ue])x.fmodels[w]={$a:g.$a,pa:_};else if(g._diff[Ve]){let N=g._diff.meta.lpath[1];d.fmodels[`[${N.key}][${g.key}]`]||_e(N.fields,(I,G)=>{d.fmodels[`[${N.key}][${I.key}]`]={$a:I.$a,t:I.t,key:I.key,index:G,pa:N.$a}})}else if(g._diff[he]){let{oldParent:N,newParent:I,oldPath:G,newPath:Be}=g._diff[he],We,it,qt,He,br;switch(e.taggedLevel[N.level]){case Tt:console.log("fmodel was not possible to be a file");break;case ee:He=N,x.fmodels[G]={$a:g.$a,pa:He.$a};break;case K:default:He=N.lpath[1],br=N.lpath[2]||N,qt=`[${He.key}][${br.key}]`,it=((f=e._indices)==null?void 0:f[br.$a])||l(qt),m.fmodels[qt]=Ke(it,{pa:He.$a})}switch(e.taggedLevel[I.level]){case ee:We=I,it=g,p.fmodels[Be]=Ke(it,{pa:We.$a});break;default:console.log("fmodel parent can only be file tag")}}p.fmodels[w]||x.fmodels[w]||(g._diff[qe]||g._diff[Te]||g._diff[yt])&&(m.fmodels[w]=Ke(g,{pa:_}))}for(let v=0;v<c.subfmodels.length;v++){let g,w,_,N,I,G=c.subfmodels[v];if(G._diff[Le]||G._diff[Ue]||G._diff[Ve]||G._diff[qe]||G._diff[Te])N=G._diff.meta.lpath[1],I=G._diff.meta.lpath[2],_=`[${N.key}][${I.key}]`,!p.fmodels[_]&&!x.fmodels[_]&&(w=((u=e._indices)==null?void 0:u[I.$a])||l(_),(h=m.fmodels)[_]||(h[_]=Ke(w,{pa:N.$a})));else if(G._diff[he]){let{oldParent:Be,newParent:We,oldPath:it,newPath:qt}=G._diff[he];switch(e.taggedLevel[Be.level]){case Tt:console.log("subfmodel was not possible to be a file");break;case ee:N=Be,x.fmodels[it]={$a:G.$a,pa:N.$a};break;case K:default:N=Be.lpath[1],I=Be.lpath[2]||Be,_=`[${N.key}][${I.key}]`,w=((b=e._indices)==null?void 0:b[I.$a])||l(_),(E=m.fmodels)[_]||(E[_]=Ke(w,{pa:N.$a}))}switch(e.taggedLevel[We.level]){case Tt:console.log("subfmodel parent can only be fmodel or subfmodel");break;case ee:console.log("subfmodel parent can only be fmodel or subfmodel");break;case K:default:g=We.lpath[1],w=We.lpath[2]||zt(g.fields,He=>We.key==He.key),_=`[${g.key}][${w.key}]`,(A=m.fmodels)[_]||(A[_]=Ke(w,{pa:g.$a}))}}}return console.log({added:p,changed:m,removed:x,reorder:d,type:"diff_to_persist"}),t({changed:m,added:p,removed:x,reorder:d})};var Hs={createProjectStore:Ti,getFileStore:Rt,anchorsModels:je,projectToStore:ui,fileToStore:xt,controller:_l,mergeSchMetas:fi,mergeReferrers:pi,changeFile:bn,taggedDiff:El,isDiffableCmd:$l,SchMeta:kl,allSchs:Zr,rulesTable:Qr},zs={rFmodelTree:yr};export{fr as Diff,xr as FmodelTree,Hs as Project,fl as ProjectTree,gr as SchMetaForm,zs as View,Wt as legitTs,yr as rFmodelTree,Ie as tstr};
/**
 * @license
 * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */
/**
 * @license
 * Copyright (c) 2018 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */
