var ie,Vt=new Uint8Array(16);function Ae(){if(!ie&&(ie=typeof crypto!="undefined"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||typeof msCrypto!="undefined"&&typeof msCrypto.getRandomValues=="function"&&msCrypto.getRandomValues.bind(msCrypto),!ie))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return ie(Vt)}var We=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function Qt(e){return typeof e=="string"&&We.test(e)}var He=Qt;var T=[];for(var Me=0;Me<256;++Me)T.push((Me+256).toString(16).substr(1));function Zt(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=(T[e[t+0]]+T[e[t+1]]+T[e[t+2]]+T[e[t+3]]+"-"+T[e[t+4]]+T[e[t+5]]+"-"+T[e[t+6]]+T[e[t+7]]+"-"+T[e[t+8]]+T[e[t+9]]+"-"+T[e[t+10]]+T[e[t+11]]+T[e[t+12]]+T[e[t+13]]+T[e[t+14]]+T[e[t+15]]).toLowerCase();if(!He(r))throw TypeError("Stringified UUID is invalid");return r}var ze=Zt;function er(e,t,r){e=e||{};var n=e.random||(e.rng||Ae)();if(n[6]=n[6]&15|64,n[8]=n[8]&63|128,t){r=r||0;for(var l=0;l<16;++l)t[r+l]=n[l];return t}return ze(n)}var J=er;var y="record",v="list",x="tuple",k="string",O="number",ae="integer",_="boolean",C="null",h="union",B="any",D="ref",q="value",Xe=[y,x,v,h],se="def_",A="fmodel",I=()=>({type:B}),Ie=()=>({type:k}),Je=()=>({type:_}),Ye=()=>({type:O}),Fe=()=>({type:C}),ce=()=>({type:y,fields:{},order:[]}),Ve=()=>({type:v,sch:$(I)}),Qe=()=>({type:x,schs:[$(I)]}),Ze=()=>({type:h,schs:[$(I)]}),et=e=>({type:D,$ref:e}),Re=e=>{try{return e=JSON.parse(e),e==null||[k,O,_].includes(typeof e)?{type:q,const:e}:!1}catch(t){return!1}},$=(e,t,r={force:!1})=>{var l,o;let n=e();switch(!0){case t==A:((l=n.$anchor)==null?void 0:l.startsWith(se))||(n.$anchor=`${se}${J()}`);break;default:n.$anchor=J()}return r.force&&(((o=n.$anchor)==null?void 0:o.startsWith(se))?""+se+J():n.$anchor=J()),n};var tr=e=>{let t=JSON.parse(JSON.stringify(e));return U(t,(r,n)=>$(()=>r,null,{force:!0})),t},U=(e,t,r={path:"",level:1,parent:{}})=>{if(e._halt=!1,e=t(e,r),e._halt)return e;switch(!0){case[y].includes(e.type):let n=Object.keys(e.fields);for(let a=n.length-1;a>=0;a--){let u=n[a],s=e.fields[u],c={path:`${r.path}[${u}]`,level:r.level+1,parent:{_box:e._box,type:e.type}};if(s=U(s,t,c),e.fields[u]=s,s._halt)return Object.assign(e,{_halt:!0})}break;case[x,h].includes(e.type):for(let a=0;a<e.schs.length;a++){let u=e.schs[a],s={path:`${r.path}[][${a}]`,level:r.level+1,parent:{_box:e._box,type:e.type}};if(u=U(u,t,s),e.schs[a]=u,u._halt)return Object.assign(e,{_halt:!0})}break;case[v].includes(e.type):let l={path:`${r.path}[][0]`,level:r.level+1,parent:{_box:e._box,type:e.type}},o=U(e.sch,t,l);if(e.sch=o,o._halt)return Object.assign(e,{_halt:!0});break;default:}return e},Le=(e,t,r)=>{let n={original:{},popped:[]},l=r.sort((o,a)=>a-o);return U(e,(o,a)=>{if(a.path!=t)return o;switch(o.type){case y:let u=l.map(s=>[s,o.order[s]]).filter(([s,c])=>c);for(let[s,c]of u)n.popped.unshift({k:c,sch:o.fields[c],index:s}),delete o.fields[c];for(let s of l)o.order.splice(s,1);break;case v:break;case x:for(let s of l)n.popped.unshift({k:s,sch:o.schs.splice(s,1)[0],index:s});o.schs.length==0&&o.schs.splice(0,0,$(I));break;case h:for(let s of l)n.popped.unshift({k:s,sch:o.schs.splice(s,1)[0],index:s});o.schs.length==0&&o.schs.splice(0,0,$(I));break;default:}return o}),n},rr=e=>e.filter(t=>{for(let r of e){if(t==r)return!0;if(t.startsWith(r))return!1}}),Y=(e,t,r)=>{let n={original:{},inserted:[]},l=r.sort((a,u)=>a.index-u.index),o=(a,u)=>(a=Math.max(a,0),a=Math.min(a,u.length),a);return U(e,(a,u)=>{if(u.path!=t)return a;switch(a.type){case y:for(let{k:s,sch:c,index:d}of l){for(s=s==0?"0":s,s=s||`key_${Math.floor(Date.now()/100)}`,s=`${s}`;a.fields[s];)s=`${s} \u2013`;d=o(d,a.order),a.fields[s]=$(c,a._box),a.order.splice(d,0,s),n.inserted.push({k:s,sch:a.fields[s],index:d})}break;case v:break;case x:for(let{k:s,sch:c,index:d}of l)d=o(d,a.schs),a.schs.splice(d,0,$(c,a._box)),n.inserted.push({k:s,sch:a.schs[d],index:d});break;case h:for(let{k:s,sch:c,index:d}of l)d=o(d,a.schs),a.schs.splice(d,0,$(c,a._box)),n.inserted.push({k:s,sch:a.schs[d],index:d});default:}return a}),n},de=(e,{dstPath:t,startIndex:r=0},n)=>{r=Math.max(r,0);let l=(m,w,g)=>P(m,w,(L,z)=>(L._pinId=g,L)),o=(m,w)=>ue(m,(g,L)=>g._pinId==w,(g,L)=>(g._pinned=L,g)),a=rr(Object.keys(n)),u={},s={},c=Symbol(t);for(let m of a){let w=n[m],g=w.filter(z=>t.startsWith(z.id)).length!=0,L=z=>{var oe;return(oe=w.filter(X=>X.index==z)[0])==null?void 0:oe.newK};if(!g){l(e,t,c);let oe=Le(e,m,w.map(X=>X.index)).popped.map(({k:X,sch:Yt,index:Ft})=>({k:L(Ft)||X,sch:()=>Yt}));s[m]=oe}}let d=Object.values(s).flatMap(m=>m).map((m,w)=>({...m,index:r+w})),p=o(e,c);if(p){let m=Y(e,p._pinned.path,d);u[p._pinned.path]=m.inserted}return u},Ce=(e,{dstPath:t,startIndex:r=0},n)=>{let l=Object.values(n).reduce((u,s)=>{let c=s.map(p=>p.id),d=[];ue(e,(p,m)=>(c.includes(m.path)&&(p._meta=m,d.unshift(p)),d.length==c.length),(p,m)=>p);for(let p of s){if(t.startsWith(p.id))continue;let m=d.find(w=>w._meta.path==p.id);m&&u.unshift({k:p.key,sch:()=>tr(m),index:r+u.length,id:p.id})}return u},[]),o={},a=Y(e,t,l);return a.inserted.length!=0&&(o[t]=a.inserted),o},pe=(e,t,r)=>P(e,t,(n,l)=>{let o=$(r,l.parent._box);if(n.type==o.type)return n;{let{title:a,description:u,rw:s,required:c}=n;return Object.assign(o,{title:a,description:u,rw:s,required:c}),o}}),De=(e,t)=>ue(e,(r,n)=>n.path==t,(r,n)=>(r._meta=n,r)),P=(e,t,r)=>ue(e,(n,l)=>l.path==t,r),ue=(e,t,r)=>{let n;return U(e,(l,o)=>t(l,o)?(n=r(l,o),n._halt=!0,n):l),n&&(n._halt=!1),n};var F=e=>({get:t=>e.get(t),set:(t,r)=>(e.set(t,r),r)});var tt=/([^\s\\>"'=]+)\s*=\s*(['"]?)$/,nr=/^(?:area|base|br|col|embed|hr|img|input|keygen|link|menuitem|meta|param|source|track|wbr)$/i,lr=/<[a-z][^>]+$/i,or=/>[^<>]*$/,ir=/<([a-z]+[a-z0-9:._-]*)([^>]*?)(\/>)/ig,ar=/\s+$/,rt=(e,t)=>0<t--&&(lr.test(e[t])||!or.test(e[t])&&rt(e,t)),sr=(e,t,r)=>nr.test(t)?e:`<${t}${r.replace(ar,"")}></${t}>`,nt=(e,t,r)=>{let n=[],{length:l}=e;for(let a=1;a<l;a++){let u=e[a-1];n.push(tt.test(u)&&rt(e,a)?u.replace(tt,(s,c,d)=>`${t}${a-1}=${d||'"'}${c}${d?"":'"'}`):`${u}<!--${t}${a-1}-->`)}n.push(e[l-1]);let o=n.join("").trim();return r?o:o.replace(ir,sr)};var{isArray:G}=Array,{indexOf:lt,slice:fe}=[];var cr=1,ot=111,ur=({firstChild:e,lastChild:t})=>{let r=document.createRange();return r.setStartAfter(e),r.setEndAfter(t),r.deleteContents(),e},it=(e,t)=>e.nodeType===ot?1/t<0?t?ur(e):e.lastChild:t?e.valueOf():e.firstChild:e,at=e=>{let{childNodes:t}=e,{length:r}=t;if(r<2)return r?t[0]:e;let n=fe.call(t,0),l=n[0],o=n[r-1];return{ELEMENT_NODE:cr,nodeType:ot,firstChild:l,lastChild:o,valueOf(){if(t.length!==r){let a=0;for(;a<r;)e.appendChild(n[a++])}return e}}};var st=(e,t,r,n,l)=>{let o=r.length,a=t.length,u=o,s=0,c=0,d=null;for(;s<a||c<u;)if(a===s){let p=u<o?c?n(r[c-1],-0).nextSibling:n(r[u-c],0):l;for(;c<u;)e.insertBefore(n(r[c++],1),p)}else if(u===c)for(;s<a;)(!d||!d.has(t[s]))&&e.removeChild(n(t[s],-1)),s++;else if(t[s]===r[c])s++,c++;else if(t[a-1]===r[u-1])a--,u--;else if(t[s]===r[u-1]&&r[c]===t[a-1]){let p=n(t[--a],-1).nextSibling;e.insertBefore(n(r[c++],1),n(t[s++],-1).nextSibling),e.insertBefore(n(r[--u],1),p),t[a]=r[u]}else{if(!d){d=new Map;let p=c;for(;p<u;)d.set(r[p],p++)}if(d.has(t[s])){let p=d.get(t[s]);if(c<p&&p<u){let m=s,w=1;for(;++m<a&&m<u&&d.get(t[m])===p+w;)w++;if(w>p-c){let g=n(t[s],0);for(;c<p;)e.insertBefore(n(r[c++],1),g)}else e.replaceChild(n(r[c++],1),n(t[s++],-1))}else s++}else e.removeChild(n(t[s++],-1))}return r};var ct=e=>t=>{for(let r in t){let n=r==="role"?r:`aria-${r}`,l=t[r];l==null?e.removeAttribute(n):e.setAttribute(n,l)}},ut=(e,t)=>{let r,n=!0,l=document.createAttributeNS(null,t);return o=>{r!==o&&(r=o,r==null?n||(e.removeAttributeNode(l),n=!0):(l.value=o,n&&(e.setAttributeNodeNS(l),n=!1)))}},dt=(e,t,r)=>n=>{r!==!!n&&((r=!!n)?e.setAttribute(t,""):e.removeAttribute(t))},dr=({dataset:e})=>t=>{for(let r in t){let n=t[r];n==null?delete e[r]:e[r]=n}},pt=(e,t)=>{let r,n=t.slice(2);return!(t in e)&&t.toLowerCase()in e&&(n=n.toLowerCase()),l=>{let o=G(l)?l:[l,!1];r!==o[0]&&(r&&e.removeEventListener(n,r,o[1]),(r=o[0])&&e.addEventListener(n,r,o[1]))}},ft=e=>t=>{typeof t=="function"?t(e):t.current=e},mt=(e,t)=>t==="dataset"?dr(e):r=>{e[t]=r},yt=e=>{let t;return r=>{t!=r&&(t=r,e.textContent=r==null?"":r)}};var pr=function(e){"use strict";var t="fragment",r="template",n="content"in a(r),l=n?function(s){var c=a(r);return c.innerHTML=s,c.content}:function(s){var c=a(t),d=a(r),p=null;if(/^[^\S]*?<(col(?:group)?|t(?:head|body|foot|r|d|h))/i.test(s)){var m=RegExp.$1;d.innerHTML="<table>"+s+"</table>",p=d.querySelectorAll(m)}else d.innerHTML=s,p=d.childNodes;return o(c,p),c};return function(c,d){return(d==="svg"?u:l)(c)};function o(s,c){for(var d=c.length;d--;)s.appendChild(c[0])}function a(s){return s===t?e.createDocumentFragment():e.createElementNS("http://www.w3.org/1999/xhtml",s)}function u(s){var c=a(t),d=a("div");return d.innerHTML='<svg xmlns="http://www.w3.org/2000/svg">'+s+"</svg>",o(c,d.firstChild.childNodes),c}}(document),Ue=pr;var ht=({childNodes:e},t)=>e[t],me=e=>{let t=[],{parentNode:r}=e;for(;r;)t.push(lt.call(r.childNodes,e)),e=r,r=e.parentNode;return t},{createTreeWalker:Tt,importNode:ye}=document;var xt=ye.length!=1,Nt=xt?(e,t,r)=>ye.call(document,Ue(e,t,r),!0):Ue,bt=xt?e=>Tt.call(document,e,1|128,null,!1):e=>Tt.call(document,e,1|128);var V=(e,t,r)=>st(e.parentNode,t,r,it,e),fr=e=>{let t,r,n=[],l=o=>{switch(typeof o){case"string":case"number":case"boolean":t!==o&&(t=o,r?r.textContent=o:r=document.createTextNode(o),n=V(e,n,[r]));break;case"object":case"undefined":if(o==null){t!=o&&(t=o,n=V(e,n,[]));break}if(G(o)){t=o,o.length===0?n=V(e,n,[]):typeof o[0]=="object"?n=V(e,n,o):l(String(o));break}"ELEMENT_NODE"in o&&t!==o&&(t=o,n=V(e,n,o.nodeType===11?fe.call(o.childNodes):[o]))}};return l},mr=(e,t)=>{switch(t[0]){case"?":return dt(e,t.slice(1),!1);case".":return mt(e,t.slice(1));case"o":if(t[1]==="n")return pt(e,t)}switch(t){case"ref":return ft(e);case"aria":return ct(e)}return ut(e,t)};function wt(e){let{type:t,path:r}=e,n=r.reduceRight(ht,this);return t==="node"?fr(n):t==="attr"?mr(n,e.name):yt(n)}var Q="is\xB5",vt=F(new WeakMap),yr=/^(?:plaintext|script|style|textarea|title|xmp)$/i,K=()=>({stack:[],entry:null,wire:null}),Tr=(e,t)=>{let{content:r,updates:n}=hr(e,t);return{type:e,template:t,content:r,updates:n,wire:null}},xr=(e,t)=>{let r=nt(t,Q,e==="svg"),n=Nt(r,e),l=bt(n),o=[],a=t.length-1,u=0,s=`${Q}${u}`;for(;u<a;){let c=l.nextNode();if(!c)throw`bad template: ${r}`;if(c.nodeType===8)c.textContent===s&&(o.push({type:"node",path:me(c)}),s=`${Q}${++u}`);else{for(;c.hasAttribute(s);)o.push({type:"attr",path:me(c),name:c.getAttribute(s)}),c.removeAttribute(s),s=`${Q}${++u}`;yr.test(c.tagName)&&c.textContent.trim()===`<!--${s}-->`&&(c.textContent="",o.push({type:"text",path:me(c)}),s=`${Q}${++u}`)}}return{content:n,nodes:o}},hr=(e,t)=>{let{content:r,nodes:n}=vt.get(t)||vt.set(t,xr(e,t)),l=ye.call(document,r,!0),o=n.map(wt,l);return{content:l,updates:o}},Z=(e,{type:t,template:r,values:n})=>{let{length:l}=n;$t(e,n,l);let{entry:o}=e;(!o||o.template!==r||o.type!==t)&&(e.entry=o=Tr(t,r));let{content:a,updates:u,wire:s}=o;for(let c=0;c<l;c++)u[c](n[c]);return s||(o.wire=at(a))},$t=({stack:e},t,r)=>{for(let n=0;n<r;n++){let l=t[n];l instanceof he?t[n]=Z(e[n]||(e[n]=K()),l):G(l)?$t(e[n]||(e[n]=K()),l,l.length):e[n]=null}r<e.length&&e.splice(r)};function he(e,t,r){this.type=e,this.template=t,this.values=r}var{create:Nr,defineProperties:br}=Object,Et=e=>{let t=F(new WeakMap),r=n=>(l,...o)=>Z(n,{type:e,template:l,values:o});return br((n,...l)=>new he(e,n,l),{for:{value(n,l){let o=t.get(n)||t.set(n,Nr(null));return o[l]||(o[l]=r(K()))}},node:{value:(n,...l)=>Z(K(),{type:e,template:n,values:l}).valueOf()}})},gt=F(new WeakMap),Te=(e,t)=>{let r=typeof t=="function"?t():t,n=gt.get(e)||gt.set(e,K()),l=r instanceof he?Z(n,r):r;return l!==n.wire&&(n.wire=l,e.textContent="",e.appendChild(l.valueOf())),e},f=Et("html"),wl=Et("svg");var Pe=(e,t)=>JSON.stringify(e)==JSON.stringify(t),xe=e=>{e.target.value=e.target.value.replace(/\n/g,""),e.target.style.overflow="hidden",e.target.style.height="auto",e.target.style.height=`${e.target.scrollHeight}px`};var St=(e,t)=>{e.errors={},e.changes={},Ne(e,"title",t),Ne(e,"description",t),vr(e,"rw",["rw","r","w"],t),je(e,"required",t),wr(e,t);for(let r of Object.keys(e.changes))(e.errors[r]||[]).length==0&&(e[r]=e.changes[r]);return e},wr=(e,t)=>{e.type==y?kr(e,t):e.type==v?Or(e,t):e.type==x?_r(e,t):e.type==h?Ar(e,t):e.type==k?$r(e,t):e.type==O?gr(e,t):e.type==_?Er(e,t):e.type==C&&Sr(e,t)},$r=(e,t)=>{Mr(e,"pattern",t),M(e,"min",t,{min:0}),M(e,"max",t,{min:0}),ee(e,t),Ne(e,"default",t,Object.assign(kt(e,["min","max","pattern"]),{ignoreEmpty:!0}))},Er=(e,t)=>{je(e,"default",t)},gr=(e,t)=>{be(e,"min",t),be(e,"max",t),M(e,"multipleOf",t),ee(e,t),be(e,"default",t,kt(e,["min","max","multipleOf"]))},Sr=(e,t)=>{Ir(e,"default",t)},kr=(e,t)=>{M(e,"min",t,{min:0}),M(e,"max",t,{min:0}),ee(e,t)},Or=(e,t)=>{M(e,"min",t,{min:1}),M(e,"max",t,{min:1}),ee(e,t),je(e,"unique",t)},_r=(e,t)=>{M(e,"min",t,{min:1}),M(e,"max",t,{min:1}),ee(e,t)},Ar=(e,t)=>{},kt=(e,t=[])=>{let r={};for(let n of t)(e.errors[n]||[]).length==0&&(typeof e.changes[n]=="number"?(e.changes[n]||e.changes[n]==0)&&(r[n]=e.changes[n]):r[n]=e.changes[n]);return r},Ne=(e,t,r,n={})=>{if(!r.hasOwnProperty(t)||n.ignoreEmpty&&r[t]=="")return;let l=r[t],o=2**18;(u=>new Blob([u]).size)(l)>o?N(e,t,`string size limit is ${Math.ceil(o/1024)} KB`):n.max&&l.length>n.max?N(e,t,`must be less than or equal ${n.max} length`):n.min&&l.length<n.min?N(e,t,`must be grater than or equal ${n.min} length`):n.pattern?new RegExp(n.pattern).test(l)||N(e,t,`must matche pattern ${n.pattern}`):e.changes[t]=l},je=(e,t,r)=>{if(!r.hasOwnProperty(t))return e.changes[t]=!1;let n=Rr(r[t]);n==null?N(e,t,"must be boolean"):e.changes[t]=n},be=(e,t,r,n={})=>{if(!r.hasOwnProperty(t))return;let l=Be(r[t]);!l&&l!=0?N(e,t,"must be number"):n.min&&l<n.min?N(e,t,`must be greater than or equal ${n.min}`):n.max&&l>n.max?N(e,t,`must be less than than or equal ${n.max}`):n.multipleOf&&l%n.multipleOf!=0?N(e,t,`must be multiple of ${n.multipleOf}`):e.changes[t]=l},M=(e,t,r,n)=>{if(!r.hasOwnProperty(t))return;be(e,t,r,n);let l=e.changes[t];(e.errors[t]||[]).length==0&&!Number.isInteger(e.changes[t])?N(e,t,"must be integer number"):l>Number.MAX_SAFE_INTEGER?N(e,t,`must be less than or equal ${Number.MAX_SAFE_INTEGER}`):l<Number.MIN_SAFE_INTEGER&&N(e,t,`must be greater than or equal ${Number.MIN_SAFE_INTEGER}`)},Mr=(e,t,r)=>{if(!!r.hasOwnProperty(t)&&(Ne(e,t,r),(e.errors[t]||[]).length==0))try{let n=r[t];if(n=="")return;e.changes[t]=new RegExp(n)}catch(n){N(e,t,"invalid regex")}},ee=(e,t)=>{if(t.min&&t.max){let r=Be(t.min),n=Be(t.max);(r||r==0)&&(n||n==0)&&r>n&&(N(e,"min","min is greater than max"),N(e,"max","max is less than min"))}},Ir=(e,t,r)=>{!r.hasOwnProperty(t)||(r[t]!=null?N(e,t,"must be null"):e.changes[t]=r[t])},vr=(e,t,r,n)=>{!n.hasOwnProperty(t)||(r.includes(n[t])?e.changes[t]=n[t]:N(e,t,"value must be r, w, or rw"))},N=(e,t,r)=>{e.errors[t]=[],e.errors[t].push(r)},Be=e=>Ot(e,"number"),Rr=e=>Ot(e,"boolean");var Ot=(e,t)=>{try{return e=JSON.parse(e),t==typeof e?e:void 0}catch(r){return}};customElements.define("sch-meta",class extends HTMLElement{connectedCallback(){this.addEventListener("change",this.handleMetaChange),this.addEventListener("input",this.handleMetaChange),this.addEventListener("paste",this.handleMetaChange),this.addEventListener("focusout",this.handleMetaChange)}disconnectedCallback(){this.removeEventListener("change",this.handleMetaChange),this.removeEventListener("input",this.handleMetaChange),this.removeEventListener("paste",this.handleMetaChange),this.removeEventListener("focusout",this.handleMetaChange)}handleMetaChange(e){if(e.target instanceof HTMLTextAreaElement||e.target instanceof HTMLInputElement||e.target instanceof HTMLSelectElement){let t=o=>["checkbox","radio"].includes(o.type)?o.checked:o.value,r=this.querySelector("form").elements,n={};for(let o=0;o<r.length;o++){let a=t(r[o]);!(r[o]instanceof HTMLTextAreaElement)&&a==""||(n[r[o].name]=a)}let l={path:e.target.closest("[data-path]").dataset.path,attrs:n};this.dispatchEvent(new CustomEvent("sch-update",{detail:l,bubbles:!0}))}}});var ve=(e,t,r)=>{try{Te(e,f.for(t)`
    <p>${t.key||"-"}</p>
    <form data-path="${t.path}">
      ${we(t,"title",{keyDisplay:"Title"})}
      ${we(t,"description",{keyDisplay:"Description"})}
      ${Dr(t)}
      ${Lr(t,"rw",{collection:[["r","Readonly"],["w","Writeonly"],["rw","Read and Write"]],selected:"rw",keyDisplay:"Read / Write"})}
      ${Cr(t,"default",{keyDisplay:"Default"})}
    </form>
  `)}catch(n){}},te=(e,t,r,n={})=>{var l;return f`
  <label class="${n.readonly&&`meta-box ${t} readonly`||`meta-box ${t}`}">
    <p class="l">${n.keyDisplay||t} ${n.readonly&&f`<span>· readonly</span>`}</p>
    ${r}
    ${(l=$e(e,t))==null?void 0:l.map(o=>f`<p class="err">${o}</p>`)}
  </label>
  `},we=(e,t,r={})=>te(e,t,f`
    <textarea name="${re(e,t)}" maxlength="${r.maxlength}" minlength="${r.minlength}" ?readonly="${r.readonly}" rows="1" spellcheck="false" class="${$e(e,t)&&"invalid"}" oninput="${xe}">${e[t]||r.value}</textarea>
  `,r),Ee=(e,t,r={})=>te(e,t,f`
    <input type="number" name="${re(e,t)}" inputmode="decimal" step="any" min="${r.min}" max="${r.max}" value="${e[t]||r.value}" ?readonly="${r.readonly}" class="${$e(e,t)&&"invalid"}">
  `,r),R=(e,t,r={})=>te(e,t,f`
    <input type="number" name="${re(e,t)}" inputmode="numeric" pattern="[0-9]*" min="${r.min}" max="${r.max}" value="${e[t]||r.value}" ?readonly="${r.readonly}" class="${$e(e,t)&&"invalid"}">
  `,r),qe=(e,t,r={})=>te(e,t,f`
    <input type="checkbox" name="${re(e,t)}" ?disabled="${r.readonly}" ?checked="${e[t]||r.value}">
  `,r),Lr=(e,t,r={})=>te(e,t,f`
    <select name="${re(e,t)}" ?disabled="${r.readonly}">
      ${r.collection.map(([n,l])=>f`<option value="${n}" ?selected="${(e[t]||r.selected)==n}">${l}</option>`)}
    </select>
  `,r),Cr=(e,t,r={})=>{switch(e.type){case _:return qe(e,t,r);case O:return Ee(e,t,r);case k:return we(e,t,r);default:return""}},re=(e,t)=>t,Dr=e=>{let t;switch(!0){case e.type==y:t=[R(e,"min",{keyDisplay:"Min Properties",value:Object.keys(e.fields).length,readonly:!0}),R(e,"max",{keyDisplay:"Max Properties",value:Object.keys(e.fields).length,readonly:!0})];break;case e.type==v:t=[R(e,"min",{keyDisplay:"Min Items",min:1,value:1}),R(e,"max",{keyDisplay:"Max Items",min:1}),qe(e,"unique",{keyDisplay:"Item uniqueness"})];break;case e.type==x:t=[R(e,"min",{keyDisplay:"Min Items",value:e.schs.length,readonly:!0}),R(e,"max",{keyDisplay:"Max Items",value:e.max||e.schs.length})];break;case e.type==k:t=[R(e,"min",{keyDisplay:"Min Length",min:0}),R(e,"max",{keyDisplay:"Max Length",min:0}),we(e,"pattern",{keyDisplay:"Pattern",maxlength:256})];break;case e.type==O:t=[Ee(e,"min",{keyDisplay:"Min"}),Ee(e,"max",{keyDisplay:"Max"}),Ee(e,"multipleOf",{keyDisplay:"Multiple of",min:1})];break;case e.type==ae:t=[];case e.type==_:t=[];case e.type==C:t=[];case e.type==h:t=[];case e.type==B:t=[];case e.type==D:t=[];case e.type==q:t=[];default:t=[]}return e._meta.parent.type==y&&e._meta.parent._box!=A&&t.push(qe(e,"required",{keyDisplay:"Required"})),t};var $e=(e,t)=>e.errors&&e.errors[t];var E=e=>{try{Ur({sch:e,ui:{level:1,tab:0,models:e.order.reduce((t,r)=>(t[e.fields[r].$anchor]=r,t),{})},path:"",key:"root",parent:{type:e.type,_box:e._box}})}catch(t){}},Ur=e=>Te(document.querySelector("#fmodel"),f`
  <theme>
    <ul role="tree" aria-multiselectable="true" class="text-sm">
      ${ne(e)}
    </ul>
  </theme>
  ${null}
`);var ne=e=>{switch(!0){case e.sch._box==A:return Pr(e);case Xe.includes(e.sch.type):return jr(e);default:return Br(e)}},Pr=e=>f.for(e.sch,e.sch.$anchor)`
  <li id="${e.path}" .key="${e.key}" .index="${0}" aria-posinset="${1}" class="fmodels" role="treeitem" aria-level="${e.ui.level}" aria-selected="false" tabindex="-1">
    <ul data-group="${At(e.sch)}" role="group">
      ${_t(e)}
    </ul>
  </li>`,jr=e=>f.for(e.sch,e.sch.$anchor)`
  <li id="${e.path}" .key="${e.key}" .index="${e.ui.index}" aria-posinset="${e.ui.index+1}" class="folder" role="treeitem" aria-level="${e.ui.level}" aria-selected="false" tabindex="-1">
    <dfn class="h">
      ${Mt(Object.assign(e,{key:Rt(e.key)}))}
      ${It(e)}
      ${Lt(e)}
    </dfn>
    <ul data-group="${At(e.sch)}" role="group">
      ${_t(e)}
    </ul>
  </li>`,Br=e=>f.for(e.sch,e.sch.$anchor)`
  <li id="${e.path}" .key="${e.key}" .index="${e.ui.index}" aria-posinset="${e.ui.index+1}" class="file" role="treeitem" aria-level="${e.ui.level}" aria-selected="false" tabindex="-1">
    ${Mt(Object.assign(e,{key:Rt(e.key)}))}
    ${It(e)}
    ${Lt(e)}
  </li>`,_t=e=>{switch(!0){case[y].includes(e.sch.type):return qr(e);case[x].includes(e.sch.type):return Gr(e);case[v].includes(e.sch.type):return Kr(e);case[h].includes(e.sch.type):return Wr(e);default:return f``}},qr=e=>e.sch.order.map((t,r)=>ne({key:t,sch:e.sch.fields[t],parent:{type:e.sch.type,path:e.path,_box:e.sch._box},ui:{...e.ui,level:e.ui.level+1,index:r},path:`${e.path}[${t}]`})),Gr=e=>e.sch.schs.map((t,r)=>ne({key:r,sch:e.sch.schs[r],parent:{type:e.sch.type,path:e.path,_box:e.sch._box},ui:{...e.ui,level:e.ui.level+1,index:r},path:`${e.path}[][${r}]`})),Kr=e=>ne({key:0,sch:e.sch.sch,parent:{type:e.sch.type,path:e.path,_box:e.sch._box},ui:{...e.ui,level:e.ui.level+1,index:0},path:`${e.path}[][${0}]`}),Wr=e=>e.sch.schs.map((t,r)=>ne({key:"",sch:e.sch.schs[r],parent:{type:e.sch.type,path:e.path,_box:e.sch._box},ui:{...e.ui,level:e.ui.level+1,index:r},path:`${e.path}[][${r}]`})),ge=e=>`padding-left: ${(e.ui.level-1)*1.25+e.ui.tab}rem`,Ct=(e,t,r)=>f`<textarea id="${e}" class="no-resize" spellcheck="false" maxlength="256" rows="1" autofocus
  data-parent-path="${t}"
  oninput="${xe}"
  >${r}</textarea>`,Mt=e=>e.parent._box==A?Hr(e):zr(e),Hr=e=>f`
  <span class="def" style="${ge(e)}">
    ${Xr(e.sch,e.ui)}
  </span>
  <span class="k">${Dt(e)}</span>
  <span class="s">=</span>
  `,zr=e=>{switch(!0){case e.parent.type==h:return f`
      <span class="" style="${ge(e)}"></span>
      <span class="s">|</span>
      `;case e.parent.type==v:return f`
      <span class="k" style="${ge(e)}"></span>
      <span class="s">└</span>
      `;default:return f`
      <span class="k" style="${ge(e)}">
        ${Dt(e)}
      </span >
      <span class="s">:</span>
    `}},Dt=e=>e.sch.uiMode=="editKey"?Ct("key-edit",e.parent.path,e.key):f`${e.key}`,It=e=>e.parent._box==A?Jr(e):Yr(e),Jr=e=>f`<span class="t">${Ut(e)}</span>`,Yr=e=>f`<span class="t">${Ut(e)}</span>`,Ut=e=>e.sch.uiMode=="editType"?Ct("type-edit",e.parent.path,e.sch.type):f`${Pt(e.sch,e.ui)}`,Pt=(e,t)=>{switch(!0){case(e.type==y&&Pe(e.fields,{})):return"{ any }";case e.type==y:return"{ \xA0 }";case e.type==v:return f`[ ${Pt(e.sch,t)} ]`;case e.type==x:return"( \xA0 )";case e.type==k:return"string";case e.type==O:return"number";case e.type==ae:return"integer";case e.type==_:return"bool";case e.type==C:return"null";case e.type==h:return"||";case e.type==B:return"any";case(e.type==D&&!!t.models[e.$ref]):return f`<span class="ref">${e._text=t.models[e.$ref]}</span>`;case e.type==D:return f`<span class="ref notfound" title="Ref type">${`${e._text} (#404)`}</span>`;case e.type==q:return f`<span class="value" title="Value type">${JSON.stringify(e.const)}</span>`;default:return"please define what type ${sch} is"}},Rt=e=>e,At=e=>{switch(!0){case[y].includes(e.type):return"keyed";case[x,h].includes(e.type):return"indexed";default:return"none"}},Xr=(e,t)=>{return"type";switch(!0){case e.type==y:return"record";case e.type==v:return"list";case e.type==x:return"tuple";case e.type==h:return"union";default:return"field"}},Lt=e=>{let t;switch(!0){case(e.parent.type==y&&e.sch.required):t=[f`<span class="m"> · required</span>`];break;default:t=[]}return t};var S="aria-selected",jt=e=>(e._walker=e.ownerDocument.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:t=>t.hasAttribute(S)?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP},!1),e),b=(e,t,r={focus:!0})=>{!t||(e._walker.currentNode=t,Bt(e),W(t),r.focus&&t.focus())},Gt=e=>qt(e),H=(e,t,r={focus:!0})=>{!t||(t.getAttribute(S)=="true"?qt(e):W(t),r.focus&&t.focus())},Bt=e=>{for(let t of e.querySelectorAll(`[${S}='true']`))Ge(t);for(let t of e.querySelectorAll(".item-pasted"))t.classList.remove("item-pasted","up","down")},Ke=(e,t,r,n={})=>{var a,u,s;let l=e._walker.currentNode,o=t();if(!!o){if(l==r)return(a=n.target)==null?void 0:a.call(null,r);(u=n.pre)==null||u.call(null,l,o),Ke(e,t,r,n),(s=n.post)==null||s.call(null,l,o)}},Se=(e,t,r)=>{if(!(!t||!r))switch(t.compareDocumentPosition(r)){case Node.DOCUMENT_POSITION_FOLLOWING:e._walker.currentNode=t,Ke(e,()=>e._walker.nextSibling(),r,{pre:(n,l)=>{H(n,l,{focus:!1})}}),e._walker.currentNode=r,W(r),r.focus();break;case Node.DOCUMENT_POSITION_PRECEDING:e._walker.currentNode=t,W(r.parentNode.closest(`[${S}]`)),Ke(e,()=>e._walker.previousSibling(),r,{pre:(n,l)=>{H(n,l,{focus:!1})}}),Ge(r.parentNode.closest(`[${S}]`)),e._walker.currentNode=r,W(r),r.focus();break}},W=e=>{!e||(e.setAttribute(S,!0),e.tabIndex=0)},Ge=e=>{!e||(e.setAttribute(S,!1),e.tabIndex=-1)},qt=e=>(e==null?void 0:e.getAttribute(S))=="true"?Ge(e):W(e),ke=(e,t)=>{do t=e();while((t==null?void 0:t.getAttribute(S))=="true");return t},Fr=e=>e.filter(t=>{for(let r of e){if(t==r)return!0;if(t.startsWith(r))return!1}}),Oe=(e,t,r={})=>{Bt(e);for(let n of Fr(Object.keys(t))){let l=t[n];if(n==""?n=e.querySelector("[id][aria-level]"):n=e.querySelector(`[id='${CSS.escape(n)}'][aria-level]`),!n)continue;let o=parseInt(n.getAttribute("aria-level")),a=n.querySelectorAll(`[aria-level='${o+1}'][role='treeitem']`);for(let u=0;u<l.length;u++){let s=l[u].index,c=a[s];if(!c)return;c.classList.add("item-pasted",r.direction),H(null,c,{focus:u==l.length-1}),e._walker.currentNode=c}}},j=(e,t={})=>{let r=e.querySelectorAll(`${t.ops||`[${S}='true']`}`),n={};for(let l=0;l<r.length;l++){let o=r[l],a=o.parentNode.closest("[role='treeitem']");if(!a)break;o.index=o.index||parseInt(o.getAttribute("aria-posinset"))-1,n[a.id]=n[a.id]||[],n[a.id].push(o)}return n},le=e=>{e.querySelectorAll(".item-cutting, .item-copying").forEach(t=>t.classList.remove("item-cutting","item-copying")),e._clipboard=null};var Kt=[ce,Ve,Qe,Ze,I,Ie,Je,Ye,Fe,()=>Re('"json string"')],Vr={...$(ce),_box:A,_allSchs:Kt};var bn=()=>new Map([["shift-meta-ArrowUp",Qr],["shift-meta-ArrowDown",Zr],["shift-ArrowUp",en],["shift-ArrowDown",tn],["meta-ArrowUp",rn],["meta-ArrowDown",nn],["ArrowUp",ln],["ArrowDown",on],["Home",an],["End",sn],["shift-+",cn],["Enter",un],["shift-Enter",dn],["Delete",pn],["meta-x",fn],["meta-c",mn],["meta-v",yn],["shift-alt-ArrowUp",hn],["shift-alt-ArrowDown",Tn],["alt-ArrowUp",xn],["alt-ArrowDown",Nn],["Escape",({tree:e})=>le(e)]]),vn=e=>function(t){wn(t,this,e)};function wn(e,t,r){if(e.target instanceof HTMLTextAreaElement)return $n(e,t,r);let n=bn().get(Wt(e));switch(n&&n({tree:t,store:r}),e.code){case"ArrowUp":e.preventDefault();break;case"ArrowDown":e.preventDefault();break}_e({tree:t,store:r})}var gn=()=>new Map([["Enter",En]]),$n=(e,t,r)=>{let n=e.target,l=gn().get(Wt(e));l&&l({tree:t,store:r},n),_e({tree:t,store:r})},kn=e=>function(t){return Sn(t,this,e)};function Sn(e,t,r){let n=t._walker.currentNode,l=e.target.closest("[role='treeitem']"),o=!t.querySelector("textarea");if(!!l){if(e.shiftKey||e.metaKey)switch(n.compareDocumentPosition(l)){case Node.DOCUMENT_POSITION_CONTAINS:return b(t,l);case Node.DOCUMENT_POSITION_CONTAINED_BY:return b(t,n);default:if(l.parentNode.closest("[role='treeitem']")!=n.parentNode.closest("[role='treeitem']"))return b(t,l)}e.shiftKey?Se(t,n,l):e.metaKey?Gt(t._walker.currentNode=l):b(t,l,{focus:o}),_e({tree:t,store:r})}}var _e=({tree:e,store:t})=>{let r=e.querySelectorAll("[id='fmodel'] [aria-selected='true']");if(r.length==1){let n=De(t,r[0].id);n.key=r[0].key,n.path=r[0].id,ve(e._metaContainer,n,t)}},Wt=({shiftKey:e,metaKey:t,altKey:r,ctrlKey:n,key:l})=>{let o=[];return e&&o.push("shift"),(t||n)&&o.push("meta"),r&&o.push("alt"),l&&o.push(l),o.join("-")},Qr=({tree:e})=>{let t=e._walker.currentNode,r=e._walker.parentNode()&&e._walker.firstChild();Se(e,t,r)},Zr=({tree:e})=>{let t=e._walker.currentNode,r=e._walker.parentNode()&&e._walker.lastChild();Se(e,t,r)},en=({tree:e})=>{let t=e._walker.currentNode,r=e._walker.previousSibling();H(t,r)},tn=({tree:e})=>{let t=e._walker.currentNode,r=e._walker.nextSibling();H(t,r)},rn=({tree:e})=>{let t=e._walker.parentNode()&&e._walker.firstChild();b(e,t)},nn=({tree:e})=>{let t=e._walker.parentNode()&&e._walker.lastChild();b(e,t)},ln=({tree:e})=>b(e,e._walker.previousNode()),on=({tree:e})=>b(e,e._walker.nextNode()),an=({tree:e})=>{for(;e._walker.parentNode(););b(e,e._walker.currentNode)},sn=({tree:e})=>{for(;e._walker.nextNode(););b(e,e._walker.currentNode)},cn=({tree:e,store:t})=>{let r=e._walker.currentNode;r.classList.contains("fmodels")?Y(t,r.id,[{k:null,sch:ce,index:0}]):Y(t,r.id,[{k:null,sch:Ie,index:Number.MAX_SAFE_INTEGER}]),E(t),b(e,r)},un=({tree:e,store:t})=>{var n,l;((l=(n=e._walker.currentNode.closest("[role='group']"))==null?void 0:n.dataset)==null?void 0:l.group)=="keyed"&&Ht({tree:e,store:t,editMode:"editKey"})},dn=({tree:e,store:t})=>{Ht({tree:e,store:t,editMode:"editType"})},Ht=({tree:e,store:t,editMode:r})=>{let n=e._walker.currentNode;P(t,n.id,(o,a)=>({...o,uiMode:r})),E(t);let l=e.querySelector("textarea");l._treeItem=n,l.onblur=o=>On(e,t,l),l.focus()},On=(e,t,r)=>{let n=P(t,r._treeItem.id,(l,o)=>Object.assign(l,{uiMode:"cancelled-edit"}));E(t),n&&(e._walker.currentNode=e.querySelector(`[id='${CSS.escape(r._treeItem.id)}']`),b(e,e._walker.currentNode))},En=({tree:e,store:t},r)=>{r.id=="key-edit"?zt(e,t,r,An):r.id=="type-edit"&&zt(e,t,r,_n)},zt=(e,t,r,n)=>{let l=e._walker.currentNode;r._treeItem=r.closest("[role='treeitem']"),b(e,r._treeItem,{focus:!1});let o=n(e,t,r)||l.id;P(t,o,(a,u)=>Object.assign(a,{uiMode:"editted"})),E(t),e._walker.currentNode=e.querySelector(`[id='${CSS.escape(o)}']`),b(e,e._walker.currentNode)},_n=(e,t,r)=>{let n=t._allSchs.filter(a=>a().type==r.value)[0],l=t.order.filter(a=>a==r.value)[0],o=Re(r.value);return n?pe(t,r._treeItem.id,n):l?pe(t,r._treeItem.id,()=>et(t.fields[l].$anchor)):o&&pe(t,r._treeItem.id,()=>o),e._walker.currentNode.id},An=(e,t,r)=>{let n=j(e),l=r.dataset.parentPath;n[r.dataset.parentPath]=n[r.dataset.parentPath].filter(c=>c.id==r._treeItem.id).map(c=>({id:c.id,newK:r.value,index:c.index}));let o=n[r.dataset.parentPath][0].index,u=de(t,{dstPath:l,startIndex:o},n)[l][0].k;return`${r._treeItem.parentNode.closest("[role='treeitem']").id}[${u}]`},pn=({tree:e,store:t})=>{let r=ke(()=>e._walker.nextSibling())||ke(()=>e._walker.previousSibling())||ke(()=>e._walker.parentNode());Mn(e,t),E(t),b(e,r)},Mn=(e,t)=>{let r=j(e);for(let n of Object.keys(r))Le(t,n,r[n].map(l=>l.index))};var fn=({tree:e})=>{le(e),e._clipboard={type:"cut",ops:()=>j(e,{ops:".item-cutting"})};for(let t of e.querySelectorAll("[aria-selected='true']"))t.classList.add("item-cutting")},mn=({tree:e})=>{le(e),e._clipboard={type:"copy",ops:()=>j(e,{ops:".item-copying"})};for(let t of e.querySelectorAll("[aria-selected='true']"))t.classList.add("item-copying")},yn=({tree:e,store:t})=>{let r=De(t,e._walker.currentNode.id);if(!![y,h,x].includes(r.type)&&e._clipboard){let n=e._walker.currentNode.id,{type:l,ops:o}=e._clipboard,a=o(),u;switch(l){case"copy":u=Ce(t,{dstPath:n},a);break;case"cut":u=de(t,{dstPath:n},a);break}Object.keys(u).length!=0&&(E(t),le(e),Oe(e,u))}},hn=({tree:e,store:t})=>Xt({tree:e,store:t,direction:"up"},r=>r[0].index),Tn=({tree:e,store:t})=>Xt({tree:e,store:t,direction:"down"},r=>r[r.length-1].index+1),Xt=({tree:e,store:t,direction:r},n)=>{let l=j(e),o;for(let a of Object.keys(l))o=Ce(t,{dstPath:a,startIndex:n(l[a])},{[a]:l[a]});Object.keys(o).length!=0&&(E(t),Oe(e,o,{direction:r}))},xn=({tree:e,store:t})=>Jt({tree:e,store:t,startIndex:r=>r-1,direction:"up"}),Nn=({tree:e,store:t})=>Jt({tree:e,store:t,startIndex:r=>r+1,direction:"down"}),Jt=({tree:e,store:t,startIndex:r,direction:n})=>{let l=j(e),o;for(let a of Object.keys(l)){let u=l[a].sort((s,c)=>s.index-c.index);o=de(t,{dstPath:a,startIndex:r(u[0].index)},l)}Object.keys(o).length!=0&&(E(t),Oe(e,o,{direction:n}))},In=({store:e,treeSelector:t,metaSelector:r})=>{E(e);let n=document.querySelector(t),l=document.querySelector(r);n&&(jt(n),n.onkeydown=vn(e),n.onclick=kn(e),b(n,n._walker.nextNode()),n._metaContainer=l,_e({tree:n,store:e}))},Rn=({store:e,detail:t,target:r})=>{let{path:n,attrs:l}=t,o=P(e,n,(a,u)=>St(a,l));E(e),ve(r.closest("sch-meta"),o,e)};export{Kt as allSchs,In as init,Vr as store,Rn as update};
/*! (c) Andrea Giammarchi - ISC */
